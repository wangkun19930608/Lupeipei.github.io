<!doctype html>



  


<html class="theme-next muse use-motion" lang="zh-Hans">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>



<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />















  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css" />




  
  
  
  

  
    
    
  

  

  

  

  

  
    
    
    <link href="//fonts.googleapis.com/css?family=Lato:300,300italic,400,400italic,700,700italic&subset=latin,latin-ext" rel="stylesheet" type="text/css">
  






<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=5.1.0" rel="stylesheet" type="text/css" />


  <meta name="keywords" content="Hexo, NexT" />








  <link rel="shortcut icon" type="image/x-icon" href="/favicon.ico?v=5.1.0" />






<meta name="description" content="Learning is doing">
<meta property="og:type" content="website">
<meta property="og:title" content="Lucia">
<meta property="og:url" content="http://lupeipei.github.io/index.html">
<meta property="og:site_name" content="Lucia">
<meta property="og:description" content="Learning is doing">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Lucia">
<meta name="twitter:description" content="Learning is doing">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Muse',
    sidebar: {"position":"left","display":"post","b2t":false,"scrollpercent":false},
    fancybox: true,
    motion: true,
    duoshuo: {
      userId: '0',
      author: '博主'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="http://lupeipei.github.io/"/>





  <title> Lucia </title>
</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans">

  














  
  
    
  

  <div class="container sidebar-position-left 
   page-home 
 ">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/"  class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">Lucia</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle"></p>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br />
            
            首页
          </a>
        </li>
      
        
        <li class="menu-item menu-item-categories">
          <a href="/categories" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-th"></i> <br />
            
            分类
          </a>
        </li>
      
        
        <li class="menu-item menu-item-about">
          <a href="/about" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-user"></i> <br />
            
            关于
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br />
            
            归档
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-tags"></i> <br />
            
            标签
          </a>
        </li>
      

      
    </ul>
  

  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            
  <section id="posts" class="posts-expand">
    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="http://lupeipei.github.io/2017/10/10/login-server-without-password/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Lucia">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/source/images/avtar.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Lucia">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2017/10/10/login-server-without-password/" itemprop="url">
                  SSH免密码登录远端服务器
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-10-10T08:24:21+08:00">
                2017-10-10
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Linux/" itemprop="url" rel="index">
                    <span itemprop="name">Linux</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
              <span class="post-comments-count">
                <span class="post-meta-divider">|</span>
                <span class="post-meta-item-icon">
                  <i class="fa fa-comment-o"></i>
                </span>
                <a href="/2017/10/10/login-server-without-password/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count disqus-comment-count"
                        data-disqus-identifier="2017/10/10/login-server-without-password/" itemprop="commentCount"></span>
                </a>
              </span>
            
          

          
          

          

          

          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h4 id="吐个糟先"><a href="#吐个糟先" class="headerlink" title="吐个糟先"></a>吐个糟先</h4><p>前段时间开始学习Linux云服务器部署运维，在免密码登录那块卡了很久，一直没找到原因，删除实例，重新生成SSH key，折腾了几次，每次都以为这次没问题了，结果登录的时候，擦，还是要求输入密码，你说糟心不？随性先搁浅了起来，前几天又来找虐，试了两次，竟然成功登录了，小激动啊！</p>
<p>记录下免密码登录的整个操作流程，庆祝下，也给没踩坑的参考下。</p>
<h4 id="正文"><a href="#正文" class="headerlink" title="正文"></a>正文</h4><p>远端登入如果每次都要输入密码，还是挺麻烦的，不过，别担心，聪明的前辈们早就想到解决办法啦！用非对称加密的方式来实现免密码登录。那，具体怎么玩？</p>
<p><strong>步骤：</strong></p>
<p>机器A： 本地的Mac</p>
<p>机器B： 远端Linux服务器</p>
<p>Step1、在<strong>本地机器A</strong>检查是否已经生成id_rsa.pub</p>
<ul>
<li><p>终端运行<code>cat ~/.ssh/id_rsa.pub</code></p>
<p><img src="https://ws4.sinaimg.cn/large/006tNc79gy1fk9qp21kn2j30lt021gmk.jpg" alt=""></p>
<ul>
<li><p>如果存在该文件，终端运行：<code>ssh-keygen -p</code>, 将passphrase重新设置为空，直接按Enter即可，这一步很重要，不然的话，即使你设置了免密码登录，还是要每次都输入passphrase才可以登录到远端服务器。</p>
<p><img src="https://ws3.sinaimg.cn/large/006tNc79gy1fk9qp2mmr8j30gz02t3yy.jpg" alt=""></p>
</li>
<li><p>如果不存在该文件，需要先生成，终端运行：<code>ssh-keygen -t rsa</code>,  就会生成公钥 <code>~/.ssh/id_rsa.pub</code> 以及密钥 <code>~/.ssh/id_rsa</code>啦。同样的，一直按Enter，不要设置passphrase。</p>
</li>
</ul>
</li>
</ul>
<p>Step2、在<strong>机器B</strong>添上本地的公钥</p>
<ul>
<li><p>登录远端服务器后，新建authorized_keys</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">mkdir ~/.ssh</div><div class="line">touch ~/.ssh/authorized_keys</div></pre></td></tr></table></figure>
</li>
<li><p>将公钥贴近远端服务器的authorized_keys中</p>
<p>在A上运行：<code>cat ~/.ssh/id_rsa.pub</code>， 复制本机的公钥</p>
<p>回到B上，运行：<code>nano ~/.ssh/authorized_keys</code>, 把公钥贴进去</p>
</li>
<li><p>设置机器B上的文件权限</p>
<p>运行：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">chmod 700 ~/.ssh</div><div class="line">chmod 644 ~/.ssh/authorized_keys</div></pre></td></tr></table></figure>
<p>有的参考文档要求设置成600，试了下，644，600，保证owner是可读写可执行，而其他用户和群组的最大权限是可读即可。</p>
<p>​</p>
<p>可以了！很简单是不是？试试看，退出重新登录下，不用敲密码啦！</p>
</li>
</ul>
<h4 id="The-end"><a href="#The-end" class="headerlink" title="The end"></a>The end</h4><p> BTW，我之前的问题是passphrase没有设置为空，另外SSH文件复制时也出错，后面重新生成才解决的。</p>
<p>看了一些有关SSH免登录的操作说明，有一篇挺干货的。推荐：</p>
<p><a href="https://my.oschina.net/magicalSam/blog/1466144" target="_blank" rel="external">Mac、Linux 上实现SSH免密码登陆到Linux服务器</a></p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="http://lupeipei.github.io/2017/10/09/introduction-to-jquery-module3-2/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Lucia">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/source/images/avtar.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Lucia">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2017/10/09/introduction-to-jquery-module3-2/" itemprop="url">
                  Introduction to jQuery_5
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-10-09T12:16:09+08:00">
                2017-10-09
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Web/" itemprop="url" rel="index">
                    <span itemprop="name">Web</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
              <span class="post-comments-count">
                <span class="post-meta-divider">|</span>
                <span class="post-meta-item-icon">
                  <i class="fa fa-comment-o"></i>
                </span>
                <a href="/2017/10/09/introduction-to-jquery-module3-2/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count disqus-comment-count"
                        data-disqus-identifier="2017/10/09/introduction-to-jquery-module3-2/" itemprop="commentCount"></span>
                </a>
              </span>
            
          

          
          

          

          

          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h4 id="Before-Start"><a href="#Before-Start" class="headerlink" title="Before Start"></a>Before Start</h4><p>The following contents are the notes I took when learning  jQuery on Edx.</p>
<p>Mainly for  front-End Web developers, check <a href="https://courses.edx.org/courses/course-v1:Microsoft+DEV208x+4T2017/course/" target="_blank" rel="external">here</a> to get more details.</p>
<h4 id="CONTENTS"><a href="#CONTENTS" class="headerlink" title="CONTENTS"></a>CONTENTS</h4><p>Three parts:</p>
<ul>
<li><a href="https://lupeipei.github.io/2017/10/05/introduction-to-jQuery-module1/">Adding jQuery to web pages</a></li>
<li><a href="https://lupeipei.github.io/2017/10/06/introduction-to-jquery-module2-1/">Managing content, events and effects</a></li>
<li>Asynchronous operations and Ajax calls</li>
</ul>
<h4 id="Module3-Asynchronous-programming-and-Ajax"><a href="#Module3-Asynchronous-programming-and-Ajax" class="headerlink" title="Module3 : Asynchronous programming and Ajax"></a>Module3 : Asynchronous programming and Ajax</h4><p>Module3 includes five parts:</p>
<ul>
<li>Using promises</li>
<li>Web workers</li>
<li>Using deferred</li>
<li>JavaScript Object Notation</li>
<li>Calling the server</li>
</ul>
<p>Let’s get to know something about JSON and Ajax.</p>
<ul>
<li><p>JavaScript Object Notation</p>
<ul>
<li><p>JSON syntax</p>
<p>A JSON object uses a notation that’s similar to that of a JavaScript object.</p>
<p>Example:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line">//create a JavaScript object</div><div class="line">var person = &#123;</div><div class="line">    firstName: &apos;Christopher&apos;,</div><div class="line">    lastName: &apos;Harrison&apos;</div><div class="line">&#125;</div><div class="line"></div><div class="line">//create a JSON object</div><div class="line">var person = &#123;</div><div class="line">    &apos;firstName&apos;: &apos;Christopher&apos;,</div><div class="line">    &apos;lastName&apos;: &apos;Harrison&apos;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>Create a more complex object:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">var person = &#123;</div><div class="line">    &apos;firstName&apos;: &apos;Christopher&apos;,</div><div class="line">    &apos;lastName&apos;: &apos;Harrison&apos;,</div><div class="line">    &apos;email&apos;: &#123;</div><div class="line">        &apos;address&apos;: &apos;charrison@adventure-works.com&apos;,</div><div class="line">        &apos;type&apos;: &apos;business&apos;</div><div class="line">    &#125;    </div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>Create a object with array:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line">var person = &#123;</div><div class="line">    &apos;firstName&apos;: &apos;Christopher&apos;,</div><div class="line">    &apos;lastName&apos;: &apos;Harrison&apos;,</div><div class="line">    &apos;emailAddresses&apos;: [</div><div class="line">        &#123;</div><div class="line">            &apos;address&apos;: &apos;charrison@adventure-works.com&apos;,</div><div class="line">            &apos;type&apos;: &apos;business&apos;</div><div class="line">        &#125;,</div><div class="line">        &#123;</div><div class="line">            &apos;address&apos;: &apos;charrison@fineartschool.net&apos;,</div><div class="line">            &apos;type&apos;: &apos;home&apos;</div><div class="line">        &#125;</div><div class="line">    ]</div><div class="line">&#125;</div></pre></td></tr></table></figure>
</li>
<li><p>Serializing objects</p>
<p>JavaScript provides a native utility for <strong>converting objects to JSON</strong> (serializing), and <strong>converting JSON strings to objects</strong> (deserializing).</p>
<ul>
<li><p>Serializing an object:<code>JSON.stringify</code></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line">// Create an instance of Object, a basic JavaScript object</div><div class="line">var person = new Object();</div><div class="line"></div><div class="line">// add properties</div><div class="line">person.firstName = &apos;Christopher&apos;;</div><div class="line">person.lastName = &apos;Harrison&apos;;</div><div class="line"></div><div class="line">// serialize</div><div class="line">var jsonString = JSON.stringify(person);</div></pre></td></tr></table></figure>
</li>
<li><p>Deserializing JSON: <code>JSON.parse</code></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">// Deserialize a JSON string</div><div class="line">var newPerson = JSON.parse(jsonString);</div><div class="line"></div><div class="line">// access properties as normal</div><div class="line">$(&apos;#first-name-display&apos;).text(newPerson.firstName);</div><div class="line">$(&apos;#last-name-display&apos;).text(newPerson.lastName);</div></pre></td></tr></table></figure>
</li>
</ul>
</li>
</ul>
</li>
<li><p>Calling the server</p>
<ul>
<li><p>Introducing Ajax</p>
<p>Typically, when we make a call to the server, we need to refresh the entire page.</p>
<p>as developers, we’d like to be able to incorporate server-side resources into our pages, allowing us to <strong>update individual portions of the page with new data, rather than updating the entire page</strong>.</p>
<ul>
<li><p>Asynchronous JavaScript and XML (Ajax)</p>
<p>Ajax is a set of technologies that act together to make it easier for developers to make calls to server resources from JavaScript.</p>
</li>
<li><p>Basic data retrieval</p>
<p><code>get</code> : The most basic Ajax operation we can perform using jQuery.</p>
<p> <code>get</code> contacts the <strong>URL</strong> we provide, and passes the string the server returns into the parameter we’ll use for our event handler.</p>
<p>Example:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">$.get(</div><div class="line">    &apos;some-url&apos;, // The URL to call</div><div class="line">    function(data) &#123; // Success event handler</div><div class="line">        // The data parameter contains the string</div><div class="line">        $(&apos;#output&apos;).text(data);</div><div class="line">    &#125;</div><div class="line">);</div></pre></td></tr></table></figure>
</li>
<li><p>jQuery Ajax and promises</p>
<p>All jQuery Ajax calls return a jQuery <strong>promise</strong>.</p>
<p> So, you can use <code>done</code> for your success event handler, and <code>fail</code> to catch any errors. The two code samples perform the same operations.</p>
<p>Example:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">// Option one (pass the success function as a parameter)</div><div class="line">$.get(&apos;some-url&apos;, function(data) &#123; $(&apos;#output&apos;).text(data); &#125;);</div><div class="line"></div><div class="line">// Option two (use the done function of the promise)</div><div class="line">$.get(&apos;some-url&apos;).done(function(data) &#123; $(&apos;#output&apos;).text(data); &#125;);</div></pre></td></tr></table></figure>
</li>
</ul>
</li>
<li><p>Retrieving JSON objects</p>
<ul>
<li><p><code>getJSON</code></p>
<p>To retrieve a JSON object, you can use <code>getJSON</code>.</p>
<p><code>getJSON</code> accepts several parameters, but the most common two that you’ll provide are the URL you need to call, and an event handler for success.</p>
<p>Because getJSON is expecting JSON data, it automatically deserializes the object, meaning you do not need to call JSON.parse.</p>
<p>Example:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">$.getJSON(&apos;/api/Demo&apos;, function (person) &#123;</div><div class="line">	$(&apos;#first-name&apos;).val(person.firstName);</div><div class="line">	$(&apos;#last-name&apos;).val(person.lastName);</div><div class="line">&#125;);</div></pre></td></tr></table></figure>
</li>
</ul>
</li>
<li><p>Making server calls</p>
<p>If you’re new to making server calls through JavaScript or other technologies, you might have a few questions about <strong>how you’re supposed to know where the data is, what URLs you should use</strong>, etc.</p>
<ul>
<li><p>Finding the right URL</p>
<p>Most commonly you’ll be calling your own server and accessing your own organization’s data.</p>
<p>Then the answer becomes even easier:</p>
<p>talk to the developer who created the server side code that you need to call. They can provide all of the information you need.</p>
</li>
<li><p>Verbs</p>
<p>HTTP offers several “verbs”, with the two most common being GET and POST.</p>
<p>GET and POST in HTTP terms are about how to <strong>send data</strong> to the server, not a determination of the server sending you data.</p>
<p>GET limits us to <strong>sending data in the URL only</strong>.</p>
<p>POST on the other hand allows us to <strong>send data</strong> <strong>both in the URL, but also in what’s known as the header</strong>.The header is information that’s sent behind the scenes from the client to the server, and can be used to send almost any type of data, including binary data.</p>
</li>
<li><p>HTTP and REST APIs</p>
<p> HTTP provides several verbs, including GET, POST, PUT and DELETE.</p>
<p>GET will retrieve objects,</p>
<p>POST will create a new object,</p>
<p>PUT will update an existing object,</p>
<p>DELETE will delete an object.</p>
<p>Building upon those common operations, the W3C has established a specification called <a href="https://en.wikipedia.org/wiki/Representational_state_transfer" target="_blank" rel="external">REST</a>. REST provides for various standards to provide even more consistency when making server calls.</p>
</li>
</ul>
</li>
<li><p>Posting data</p>
<p>If the service you’re using follows standard REST practices, you’ll notice that you can create a new object by calling POST.</p>
<p>Or, if you’re trying to upload a binary object, such as an image, you’re forced to use POST, as GET won’t allow that type of data to be uploaded.</p>
<ul>
<li><p><code>post</code></p>
<p>Like getJSON, it also passes the JSON object returned by the server into the parameter for the event handler. And, just like all of the Ajax calls we’ve seen, <code>post</code> also returns a promise.</p>
<p>Example:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line">// get the data we need to send</div><div class="line">var person = &#123; firstName: &apos;Christopher&apos;, lastName: &apos;Harrison&apos; &#125;;</div><div class="line"></div><div class="line">// Call POST</div><div class="line"></div><div class="line">$.post(&apos;URL&apos;, // Pass in the URL you need to access</div><div class="line">    person, // Pass in the data to send via POST</div><div class="line">    function(data) &#123;</div><div class="line">        // success event handler</div><div class="line">        // parameter contains value returned by server</div><div class="line">    &#125;</div><div class="line">);</div></pre></td></tr></table></figure>
</li>
</ul>
</li>
<li><p>Ajax events</p>
<ul>
<li><p>Start events</p>
<p>The two starting events are <code>ajaxStart</code> and <code>ajaxSend</code>.</p>
<p><code>ajaxStart</code> is raised when the <strong>first</strong> Ajax call is being made.</p>
<p><code>ajaxSend</code> is raised <strong>each time</strong> an Ajax call is made.</p>
</li>
<li><p>Completion events</p>
<p>jQuery Ajax offers two main events when each Ajax call is finished, <code>ajaxSuccess</code>, which is raised when a call succeeds,</p>
<p><code>ajaxError</code>, which is raised when a call fails.</p>
<p><code>ajaxComplete</code> is raised when <strong>each</strong> Ajax call completes, regardless of success or failure.</p>
<p> <code>ajaxStop</code> is raised when <strong>all</strong> calls are completed.</p>
<p>Example:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">$(document).ajaxSend(function () &#123;</div><div class="line">	// raised when a call starts</div><div class="line">	$(&apos;#status&apos;).append(&apos;&lt;div&gt;Call started&lt;/div&gt;&apos;);</div><div class="line">&#125;).ajaxComplete(function () &#123;</div><div class="line">	// raised when a call completes</div><div class="line">	$(&apos;#status&apos;).append(&apos;&lt;div&gt;Call completed&lt;/div&gt;&apos;);</div><div class="line">&#125;);</div></pre></td></tr></table></figure>
</li>
</ul>
</li>
<li><p>Dynamically loading data</p>
<ul>
<li><p>Loading HTML</p>
<p><code>load</code> will call the URL provided, obtain the HTML, and place it in the targeted item.</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">$(&apos;#target&apos;).load(&apos;some-url.html&apos;);</div></pre></td></tr></table></figure>
</li>
<li><p>Loading and executing JavaScript</p>
<p><code>getScript</code>  downloads <strong>and executes</strong> the script when it’s called.</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">$.getScript(&apos;some-url.js&apos;);</div></pre></td></tr></table></figure>
</li>
</ul>
</li>
</ul>
</li>
</ul>
<p>This is  Module3 all about. More <a href="https://courses.edx.org/courses/course-v1:Microsoft+DEV208x+4T2017/course/" target="_blank" rel="external">details</a>.</p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="http://lupeipei.github.io/2017/10/08/introduction-to-jquery-module3-1/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Lucia">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/source/images/avtar.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Lucia">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2017/10/08/introduction-to-jquery-module3-1/" itemprop="url">
                  Introduction to jQuery_4
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-10-08T17:48:50+08:00">
                2017-10-08
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Web/" itemprop="url" rel="index">
                    <span itemprop="name">Web</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
              <span class="post-comments-count">
                <span class="post-meta-divider">|</span>
                <span class="post-meta-item-icon">
                  <i class="fa fa-comment-o"></i>
                </span>
                <a href="/2017/10/08/introduction-to-jquery-module3-1/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count disqus-comment-count"
                        data-disqus-identifier="2017/10/08/introduction-to-jquery-module3-1/" itemprop="commentCount"></span>
                </a>
              </span>
            
          

          
          

          

          

          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h4 id="Before-Start"><a href="#Before-Start" class="headerlink" title="Before Start"></a>Before Start</h4><p>The following contents are the notes I took when learning  jQuery on Edx.</p>
<p>Mainly for  front-End Web developers, check <a href="https://courses.edx.org/courses/course-v1:Microsoft+DEV208x+4T2017/course/" target="_blank" rel="external">here</a> to get more details.</p>
<h4 id="CONTENTS"><a href="#CONTENTS" class="headerlink" title="CONTENTS"></a>CONTENTS</h4><p>Three parts:</p>
<ul>
<li><a href="https://lupeipei.github.io/2017/10/05/introduction-to-jQuery-module1/">Adding jQuery to web pages</a></li>
<li><a href="https://lupeipei.github.io/2017/10/06/introduction-to-jquery-module2-1/">Managing content, events and effects</a></li>
<li>Asynchronous operations and Ajax calls</li>
</ul>
<h4 id="Module3-Asynchronous-programming-and-Ajax"><a href="#Module3-Asynchronous-programming-and-Ajax" class="headerlink" title="Module3 : Asynchronous programming and Ajax"></a>Module3 : Asynchronous programming and Ajax</h4><p>Module3 includes five parts:</p>
<ul>
<li>Using promises</li>
<li>Web workers</li>
<li>Using deferred</li>
<li>JavaScript Object Notation</li>
<li>Calling the server</li>
</ul>
<p>Uh, When I first learned it , I felt it was a little difficult for me to get the point, and now, I still have the feeling.</p>
<p>Let’s get to know something about the first three parts.</p>
<p><strong>A promise</strong> is an object returned by functions in jQuery that take a long or variable amount of time. By using a promise, you can ensure your code executes whenever the operation completes, be notified of its success or failure, or potentially receive updates about an operation’s progress.</p>
<p><strong>A deferred object</strong> allows you to create your own long running operations, allowing developers to use the same patterns provided by the promise object, and be updated when your operation completes.</p>
<p> <strong>web worker</strong>, an HTML5 feature allowing web developers to simulate threads in a web browser.</p>
<ul>
<li><p>promises</p>
<ul>
<li><p>Long running operations</p>
<p>Any jQuery function that runs over a long period of time, such as an animation, or communicates with a remote server, such as Ajax calls, returns a <strong>promise</strong>.</p>
</li>
<li><p>promises events</p>
<ul>
<li><p><code>done</code></p>
<p>raised when the operation completes successfully.</p>
<p>accepts one or more event handler functions.</p>
<p>Example:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">// code to obtain promise object</div><div class="line">promise.done(function(data) &#123;</div><div class="line">	// data will contain the data returned by the operation</div><div class="line">&#125;);</div></pre></td></tr></table></figure>
</li>
<li><p><code>fail</code></p>
<p>raised when the operation has completed with an error.</p>
<p>accepts one or more event handler functions.</p>
<p>Example:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">// code to obtain promise object</div><div class="line">promise.fail(function(data) &#123;</div><div class="line">	// data will contain the data returned by the operation</div><div class="line">&#125;);</div></pre></td></tr></table></figure>
</li>
<li><p><code>progress</code></p>
<p>raised when the operation raises an alert about its current state.</p>
<p>Not all operations raise <code>progress</code> events.</p>
<p>accepts one or more event handler functions.</p>
<p>Example:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">// code to obtain promise object</div><div class="line">promise.progress(function(data) &#123;</div><div class="line">	// data will contain the data returned by the operation</div><div class="line">&#125;);</div></pre></td></tr></table></figure>
</li>
<li><p>Chaining</p>
<p>add <code>done</code> and <code>fail</code> (and potentially <code>progress</code>) event handlers by chaining the method calls as demonstrated below :</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">// code to obtain promise object</div><div class="line">promise.done(function(data) &#123;</div><div class="line">	// success</div><div class="line">&#125;).fail(function(data) &#123;</div><div class="line">	// failure</div><div class="line">&#125;);</div></pre></td></tr></table></figure>
</li>
<li><p><code>then</code></p>
<p>a single function allowing you to register <code>done</code>, <code>fail</code>, and <code>progress</code> event handlers in one call.</p>
<p>The sample below is identical to the chaining demonstration above.</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">// code to obtain promise object</div><div class="line">promise.then(function(data) &#123;</div><div class="line">    // success</div><div class="line">&#125;, function(data) &#123;</div><div class="line">    // failure</div><div class="line">&#125;);</div></pre></td></tr></table></figure>
</li>
</ul>
</li>
</ul>
</li>
<li><p>Web workers</p>
<ul>
<li><p>Creating a web worker</p>
<p>made up of two components:</p>
<blockquote>
<p> the parent or calling script, and the worker or executing script.</p>
</blockquote>
<p><strong>does not</strong> have direct access to the calling environment or the UI.</p>
<p>use a messaging system to pass information to and from the worker.</p>
<ul>
<li><p>Creating the worker script</p>
<p>To create a web worker, you create a separate JavaScript file.</p>
<p>The code in the file <strong>will execute immediately</strong> when the worker object is created from the calling script.</p>
<p><code>self</code> : represents the worker. <code>self</code> , has one function named  <code>postMessage</code> and one event <code>message</code>.</p>
<p><code>postMessage</code>  is used to send data to the calling environment.</p>
<p><code>message</code> is raised when the calling script has sent a message to the worker.</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">// send a signal back to the calling script</div><div class="line">self.postMessage(&apos;hello from the worker!&apos;);</div><div class="line"></div><div class="line">// Receive a message from the calling environment</div><div class="line">self.addEventListener(&apos;message&apos;, function(e) &#123;</div><div class="line">    // the data property will contain the data passed from the calling script</div><div class="line">&#125;);</div></pre></td></tr></table></figure>
</li>
</ul>
</li>
<li><p>calling a web worker</p>
<ul>
<li><p>calling a web worker</p>
<p>to check to see if the brower supports web workers</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">// Test if the browser supports web workers</div><div class="line">if(Worker == null) &#123;</div><div class="line">	alert(&apos;You need to upgrade your browser!&apos;);</div><div class="line">&#125; else &#123;</div><div class="line">	// do your work here</div><div class="line">&#125;</div></pre></td></tr></table></figure>
</li>
<li><p>creating an instance of the Worker object</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">var worker = new Worker(&apos;script-location.js&apos;);</div><div class="line"></div><div class="line">// Register event handler</div><div class="line">worker.addEventListener(&apos;message&apos;, function(e) &#123;</div><div class="line">    $(&apos;#output&apos;).append(&apos;&lt;li&gt;&apos; + e.data + &apos;&lt;/li&gt;&apos;);</div><div class="line">&#125;);</div><div class="line"></div><div class="line">worker.postMessage(&apos;Started!&apos;);</div></pre></td></tr></table></figure>
<p>​</p>
</li>
</ul>
</li>
<li><p>Designing your web workers</p>
<ul>
<li><p>creating a web worker that accepts status messages</p>
<p>Code:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div></pre></td><td class="code"><pre><div class="line">// worker.js</div><div class="line"></div><div class="line">self.addEventListener(&apos;message&apos;, function(e) &#123;</div><div class="line">	if(e.data === &apos;START&apos;) &#123;</div><div class="line">		// Start message received.</div><div class="line">		// Begin work</div><div class="line">		startWork();</div><div class="line">	&#125; else if (e.data === &apos;STOP&apos;) &#123;</div><div class="line">		// Stop message received.</div><div class="line">		// Perform cleanup and terminate</div><div class="line">		stopWork();</div><div class="line">	&#125; else &#123;</div><div class="line">		// A different message has been received</div><div class="line">		// This is data that needs to be acted upon</div><div class="line">		processData(e.data);</div><div class="line">	&#125;</div><div class="line">&#125;);</div><div class="line"></div><div class="line">function startWork() &#123;</div><div class="line">	// code to start performing work here</div><div class="line">	// send a message to the calling page</div><div class="line">	// worker has started</div><div class="line">	self.postMessage(&apos;STARTED&apos;);</div><div class="line">&#125;</div><div class="line"></div><div class="line">function stopWork() &#123;</div><div class="line">	// cleanupp code here</div><div class="line">	// stop the worker</div><div class="line">	self.postMessage(&apos;STOPPED&apos;);</div><div class="line">	self.close();</div><div class="line">&#125;</div><div class="line"></div><div class="line">function processData(data) &#123;</div><div class="line">	// perform the work on the data</div><div class="line">	self.postMessage(&apos;Processed &apos; + data);</div><div class="line">&#125;</div></pre></td></tr></table></figure>
</li>
<li><p>calling a web worker that accepts messages</p>
<p>If you were using the worker that’s been designed above, you would use it by following a couple of basic steps.</p>
<ol>
<li>Create an instance of <code>Worker</code>, passing in the script.</li>
<li>Add the event handler for the <code>message</code> event. Ensure the event handler can respond to the status messages and normal data.</li>
<li>When you’re ready to start the worker’s work, call <code>postMessage(&#39;START&#39;);</code></li>
<li>When you’re done, send the stop message by calling <code>postMessage(&#39;STOP&#39;);</code></li>
</ol>
<p>Code:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div></pre></td><td class="code"><pre><div class="line">// inside of HTML file</div><div class="line"></div><div class="line">var worker = new Worker(&apos;worker.js&apos;);</div><div class="line"></div><div class="line">worker.addEventListener(&apos;message&apos;, function(e) &#123;</div><div class="line">    if(e.data === &apos;STARTED&apos;) &#123;</div><div class="line">        // worker has been started</div><div class="line">        // sample: update the screen to display worker started</div><div class="line">        $(&apos;#output&apos;).append(&apos;&lt;div&gt;Worker started&lt;/div&gt;&apos;);</div><div class="line">    &#125; else if(e.data === &apos;STOPPED&apos;) &#123;</div><div class="line">        // worker has been stopped</div><div class="line">        // cleanup work (if needed)</div><div class="line">        // sample: update the screen to display worker stopped</div><div class="line">        $(&apos;#output&apos;).append(&apos;&lt;div&gt;Worker stopped&lt;/div&gt;&apos;);</div><div class="line">    &#125; else &#123;</div><div class="line">        // Normal message. Act upon data as needed</div><div class="line">        // Sample: display data on screen</div><div class="line">        $(&apos;#output&apos;).append(&apos;&lt;div&gt;&apos; + e.data + &apos;&lt;/div&gt;&apos;);</div><div class="line">    &#125;</div><div class="line">&#125;);</div><div class="line"></div><div class="line">// When you&apos;re ready, send the start message</div><div class="line">worker.postMessage(&apos;START&apos;);</div><div class="line"></div><div class="line">// Send data as needed</div><div class="line">worker.postMessage(&apos;sample data&apos;);</div><div class="line"></div><div class="line">// Stop worker when you&apos;re done</div><div class="line">worker.postMessage(&apos;STOP&apos;);</div></pre></td></tr></table></figure>
</li>
</ul>
</li>
</ul>
</li>
<li><p>Using deferred</p>
<ul>
<li><p>Deferred</p>
<p><code>Deferred</code> and <code>promise</code> seem very similar.The difference between the two is who uses which.</p>
<p><code>Deferred</code> is used to create, and manage, a <code>promise</code> object.</p>
<p>A <code>promise</code> object is returned by a long running operation, and only allows you to register event handlers.</p>
<p><code>Deferred</code> is the <strong>server</strong> side.  When <strong>create</strong> a long running function that will be called by other developers, you’ll use <code>Deferred</code>to return a <code>promise</code>.</p>
<p><code>promise</code> is the <strong>client</strong> side. When you <strong>call</strong> a long running function, it will return a <code>promise</code>.</p>
</li>
<li><p>When to use Deferred</p>
<p>when you are creating a function that will <strong>take an unusual amount of time</strong>, say one that will be working with graphics, you will want to use <code>Deffered</code> to return a <code>promise</code> to the caller.</p>
</li>
<li><p>Breaking down using Deferred</p>
<p>The basic steps are as follows.</p>
<ol>
<li>Create an instance of deferred: var deferred = $.Deferred();</li>
<li>Start your asynchronous operation, typically using a worker</li>
<li>Add the appropriate code to detect success and send the success signal: deferred.resolve()</li>
<li>Add the appropriate code to detect failure and send the failure signal: deferred.reject()</li>
<li>Return the promise: return deferred.promise();</li>
</ol>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div></pre></td><td class="code"><pre><div class="line">function beginProcessing() &#123;</div><div class="line">	// Create deferred object &amp; make sure it&apos;s going to be in scope</div><div class="line">	var deferred = new $.Deferred();</div><div class="line"></div><div class="line">	// Create our worker (just like before)</div><div class="line">	var worker = new Worker(&apos;./Scripts/deferred.js&apos;);</div><div class="line"></div><div class="line">	// Register the message event handler</div><div class="line">	worker.addEventListener(&apos;message&apos;, function (e) &#123;</div><div class="line">		// simple messaging - if the worker is ready it&apos;ll send a message with READY as the text</div><div class="line">		if (e.data === &apos;READY&apos;) &#123;</div><div class="line">			// No UI code</div><div class="line">			// Progress notification</div><div class="line">			deferred.notify(&apos;Worker started&apos;);</div><div class="line">		&#125; else if(e.data === &apos;COMPLETED&apos;) &#123;</div><div class="line">			// processing is done</div><div class="line">			// No UI code</div><div class="line">			// Completed notification</div><div class="line">			deferred.resolve(&apos;Worker completed&apos;);</div><div class="line"></div><div class="line">			worker.terminate();</div><div class="line">		&#125;</div><div class="line">	&#125;);</div><div class="line"></div><div class="line">	return deferred.promise();</div><div class="line">&#125;</div></pre></td></tr></table></figure>
</li>
</ul>
</li>
</ul>
<hr>
<p>  学这一章的时候，作为一个前端小白，我的内心响起一个声音：尼玛这都是什么鬼？</p>
<p>  说人话,附上我对这三个概念的理解：</p>
<p>  欢迎拍砖，皮厚不怕疼：P</p>
<p>  promise是一个需要运行很长时间的jQuery函数会返回的东东，告诉caller，函数的运行状态，caller可以根据状态来执行相应代码。</p>
<p>  Worker是用来在进程中插一脚的东东，通过message来传递状态，什么时候开始运行worker script，什么时候结束。</p>
<p>  Deferred呢？用来生成，管理promise。</p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="http://lupeipei.github.io/2017/10/07/introduction-to-jquery-module2-2/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Lucia">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/source/images/avtar.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Lucia">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2017/10/07/introduction-to-jquery-module2-2/" itemprop="url">
                  Introduction to jQuery_3
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-10-07T06:34:37+08:00">
                2017-10-07
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Web/" itemprop="url" rel="index">
                    <span itemprop="name">Web</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
              <span class="post-comments-count">
                <span class="post-meta-divider">|</span>
                <span class="post-meta-item-icon">
                  <i class="fa fa-comment-o"></i>
                </span>
                <a href="/2017/10/07/introduction-to-jquery-module2-2/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count disqus-comment-count"
                        data-disqus-identifier="2017/10/07/introduction-to-jquery-module2-2/" itemprop="commentCount"></span>
                </a>
              </span>
            
          

          
          

          

          

          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h4 id="Before-Start"><a href="#Before-Start" class="headerlink" title="Before Start"></a>Before Start</h4><p>The following contents are the notes I took when learning  jQuery on Edx.</p>
<p>Mainly for  front-End Web developers, check <a href="https://courses.edx.org/courses/course-v1:Microsoft+DEV208x+4T2017/course/" target="_blank" rel="external">here</a> to get more details.</p>
<h4 id="CONTENTS"><a href="#CONTENTS" class="headerlink" title="CONTENTS"></a>CONTENTS</h4><p>Three parts:</p>
<ul>
<li><a href="https://lupeipei.github.io/2017/10/05/introduction-to-jQuery-module1/">Adding jQuery to web pages</a></li>
<li>Managing content, events and effects</li>
<li><a href="https://lupeipei.github.io/2017/10/08/introduction-to-jquery-module3-1/">Asynchronous operations and Ajax calls</a></li>
</ul>
<h4 id="Module2-Managing-content-events-and-effects"><a href="#Module2-Managing-content-events-and-effects" class="headerlink" title="Module2 : Managing content, events and effects"></a>Module2 : Managing content, events and effects</h4><p>Module2 includes six parts:</p>
<ul>
<li>Event handlers</li>
<li>Modifying elements</li>
<li>Registering event handlers</li>
<li>Adding new elements</li>
<li>Animations</li>
<li>Removing, replacing and cloning</li>
</ul>
<p>Let’s get to know something about the last three parts of Module2.</p>
<ul>
<li><p><strong>Adding new elements</strong></p>
<ul>
<li><p>Internal DOM manipulation</p>
<p><code>append</code>, <code>appendTo</code>, <code>prepend</code> and <code>prependTo</code>.</p>
<p>Remember that the element you target will become the <strong>container</strong> for the new element. So using <code>append</code> will add a new element <strong>inside</strong> the target, not after the element.</p>
<ul>
<li><p><code>prepend</code> and <code>prependTo</code></p>
<p>Add new content to the <strong>begining</strong> of the contents of a target.</p>
<p>Example:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div></pre></td><td class="code"><pre><div class="line">&lt;!-- starting HTML --&gt;</div><div class="line">&lt;div id=&quot;target&quot;&gt;</div><div class="line">	&lt;div&gt;existing content&lt;/div&gt;</div><div class="line">&lt;/div&gt;</div><div class="line"></div><div class="line">//executed either of the lines of JavaScript below</div><div class="line">// prepend is called on the target, and accepts the new content as the parameter</div><div class="line">$(&apos;#target&apos;).prepend(&apos;&lt;div&gt;New content&lt;/div&gt;&apos;);</div><div class="line"></div><div class="line">//or you can use prependTo</div><div class="line">// prependTo is called on the new content, and accepts the target as the parameter</div><div class="line">$(&apos;&lt;div&gt;New content&lt;/div&gt;&apos;).prependTo(&apos;#target&apos;);</div><div class="line"></div><div class="line"></div><div class="line">&lt;!-- ending HTML --&gt;</div><div class="line">&lt;div id=&quot;target&quot;&gt;</div><div class="line">	&lt;div&gt;New content&lt;/div&gt;</div><div class="line">	&lt;div&gt;existing content&lt;/div&gt;</div><div class="line">&lt;/div&gt;</div></pre></td></tr></table></figure>
</li>
<li><p><code>append</code> and <code>appendTo</code></p>
<p>Add new content to the <strong>end</strong> of the contents of a target.</p>
<p>Example:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div></pre></td><td class="code"><pre><div class="line">&lt;!-- starting HTML --&gt;</div><div class="line">&lt;div id=&quot;target&quot;&gt;</div><div class="line">	&lt;div&gt;existing content&lt;/div&gt;</div><div class="line">&lt;/div&gt;</div><div class="line"></div><div class="line">//executed either of the lines of JavaScript below</div><div class="line">// append is called on the target, and accepts the new content as the parameter</div><div class="line">$(&apos;#target&apos;).append(&apos;&lt;div&gt;New content&lt;/div&gt;&apos;);</div><div class="line"></div><div class="line">// appendTo is called on the new content, and accepts the target as the parameter</div><div class="line">$(&apos;&lt;div&gt;New content&lt;/div&gt;&apos;).appendTo(&apos;#target&apos;);</div><div class="line"></div><div class="line">&lt;!-- ending HTML --&gt;</div><div class="line">&lt;div id=&quot;target&quot;&gt;</div><div class="line">	&lt;div&gt;existing content&lt;/div&gt;</div><div class="line">	&lt;div&gt;New content&lt;/div&gt;</div><div class="line">&lt;/div&gt;</div></pre></td></tr></table></figure>
</li>
</ul>
</li>
<li><p>External DOM manipulation</p>
<p><code>after</code>, <code>insertAfter</code>, <code>before</code>, and <code>insertBefore</code></p>
<ul>
<li><p><code>after</code> and <code>insertAfter</code></p>
<p>Add new content after the target.</p>
<p>Example:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div></pre></td><td class="code"><pre><div class="line">&lt;!-- starting HTML --&gt;</div><div class="line">&lt;div id=&quot;target&quot;&gt;</div><div class="line">	&lt;div&gt;existing content&lt;/div&gt;</div><div class="line">&lt;/div&gt;</div><div class="line"></div><div class="line">//executed either of the lines of JavaScript below</div><div class="line">// after is called on the target, and accepts the new content as a parameter</div><div class="line">$(&apos;target&apos;).after(&apos; New content&apos;);</div><div class="line"></div><div class="line">// insertAfter is called on the new content, and accepts the target as a parameter</div><div class="line">$(&apos; New content&apos;).insertAfter(&apos;#target&apos;);</div><div class="line"></div><div class="line">&lt;!-- ending HTML --&gt;</div><div class="line">&lt;div id=&quot;target&quot;&gt;</div><div class="line">	&lt;div&gt;existing content&lt;/div&gt;</div><div class="line">&lt;/div&gt;</div><div class="line">&lt;div&gt;New content&lt;/div&gt;</div></pre></td></tr></table></figure>
</li>
<li><p><code>before</code> and <code>insertBefore</code></p>
<p>Add new content before the target.</p>
<p>Example:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div></pre></td><td class="code"><pre><div class="line">&lt;!-- starting HTML --&gt;</div><div class="line">&lt;div id=&quot;target&quot;&gt;</div><div class="line">	&lt;div&gt;existing content&lt;/div&gt;</div><div class="line">&lt;/div&gt;</div><div class="line"></div><div class="line">//executed either of the lines of JavaScript below</div><div class="line">// before is called on the target, and accepts the new content as a parameter</div><div class="line">$(&apos;target&apos;).before(&apos;New content&apos;);</div><div class="line"></div><div class="line">// insertBefore is called on the new content, and accepts the target as a parameter</div><div class="line">$(&apos;New content&apos;).insertBefore(&apos;#target&apos;);</div><div class="line"></div><div class="line">&lt;!-- ending HTML --&gt;</div><div class="line">&lt;div&gt;New content&lt;/div&gt;</div><div class="line">&lt;div id=&quot;target&quot;&gt;</div><div class="line">	&lt;div&gt;existing content&lt;/div&gt;</div><div class="line">&lt;/div&gt;</div></pre></td></tr></table></figure>
</li>
</ul>
</li>
<li><p>Wrapping content</p>
<p>To manipulate the DOM by surrounding existing content with a new element.</p>
<ul>
<li><p><code>wrap</code></p>
<p>wraps <strong>each item</strong> with the element passed into the function.</p>
<p>Example:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div></pre></td><td class="code"><pre><div class="line">&lt;!-- starting HTML --&gt;</div><div class="line">&lt;div id=&quot;target&quot;&gt;</div><div class="line">	&lt;div class=&quot;demo&quot;&gt;Item one&lt;/div&gt;</div><div class="line">	&lt;div class=&quot;demo&quot;&gt;Item two&lt;/div&gt;</div><div class="line">&lt;/div&gt;</div><div class="line"></div><div class="line">//JS</div><div class="line">$(&apos;.demo&apos;).wrap(&apos;&lt;section&gt;&lt;/section&gt;&apos;);</div><div class="line"></div><div class="line">&lt;!-- ending HTML --&gt;</div><div class="line">&lt;div id=&quot;target&quot;&gt;</div><div class="line">	&lt;section&gt;</div><div class="line">		&lt;div class=&quot;demo&quot;&gt;Item one&lt;/div&gt;</div><div class="line">	&lt;/section&gt;</div><div class="line">	&lt;section&gt;</div><div class="line">		&lt;div class=&quot;demo&quot;&gt;Item two&lt;/div&gt;</div><div class="line">	&lt;/section&gt;</div><div class="line">&lt;/div&gt;</div></pre></td></tr></table></figure>
</li>
<li><p><code>wrapAll</code></p>
<p> returned content with one new element.</p>
<p>Example:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div></pre></td><td class="code"><pre><div class="line">&lt;!-- starting HTML --&gt;</div><div class="line">&lt;div id=&quot;target&quot;&gt;</div><div class="line">	&lt;div class=&quot;demo&quot;&gt;Item one&lt;/div&gt;</div><div class="line">	&lt;div class=&quot;demo&quot;&gt;Item two&lt;/div&gt;</div><div class="line">&lt;/div&gt;</div><div class="line"></div><div class="line">//JS</div><div class="line">$(&apos;.demo&apos;).wrapAll(&apos;&lt;section&gt;&lt;/section&gt;&apos;);</div><div class="line"></div><div class="line">&lt;!-- ending HTML --&gt;</div><div class="line">&lt;div id=&quot;target&quot;&gt;</div><div class="line">	&lt;section&gt;</div><div class="line">		&lt;div class=&quot;demo&quot;&gt;Item one&lt;/div&gt;</div><div class="line">		&lt;div class=&quot;demo&quot;&gt;Item two&lt;/div&gt;</div><div class="line">	&lt;/section&gt;</div><div class="line">&lt;/div&gt;</div></pre></td></tr></table></figure>
</li>
<li><p><code>wrapInner</code></p>
<p>Operates on the children of the target, rather than on the target itself.</p>
<p>Example:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div></pre></td><td class="code"><pre><div class="line">&lt;!-- starting HTML --&gt;</div><div class="line">&lt;div id=&quot;target&quot;&gt;</div><div class="line">	&lt;div class=&quot;demo&quot;&gt;Item one&lt;/div&gt;</div><div class="line">	&lt;div class=&quot;demo&quot;&gt;Item two&lt;/div&gt;</div><div class="line">&lt;/div&gt;</div><div class="line"></div><div class="line">//JS</div><div class="line">$(&apos;#target&apos;).wrapInner(&apos;&lt;section&gt;&lt;/section&gt;&apos;);</div><div class="line"></div><div class="line">&lt;!-- ending HTML --&gt;</div><div class="line">&lt;div id=&quot;target&quot;&gt;</div><div class="line">	&lt;section&gt;</div><div class="line">		&lt;div&gt;Item one&lt;/div&gt;</div><div class="line">		&lt;div&gt;Item two&lt;/div&gt;</div><div class="line">	&lt;/section&gt;</div><div class="line">&lt;/div&gt;</div></pre></td></tr></table></figure>
</li>
</ul>
</li>
</ul>
</li>
<li><p><strong>Animations</strong></p>
<ul>
<li><p><code>hide</code>, <code>show</code>, <code>toggle</code></p>
<p><code>hide</code> causes something to disappear from the screen;</p>
<p><code>show</code> causes something to appear;</p>
<p><code>toggle</code>, on the other hand, determines the current status of the item in question and changes it.</p>
<p> jQuery controls visibility by using the <code>display</code> property in CSS.</p>
<p>Example:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line">&lt;!-- HTML --&gt;</div><div class="line">&lt;div id=&quot;target&quot;&gt;Show or hide&lt;/div&gt;</div><div class="line">&lt;button type=&quot;button&quot; id=&quot;btn-toggle&quot;&gt;Toggle&lt;/button&gt;</div><div class="line"></div><div class="line">//JS</div><div class="line">$(function() &#123;</div><div class="line">	$(&apos;#btn-toggle&apos;).click(function() &#123;</div><div class="line">		// animation will take one second</div><div class="line">		$(&apos;#target&apos;).toggle(1000);</div><div class="line">	&#125;);</div><div class="line">&#125;);</div></pre></td></tr></table></figure>
<p>More:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div></pre></td><td class="code"><pre><div class="line">&lt;!-- HTML --&gt;</div><div class="line">&lt;style&gt;</div><div class="line">    .hidden &#123; display: none; &#125;</div><div class="line">&lt;/style&gt;</div><div class="line">&lt;form&gt;</div><div class="line">    &lt;div&gt;</div><div class="line">        &lt;label&gt;Name:&lt;/label&gt;</div><div class="line">        &lt;input type=&quot;text&quot; /&gt;</div><div class="line">    &lt;/div&gt;</div><div class="line">    &lt;button type=&quot;button&quot; id=&quot;show-additional-information&quot;&gt;</div><div class="line">        Show additional information</div><div class="line">    &lt;/button&gt;</div><div class="line">    &lt;div id=&quot;additional-information&quot; class=&quot;hidden&quot;&gt;</div><div class="line">        &lt;label&gt;Additional information:&lt;/label&gt;</div><div class="line">        &lt;input type=&quot;text&quot; /&gt;</div><div class="line">    &lt;/div&gt;</div><div class="line">&lt;/form&gt;</div><div class="line"></div><div class="line">//JS</div><div class="line">$(function() &#123;</div><div class="line">    $(&apos;#show-additional-information&apos;).click(function() &#123;</div><div class="line">        $(&apos;#additional-information&apos;).show(750);</div><div class="line">    &#125;);</div><div class="line">&#125;);</div></pre></td></tr></table></figure>
</li>
<li><p>fading and sliding</p>
<ul>
<li><p><code>fadeIn</code>, <code>fadeOut</code>, <code>fadeToggle</code></p>
<p>The fading functions perform their work by both modifying the CSS <code>display</code> property, and animates the item by modifying its <code>opacity</code>.</p>
<p><code>fadeIn</code> and <code>fadeOut</code> will display and hide an item respectively.</p>
<p><code>fadeToggle</code> will reverse the current state of the item.</p>
</li>
<li><p><code>slideDown</code>, <code>slideUp</code> , <code>slideToggle</code></p>
<p>The sliding functions perform their work by both modifying the CSS <code>display</code> property, and animates the item by modifying its <code>position</code>.</p>
</li>
</ul>
</li>
</ul>
</li>
<li><p><strong>Removing, replacing and cloning</strong></p>
<ul>
<li><p>Removing and replacing items</p>
<ul>
<li><p><code>remove</code> and <code>empty</code></p>
<p>Both completely delete items from the DOM.</p>
<p> <code>remove</code> deletes the item you target.</p>
<p> <code>empty</code> deletes the contents of the item you target.</p>
<p>Example:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div></pre></td><td class="code"><pre><div class="line">&lt;div id=&quot;target&quot;&gt;</div><div class="line">    &lt;div&gt;Some cool content&lt;/div&gt;</div><div class="line">    &lt;div&gt;Some more cool content&lt;/div&gt;</div><div class="line">&lt;/div&gt;</div><div class="line"></div><div class="line">//JS</div><div class="line">//the resulting HTML would be, well, nothing. The entire contents of the sample are removed</div><div class="line">$(function() &#123;</div><div class="line">	$(&apos;#target&apos;).remove();</div><div class="line">&#125;</div><div class="line"></div><div class="line">//deletes the contents of the target, so the resulting HTML would be as &lt;div id=&quot;target&quot;&gt;&lt;/div&gt;</div><div class="line"></div><div class="line">$(function() &#123;</div><div class="line">	$(&apos;#target&apos;).empty();</div><div class="line">&#125;</div></pre></td></tr></table></figure>
</li>
<li><p><code>replaceAll</code> and <code>replaceWith</code></p>
<p> replace existing content with new content.</p>
<p>Example:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line">&lt;!-- starting HTML --&gt;</div><div class="line">&lt;div id=&quot;target&quot;&gt;</div><div class="line">    &lt;div&gt;Some cool content&lt;/div&gt;</div><div class="line">    &lt;div&gt;Some more cool content&lt;/div&gt;</div><div class="line">&lt;/div&gt;</div><div class="line"></div><div class="line">//JS. execute either of them</div><div class="line">// replaceWith replaces the content on the left with the new content in the parameter</div><div class="line">$(&apos;#target&apos;).replaceWith(&apos;&lt;div&gt;NEW content&lt;/div&gt;&apos;);</div><div class="line"></div><div class="line">// replaceAll replaces the target in the parameter with the content on the left</div><div class="line">$(&apos;&lt;div&gt;NEW content&lt;/div&gt;&apos;).replaceAll(&apos;#target&apos;);</div><div class="line"></div><div class="line">&lt;!-- ending HTML --&gt;</div><div class="line">&lt;div&gt;NEW content&lt;/div&gt;</div></pre></td></tr></table></figure>
</li>
</ul>
</li>
<li><p>Cloning</p>
<ul>
<li><code>clone</code></li>
</ul>
<p><code>clone</code> allows you to make a copy of jQuery objects.</p>
<p>Let’s say you were building a page to allow an administrator to create email addresses and passwords. You’d like to ensure the administrator can create as many accounts as they would like on one page, and be able to send up all of the information to the server <strong>in one round trip</strong>, rather than using Ajax calls or submitting the form for each account.</p>
<p>code:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div></pre></td><td class="code"><pre><div class="line">&lt;!-- HTML --&gt;</div><div class="line">&lt;button type=&quot;button&quot; id=&quot;add-line&quot;&gt;Add new line&lt;/button&gt;</div><div class="line">&lt;div id=&quot;container&quot;&gt;</div><div class="line">	&lt;div class=&quot;user-entry&quot;&gt;</div><div class="line">		&lt;label&gt;Email:&lt;/label&gt;</div><div class="line">		&lt;input type=&quot;email&quot; /&gt;</div><div class="line">		&lt;label&gt;Password:&lt;/label&gt;</div><div class="line">		&lt;input type=&quot;password&quot; /&gt;</div><div class="line">	&lt;/div&gt;</div><div class="line">&lt;/div&gt;</div><div class="line"></div><div class="line">//JS</div><div class="line"> $(function() &#123;</div><div class="line"> 	$userForm = $(&apos;.user-entry&apos;).clone;</div><div class="line">	$(&apos;#add-line&apos;).click(function() &#123;</div><div class="line">		$(&apos;#container&apos;).append($userForm.clone());</div><div class="line">	&#125;);</div><div class="line"> &#125;);</div></pre></td></tr></table></figure>
<p><strong>Attention:</strong></p>
<p>When you’re working with an object, JavaScript passes a reference to the object, not a copy of the object. This would mean that we’ve added in a pointer to the clone we created earlier, <strong>not</strong> a brand new copy. The end result is that if we did not call <code>clone()</code> a second time, we’d be trying to add <strong>the exact same object</strong> into the container again, <strong>not</strong> a brand new copy. By calling <code>clone()</code> again, we pass in a copy of our user form, rather than a pointer to the one we already used.</p>
<ul>
<li><p>Cloning and animations</p>
<p>Combinnig cloning and animations.</p>
<p>Example:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div></pre></td><td class="code"><pre><div class="line">&lt;!-- HTML --&gt;</div><div class="line">&lt;button type=&quot;button&quot; id=&quot;add-line&quot;&gt;Add new line&lt;/button&gt;</div><div class="line">&lt;div id=&quot;container&quot;&gt;</div><div class="line">  &lt;div class=&quot;user-entry&quot;&gt;</div><div class="line">    &lt;label&gt;Email:&lt;/label&gt;</div><div class="line">    &lt;input type=&quot;email&quot; /&gt;</div><div class="line">    &lt;label&gt;Password:&lt;/label&gt;</div><div class="line">    &lt;input type=&quot;password&quot; /&gt;</div><div class="line">  &lt;/div&gt;</div><div class="line">&lt;/div&gt;</div><div class="line"></div><div class="line">//JS</div><div class="line">$(function() &#123;</div><div class="line">    $userForm = $(&apos;.user-entry&apos;).clone();</div><div class="line">    $userForm.css(&apos;display&apos;, &apos;none&apos;);</div><div class="line">    $(&apos;#add-line&apos;).click(function() &#123;</div><div class="line">        var newUserForm = $userForm.clone();</div><div class="line">        $(&apos;#container&apos;).append($newUserForm);</div><div class="line">        newUserForm.show(1000);</div><div class="line">    &#125;);</div><div class="line">&#125;);</div></pre></td></tr></table></figure>
<p>This is  Module2 all about. More <a href="https://courses.edx.org/courses/course-v1:Microsoft+DEV208x+4T2017/course/" target="_blank" rel="external">details</a>.</p>
</li>
</ul>
</li>
</ul>
</li>
</ul>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="http://lupeipei.github.io/2017/10/06/introduction-to-jquery-module2-1/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Lucia">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/source/images/avtar.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Lucia">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2017/10/06/introduction-to-jquery-module2-1/" itemprop="url">
                  Introduction to jQuery_2
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-10-06T08:32:55+08:00">
                2017-10-06
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Web/" itemprop="url" rel="index">
                    <span itemprop="name">Web</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
              <span class="post-comments-count">
                <span class="post-meta-divider">|</span>
                <span class="post-meta-item-icon">
                  <i class="fa fa-comment-o"></i>
                </span>
                <a href="/2017/10/06/introduction-to-jquery-module2-1/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count disqus-comment-count"
                        data-disqus-identifier="2017/10/06/introduction-to-jquery-module2-1/" itemprop="commentCount"></span>
                </a>
              </span>
            
          

          
          

          

          

          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h4 id="Before-Start"><a href="#Before-Start" class="headerlink" title="Before Start"></a>Before Start</h4><p>The following contents are the notes I took when learning  jQuery on Edx.</p>
<p>Mainly for  front-End Web developers, check <a href="https://courses.edx.org/courses/course-v1:Microsoft+DEV208x+4T2017/course/" target="_blank" rel="external">here</a> to get more details.</p>
<h4 id="CONTENTS"><a href="#CONTENTS" class="headerlink" title="CONTENTS"></a>CONTENTS</h4><p>Three parts:</p>
<ul>
<li><a href="https://lupeipei.github.io/2017/10/05/introduction-to-jQuery-module1/">Adding jQuery to web pages</a></li>
<li>Managing content, events and effects</li>
<li><a href="https://lupeipei.github.io/2017/10/08/introduction-to-jquery-module3-1/">Asynchronous operations and Ajax calls</a></li>
</ul>
<h4 id="Module2-Managing-content-events-and-effects"><a href="#Module2-Managing-content-events-and-effects" class="headerlink" title="Module2 : Managing content, events and effects"></a>Module2 : Managing content, events and effects</h4><p>Module2 includes six parts:</p>
<ul>
<li>Event handlers</li>
<li>Modifying elements</li>
<li>Registering event handlers</li>
<li>Adding new elements</li>
<li>Animations</li>
<li>Removing, replacing and cloning</li>
</ul>
<p>Let’s get to know something about the first three parts.</p>
<ul>
<li><p><strong>Event handlers</strong></p>
<p>Event object:</p>
<blockquote>
<p>Beyond just the object that raised the event, jQuery (and JavaScript) also pass an <code>event</code> object to the event handler.</p>
<p>This object can be used to determine additional information, such as where the mouse was when the user performed the operation.</p>
</blockquote>
<p>Example:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">// Write out the x/y coordinates of the mouse on click</div><div class="line">$(&apos;button&apos;).click(function(e) &#123;</div><div class="line">    $(&apos;#output&apos;).text(e.pageX + &apos;x&apos; + e.pageY);</div><div class="line">&#125;);</div></pre></td></tr></table></figure>
<ul>
<li><p><code>Click</code></p>
<p>Example:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">$(&apos;#target&apos;).click(function() &#123; alert(&apos;hello, world!&apos;); &#125;);</div></pre></td></tr></table></figure>
</li>
<li><p><code>dbclick</code></p>
<p> raised when the user double clicks on an element.</p>
<p>Example:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">$(&apos;#target&apos;).dbclick(function()&#123; alert(&apos;hello, world!&apos;); &#125;);</div></pre></td></tr></table></figure>
</li>
<li><p>Forms : blur, change, focus</p>
<ul>
<li><p><code>blur</code></p>
<p>raised when a form element loses what’s known as focus. often used for validation.</p>
<p>Example:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">$(&apos;#target&apos;).blur(function() &#123;</div><div class="line">    // retrieve the value using val</div><div class="line">    var value = $(&apos;#target&apos;).val();</div><div class="line">    alert(value);</div><div class="line">&#125;)</div></pre></td></tr></table></figure>
</li>
<li><p><code>change</code></p>
<p>raised whenever an element is modified.<strong>limited</strong> to <code>input</code>, <code>textarea</code> and <code>select</code> elements only.</p>
<p>Example:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">$(function() &#123;</div><div class="line">  $(&apos;#parent&apos;).change(function() &#123;</div><div class="line">    var value = $(&apos;#parent&apos;).val();</div><div class="line">    $(&apos;#child&apos;).empty();</div><div class="line">    $(&apos;#child&apos;).append(&apos;&lt;option&gt;1 - &apos; + value + &apos;&lt;/option&gt;&apos;);</div><div class="line">    $(&apos;#child&apos;).append(&apos;&lt;option&gt;2 - &apos; + value + &apos;&lt;/option&gt;&apos;);</div><div class="line">  &#125;)</div><div class="line">&#125;);</div></pre></td></tr></table></figure>
</li>
<li><p><code>focus</code></p>
<p>the opposite of <code>blur</code>. raised when the user clicks, taps, or tabs into a particular control, typically because they want to change its value.</p>
<p>Example:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line">&lt;!-- sample HTML --&gt;</div><div class="line">&lt;div&gt;</div><div class="line">    &lt;label for=&quot;phone&quot;&gt;Phone&lt;/label&gt;</div><div class="line">    &lt;input type=&quot;text&quot; id=&quot;phone&quot; /&gt;</div><div class="line">    &lt;span id=&quot;phone-help&quot;&gt;&lt;/span&gt;</div><div class="line">&lt;/div&gt;</div><div class="line"></div><div class="line">// sample JavaScript</div><div class="line">$(&apos;#phone&apos;).focus(function() &#123;</div><div class="line">    // Control has focus. Display help</div><div class="line">    $(&apos;#phone-help&apos;).text(&apos;Please enter your phone number as all digits&apos;);</div><div class="line">&#125;).blur(function() &#123;</div><div class="line">    // Control lost focus. Clear help</div><div class="line">    $(&apos;#phone-help&apos;).text(&apos;&apos;);</div><div class="line">&#125;);</div></pre></td></tr></table></figure>
</li>
</ul>
</li>
<li><p>Mouse movement</p>
<ul>
<li><p><code>mouseenter</code>, <code>mouseleave</code></p>
<p><code>mouseenter</code> is raised whenever the user moves their mouse over an element.</p>
<p><code>mouseleave</code> is raised when the user moves their mouse away from an element.</p>
<p>Example:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line">&lt;!-- sample HTML --&gt;</div><div class="line">&lt;div&gt;</div><div class="line">	&lt;span id=&quot;target&quot;&gt;Basic data&lt;/span&gt;</div><div class="line">	&lt;span id=&quot;target-help&quot;&gt;&lt;/span&gt;</div><div class="line">&lt;/div&gt;</div><div class="line"></div><div class="line">// sample JavaScript</div><div class="line">$(&apos;#target&apos;).mouseenter(function() &#123;</div><div class="line">	$(&apos;#target-help&apos;).text(&apos;More data&apos;);</div><div class="line">&#125;).mouseleave(function() &#123;</div><div class="line">	$(&apos;#target-help&apos;).text(&apos;&apos;);</div><div class="line">&#125;);</div></pre></td></tr></table></figure>
</li>
<li><p><code>hover</code></p>
<p>equivalent to both the <code>mouseenter</code> and <code>mouseleave</code> events. The first parameter <code>hover</code> accepts is for <code>mouseenter</code>, or when the hover begins, and the second parameter is for <code>mouseout</code>.</p>
<p>Example:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">$(&apos;#target&apos;).hover(function() &#123;</div><div class="line">	// mouseenter</div><div class="line">	$(&apos;#target-help&apos;).text(&apos;More data&apos;);</div><div class="line">&#125;, function() &#123;</div><div class="line">	// mouseleave</div><div class="line">	$(&apos;#target-help&apos;).text(&apos;&apos;);</div><div class="line">&#125;);</div></pre></td></tr></table></figure>
<p>​</p>
</li>
</ul>
</li>
</ul>
</li>
<li><p><strong>Modifying elements</strong></p>
<ul>
<li><p>Replacing element HTML and text</p>
<ul>
<li><p><code>val</code></p>
<p>for read the value, like to say retrieve the value of an input control, you can use <code>val()</code></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">var value = $(&apos;#some-input-control&apos;).val();</div></pre></td></tr></table></figure>
<p>also, you can set the value. use <code>val(new-value)</code></p>
<p>Example: set a textbox to a blank value</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">// Empty a textbox</div><div class="line">$(&apos;#some-textbox&apos;).val(&apos;&apos;);</div></pre></td></tr></table></figure>
</li>
<li><p><code>html</code></p>
<p>you have saw it in Module1.</p>
<p>Example:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">// write text out to the screen</div><div class="line">// this will be displayed as</div><div class="line">// &lt;strong&gt;value&lt;/strong&gt;</div><div class="line">// the text value will not be bolded</div><div class="line"></div><div class="line">$(&apos;#output&apos;).text(&apos;value&apos;);</div></pre></td></tr></table></figure>
</li>
<li><p><code>text</code></p>
<p>Example:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">// write text out to the screen</div><div class="line">// this will be displayed as value</div><div class="line">// with the word bolded</div><div class="line"></div><div class="line">$(&apos;#output&apos;).html(&apos;value&apos;);</div></pre></td></tr></table></figure>
</li>
</ul>
</li>
<li><p>Working with attribute and classes</p>
<ul>
<li><p><code>attr</code></p>
<p>To retrieve the value of an attribute, simply call <code>attr(name)</code>.</p>
<p>To change the value of an attribute, simply call <code>attr(name, newValue)</code>.</p>
</li>
<li><p><code>addClass</code> and <code>removeClass</code></p>
<p>You have known it in Module1. Besides, one nice thing about <code>removeClass</code> is it will not throw an error if the class doesn’t exist.</p>
</li>
</ul>
</li>
<li><p>Working with styles</p>
<ul>
<li><p><code>css</code></p>
<p>To retrieve the value of a CSS property,  call <code>css(property)</code>.</p>
<p>To set a property, call <code>css(property, newValue)</code></p>
<p>Example:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">// Retrieve an item&apos;s color</div><div class="line">var color = $(&apos;#target&apos;).css(&apos;color&apos;);</div><div class="line"></div><div class="line">// Change an item&apos;s color to red</div><div class="line">$(&apos;#target&apos;).css(&apos;color&apos;, &apos;red&apos;);</div></pre></td></tr></table></figure>
<p>To set multiple properties,  create a JavaScript object with the property/value pairs, and then pass the object into the <code>css</code> function.</p>
<p>Example:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">var style = &#123;</div><div class="line">	color: &apos;red&apos;,</div><div class="line">	backgroundColor: yellow</div><div class="line">&#125;;</div><div class="line"></div><div class="line">$(&apos;#target&apos;).css(style);</div></pre></td></tr></table></figure>
</li>
</ul>
</li>
</ul>
</li>
<li><p><strong>Registering event handlers</strong></p>
<ul>
<li><p>Dynamic event handlers</p>
<ul>
<li><p><code>on</code>, <code>off</code></p>
<p>Both <code>on</code> and <code>off</code> share the same syntax:</p>
<p><code>$(&#39;selector&#39;).on/off(&#39;events&#39;, &#39;selector (optional)&#39;, function)</code></p>
<p>Here, <code>events</code>: A space separated list of the events you wish to register, such as <code>&#39;click&#39;</code> or <code>&#39;click mouseenter&#39;</code></p>
<p> BTW, Obviously if you need to <strong>dynamically choose the event</strong>, or if you need <strong>multiple events for the same event handler</strong>, using <code>on</code> is your only choice.</p>
<p>In additon, <code>on</code> offers one more feature, known as delegation.</p>
</li>
</ul>
</li>
<li><p>Delegation</p>
<p>Registering an event handler using <code>delegate</code>,  is similar to <code>on</code>, with one major difference: New elements will automatically have the event handler applied.</p>
<p>The <code>delegate</code> syntax:</p>
<p><code>$(selector).delegate(selector, events, eventHandler)</code></p>
<p>Example:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div></pre></td><td class="code"><pre><div class="line">&lt;!-- sample HTML --&gt;</div><div class="line">&lt;button&gt;Click&lt;/button&gt;</div><div class="line">&lt;div id=&quot;placeholder&quot;&gt;&lt;/div&gt;</div><div class="line"></div><div class="line">//JS</div><div class="line">$(function() &#123;</div><div class="line">	// document.ready (on load)</div><div class="line"></div><div class="line">	// register a click event handler with all button elements, except new button</div><div class="line">	//$(&apos;button&apos;).click(function() &#123; alert(&apos;hello&apos;); &#125;);</div><div class="line">	// new button will also be raised</div><div class="line">	$(document).delegate(&apos;button&apos;, &apos;click&apos;, function() &#123; alert(&apos;hello&apos;); &#125;);</div><div class="line"></div><div class="line">	// create a new button</div><div class="line">	$(&apos;#placeholder&apos;).html(&apos;&lt;button&gt;New button&lt;/button&gt;&apos;);</div><div class="line">&#125;);</div></pre></td></tr></table></figure>
<p>With jQuery 1.7, <code>delegate</code> is superseded by <code>on</code>.</p>
<p><strong>One important thing to note</strong> is the order of parameters for <code>on</code> and <code>delegate</code>.</p>
<p>With <code>on</code>, you list the events first and the selector second. With <code>delegate</code>, it’s selector followed by events.</p>
<p>Example:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">// Delegation (note the order of parameters)</div><div class="line">$(document).on(&apos;click&apos;, &apos;button&apos;, function() &#123;alert(&apos;hello&apos;); &#125;);</div><div class="line"></div><div class="line">// Semantically the same as above</div><div class="line">// (note the order of parameters)</div><div class="line">$(document).delegate(&apos;button&apos;, &apos;click&apos;, function() &#123; alert(&apos;hello&apos;); &#125;);</div></pre></td></tr></table></figure>
</li>
<li><p>Single execution</p>
<ul>
<li><p><code>one</code></p>
<p><code>one</code> shares a similar syntax with <code>on</code>, only there is no delegation option.</p>
<p>The event only execute once.</p>
<p>Example:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line">&lt;!-- sample HTML --&gt;</div><div class="line">&lt;button id=&quot;single&quot;&gt;This only works once&lt;/button&gt;</div><div class="line">&lt;div id=&quot;output&quot;&gt;&lt;/div&gt;</div><div class="line"></div><div class="line">//JS</div><div class="line">$(function() &#123;</div><div class="line">    $(&apos;#single&apos;).one(&apos;click&apos;, function() &#123;</div><div class="line">        $(&apos;#output&apos;).text(&apos;You clicked on the button&apos;);</div><div class="line">    &#125;);</div><div class="line">&#125;);</div></pre></td></tr></table></figure>
</li>
</ul>
</li>
<li><p>Triggering events</p>
<p>Raise the event programatically, like to click on a button to refresh data.</p>
<p><code>trigger</code> and <code>triggerHandler</code> allow you to provide the name of the event as a parameter.</p>
<p><code>trigger</code> will execute for <strong>all elements</strong> in the collection,</p>
<p>while <code>triggerHandler</code> only executes the handler for <strong>the first element</strong>.</p>
<p>Example:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div></pre></td><td class="code"><pre><div class="line">&lt;!-- sample HTML --&gt;</div><div class="line">&lt;button type=&quot;button&quot; id=&quot;first&quot;&gt;First button&lt;/button&gt;</div><div class="line">&lt;button type=&quot;button&quot; id=&quot;Second&quot;&gt;Second button&lt;/button&gt;</div><div class="line">&lt;button type=&quot;button&quot; id=&quot;trigger&quot;&gt;trigger&lt;/button&gt;</div><div class="line">&lt;button type=&quot;button&quot; id=&quot;trigger-handler&quot;&gt;triggerHandler&lt;/button&gt;</div><div class="line"></div><div class="line">//JS</div><div class="line">$(function() &#123;</div><div class="line">    $(&apos;button&apos;).click(function() &#123;</div><div class="line">        // display the id of the button</div><div class="line">        alert(this.id);</div><div class="line">    &#125;);</div><div class="line"></div><div class="line">    $(&apos;#trigger&apos;).click(function() &#123;</div><div class="line">        // Would alert every button&apos;s id</div><div class="line">        // including the last two</div><div class="line">        $(&apos;button&apos;).trigger(&apos;click&apos;);</div><div class="line">    &#125;);</div><div class="line"></div><div class="line">    // Would alert &quot;first&quot;</div><div class="line">    $(&apos;#trigger-handler&apos;).click(function() &#123;</div><div class="line">        // Would alert &quot;first&quot;</div><div class="line">        $(&apos;button&apos;).triggerHandler(&apos;click&apos;);</div><div class="line">    &#125;);</div><div class="line">&#125;);</div></pre></td></tr></table></figure>
<p>This is the first three parts of Module2 all about. More <a href="https://courses.edx.org/courses/course-v1:Microsoft+DEV208x+4T2017/course/" target="_blank" rel="external">details</a>.</p>
</li>
</ul>
</li>
</ul>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="http://lupeipei.github.io/2017/10/05/introduction-to-jQuery-module1/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Lucia">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/source/images/avtar.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Lucia">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2017/10/05/introduction-to-jQuery-module1/" itemprop="url">
                  Introduction to jQuery_1
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-10-05T10:17:44+08:00">
                2017-10-05
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Web/" itemprop="url" rel="index">
                    <span itemprop="name">Web</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
              <span class="post-comments-count">
                <span class="post-meta-divider">|</span>
                <span class="post-meta-item-icon">
                  <i class="fa fa-comment-o"></i>
                </span>
                <a href="/2017/10/05/introduction-to-jQuery-module1/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count disqus-comment-count"
                        data-disqus-identifier="2017/10/05/introduction-to-jQuery-module1/" itemprop="commentCount"></span>
                </a>
              </span>
            
          

          
          

          

          

          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h4 id="Before-Start"><a href="#Before-Start" class="headerlink" title="Before Start"></a>Before Start</h4><p>The following contents are the notes I took when learning  jQuery on Edx.</p>
<p>Mainly for  front-End Web developers, check <a href="https://courses.edx.org/courses/course-v1:Microsoft+DEV208x+4T2017/course/" target="_blank" rel="external">here</a> to get more details.</p>
<p>BTW, This class is supported by Microsoft. If you are a Linux fan, hope it would not make you uncomfortable( cause I am a little uncomfortable about it at first.) : D</p>
<h4 id="CONTENTS"><a href="#CONTENTS" class="headerlink" title="CONTENTS"></a>CONTENTS</h4><p>Three parts:</p>
<ul>
<li>Adding jQuery to web pages</li>
<li><a href="https://lupeipei.github.io/2017/10/06/introduction-to-jquery-module2-1/">Managing content, events and effects</a></li>
<li><a href="https://lupeipei.github.io/2017/10/08/introduction-to-jquery-module3-1/">Asynchronous operations and Ajax calls</a></li>
</ul>
<p>DOM: Document Object Model.</p>
<p>jQuery : the most popular javaScript library. designed to bring additional power to JS.</p>
<p>Let’s start!</p>
<h4 id="Module1-Adding-jQuery-to-web-pages"><a href="#Module1-Adding-jQuery-to-web-pages" class="headerlink" title="Module1 : Adding jQuery to web pages"></a>Module1 : Adding jQuery to web pages</h4><ul>
<li><p><strong>Getting started with jQuery</strong></p>
<ul>
<li>use Visual Studio</li>
<li>getting started with <a href="https://code.visualstudio.com" target="_blank" rel="external">Visual Studio Code</a></li>
</ul>
</li>
<li><p><strong>Adding jQuery to a page</strong></p>
<p> a simple example to start:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line">// you can use either of them:</div><div class="line"></div><div class="line">$(document).ready(function() &#123;</div><div class="line">	// code here</div><div class="line">&#125;);</div><div class="line"></div><div class="line">$(function() &#123;</div><div class="line">	// code here</div><div class="line">&#125;);</div></pre></td></tr></table></figure>
</li>
<li><p><strong>Using CSS selectors with jQuery</strong></p>
<ul>
<li><p>Common CSS selectors</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">$(&apos;h1&apos;) // selects all h1 elements</div><div class="line">$(&apos;.class-name&apos;) // selects all elements with a class of class-name</div><div class="line">$(&apos;#demo&apos;) // selects all elements with an id of demo</div></pre></td></tr></table></figure>
</li>
<li><p>Attribute based selectors</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line">// selects all elements with an attribute matching the specified value</div><div class="line">$(&apos;[demo-attribute=&quot;demo-value&quot;]&apos;)</div><div class="line"></div><div class="line">// selects all h1 elements with an attribute matching the specified value</div><div class="line">$(&apos;h1[demo-attribute=&quot;demo-value&quot;]&apos;)</div><div class="line"></div><div class="line">// If you wish to find all elements where the value **starts** with a string, use the ^= operator.</div><div class="line">$(&apos;[class^=&quot;col&quot;]&apos;)</div><div class="line"></div><div class="line">// If you wish to find all elements where the value **contains** a string, use the *= operator.</div><div class="line">$(&apos;[class*=&quot;md&quot;]&apos;)</div></pre></td></tr></table></figure>
</li>
<li><p>Positional selectors</p>
<ul>
<li><p><strong>Parent/child relationships</strong></p>
<p>Consider the following script:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">// Selects all a elements that are direct descendants nav element</div><div class="line">$(&apos;nav &gt; a&apos;)</div></pre></td></tr></table></figure>
<p>In the following HTML, the first link would be selected, but not the second. This is because the first link is a <strong>direct child</strong>, but the second is inside of a <code>div</code>element.</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">&lt;nav&gt;</div><div class="line">	&lt;a href=&quot;#&quot;&gt;(First) This will be selected&lt;/a&gt;</div><div class="line">	&lt;div&gt;</div><div class="line">		&lt;a href=&quot;#&quot;&gt;(Second) This will not be selected&lt;/a&gt;</div><div class="line">	&lt;/div&gt;</div><div class="line">&lt;/nav&gt;</div></pre></td></tr></table></figure>
</li>
<li><p><strong>Descendants</strong></p>
<p>Examples:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line">// Selects all a elements that are descendants nav element</div><div class="line">// The elements can appear anywhere inside of the element listed first</div><div class="line">$(&apos;nav a&apos;)</div><div class="line"></div><div class="line">//this is an example to show the difference,if you use $(&apos;nav a&apos;), the first and the second will be selected both, if you use $(&apos;nav &gt; a&apos;), only the first one will be selected.</div><div class="line">&lt;nav&gt;</div><div class="line">	&lt;a href=&quot;#&quot;&gt;(First) This will be selected&lt;/a&gt;</div><div class="line">	&lt;div&gt;</div><div class="line">		&lt;a href=&quot;#&quot;&gt;(Second) This will be selected&lt;/a&gt;</div><div class="line">	&lt;/div&gt;</div><div class="line">&lt;/nav&gt;</div></pre></td></tr></table></figure>
</li>
</ul>
</li>
</ul>
</li>
<li><p><strong>Navigating the DOM with jQuery</strong></p>
<ul>
<li><p>Parent /child relationships</p>
<p>Four methods: <code>children</code> ,<code>find</code>, <code>parent</code>, <code>parents</code></p>
<ul>
<li>with<code>children</code>, it’s gonna be just the direct children.</li>
<li><code>find</code> will walk the entire hierarchy down, but it needs a selector.</li>
<li><code>parent</code> will be the immediate parent.</li>
<li>And <code>parents</code>, plural, will walk up the entire chain.</li>
</ul>
</li>
<li><p>Siblings</p>
<ul>
<li><p><code>prev</code> and <code>next</code></p>
<blockquote>
<p><code>prev()</code>: To move to the prior element</p>
<p><code>next()</code>: To move to the next element</p>
</blockquote>
</li>
<li><p><code>prevAll</code> and <code>nextAll</code></p>
<blockquote>
<p><code>prevAll</code> and <code>nextAll</code> will select all siblings prior or after the element. Both methods also accept a CSS selector to limit the items.</p>
</blockquote>
</li>
<li><p><code>prevUntil</code> and <code>nextUntil</code></p>
<blockquote>
<p><code>prevUntil</code> and <code>nextUntil</code> select all prior or following elements up to, but <strong>not including</strong> the element that matches the selector.</p>
</blockquote>
</li>
</ul>
</li>
<li><p>Selecting items by position</p>
<ul>
<li><p>Finding the index of an item</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">//index method will return the zero based (ordinal) location of the item, or -1 if the item isn&apos;t found.</div><div class="line"></div><div class="line">var currentElement = $(&apos;some selector&apos;);</div><div class="line">var parent = $(&apos;some selector&apos;);</div><div class="line">var index = parent.children().index(currentElement);</div></pre></td></tr></table></figure>
</li>
<li><p>Finding an item by its position</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">//using the get method</div><div class="line">var parent = $(&apos;some selector&apos;);</div><div class="line">var element = parent.children().get(index);</div></pre></td></tr></table></figure>
<p>One important note about <code>get</code> is it returns a JavaScript DOM object, <strong>not</strong> a jQuery object.</p>
<p>In order to call jQuery methods on the object, you must convert it to a jQuery object.</p>
<p>Examples below:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">var parent = $(&apos;some selector&apos;);</div><div class="line">var domobject = parent.children().get(index); // DOM object</div><div class="line">var jQueryObject = $(parent.children().get(index)); // jQuery object</div></pre></td></tr></table></figure>
</li>
</ul>
</li>
</ul>
</li>
<li><p><strong>Getting started with DOM manipulation</strong></p>
<ul>
<li><p>Adding and removing classes</p>
<ul>
<li><p>Adding a class to an element is just as easy as calling <code>addClass</code></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">currentElement.addClass(&apos;class-name&apos;);</div></pre></td></tr></table></figure>
</li>
<li><p>Removing a class from an element is just as easy as calling <code>removeClass</code>. If the element in question was not already decorated with the class you’re trying to remove, the method will simply return.</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">currentElement.removeClass(&apos;class-name&apos;);</div></pre></td></tr></table></figure>
</li>
</ul>
</li>
<li><p>Working with attributes</p>
<ul>
<li><p>reading an attribute value</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">alert($(&apos;selector&apos;).attr(&apos;attribute-name&apos;));</div></pre></td></tr></table></figure>
</li>
<li><p>modifying an attribute value</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">$(&apos;selector&apos;).attr(&apos;attribute-name&apos;, &apos;new value&apos;);</div></pre></td></tr></table></figure>
</li>
<li><p>removing an attribute value</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">$(&apos;selector&apos;).removeAttr(&apos;attribute-name&apos;);</div></pre></td></tr></table></figure>
</li>
</ul>
</li>
<li><p>Modifying content</p>
<ul>
<li><p><code>text()</code>: get to replace the existing text in an element</p>
</li>
<li><p><code>html()</code>: get to replace the existing HTML in an element</p>
</li>
<li><p>the different between <code>text()</code>  and <code>html()</code> is whether or not it’s gonna allow for HTML.</p>
<p>Examples:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">// update the text</div><div class="line">$(item).text(&apos;&lt;h1&gt;Hello, world!!&lt;/h1&gt;&apos;); //output: &lt;h1&gt;Hello, world!!&lt;/h1&gt;</div><div class="line"></div><div class="line">// update the html</div><div class="line">$(item).text(&apos;&lt;h1&gt;Hello, world!!&lt;/h1&gt;&apos;);//output: Hello, world!!</div></pre></td></tr></table></figure>
<p>you can say that HTML will allow you to modify HTML, Text is going to be for text only.</p>
</li>
</ul>
</li>
<li><p>Basic event handlers</p>
<p>like click event, more details in <a href="https://lupeipei.github.io/2017/10/06/introduction-to-jquery-module2-1/">Module 2</a></p>
<p>Inside of the event handler code, you can access the object that raised the event by using <code>this</code>.</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div></pre></td><td class="code"><pre><div class="line">//examples</div><div class="line">//click event</div><div class="line">//raised when the item is clicked</div><div class="line">$(item).click(function() &#123;</div><div class="line">    alert(&apos;clicked!!&apos;);</div><div class="line">&#125;);</div><div class="line"></div><div class="line">// hover event</div><div class="line">// raised when the user moves their mouse over the item</div><div class="line">$(item).hover(function() &#123;</div><div class="line">    alert(&apos;hover!!&apos;);</div><div class="line">&#125;);</div><div class="line"></div><div class="line">// mouseout</div><div class="line">// raised when the user moves their mouse away from an item</div><div class="line">$(item).mouseout(function() &#123;</div><div class="line">    alert(&apos;mouse out&apos;);</div><div class="line">&#125;);</div></pre></td></tr></table></figure>
</li>
</ul>
</li>
</ul>
<p>This is Module1 all about. More <a href="https://courses.edx.org/courses/course-v1:Microsoft+DEV208x+4T2017/course/" target="_blank" rel="external">details</a>.</p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="http://lupeipei.github.io/2017/10/04/web-together-build-8/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Lucia">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/source/images/avtar.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Lucia">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2017/10/04/web-together-build-8/" itemprop="url">
                  Together网站搭建之踩坑系列8
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-10-04T06:55:40+08:00">
                2017-10-04
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/ROR/" itemprop="url" rel="index">
                    <span itemprop="name">ROR</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
              <span class="post-comments-count">
                <span class="post-meta-divider">|</span>
                <span class="post-meta-item-icon">
                  <i class="fa fa-comment-o"></i>
                </span>
                <a href="/2017/10/04/web-together-build-8/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count disqus-comment-count"
                        data-disqus-identifier="2017/10/04/web-together-build-8/" itemprop="commentCount"></span>
                </a>
              </span>
            
          

          
          

          

          

          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>这是功能实现的第七篇，扯一扯<strong>如何在个人中心实作密码修改</strong></p>
<p>完整作品源码及效果，看这里<a href="https://togetherisbetter.herokuapp.com/" target="_blank" rel="external">作品网站</a>,   <a href="https://github.com/Lupeipei/Together" target="_blank" rel="external">作品源码</a>。</p>
<h4 id="实作密码修改"><a href="#实作密码修改" class="headerlink" title="实作密码修改"></a>实作密码修改</h4><p>这里修改用户名和头像简单带过，我们专注于<strong>密码修改</strong>。</p>
<p>来动动我们熟悉的devise。</p>
<p>先看效果，在个人中心添加密码修改板块：</p>
<p><img src="https://ws4.sinaimg.cn/large/006tKfTcly1fk1dhibubej30wx0j4dip.jpg" alt=""></p>
<p>具体步骤：</p>
<ul>
<li><p>终端运行：<code>rails g controller account::users</code></p>
</li>
<li><p>在<code>app/controllers/account/users_controller.eb</code>中，仅有头像和用户名的update：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div></pre></td><td class="code"><pre><div class="line">class Account::UsersController &lt; ApplicationController</div><div class="line">  before_action :authenticate_user!</div><div class="line"></div><div class="line">  def index</div><div class="line">    @user = current_user</div><div class="line">  end</div><div class="line"></div><div class="line">  def show</div><div class="line">    @user = current_user</div><div class="line">  end</div><div class="line"></div><div class="line">  def edit</div><div class="line">    @user = current_user</div><div class="line">  end</div><div class="line"></div><div class="line">  def update</div><div class="line">    @user = current_user</div><div class="line">    if @user.update(user_params)</div><div class="line">      redirect_to account_user_path, notice: &quot;信息更新成功&quot;</div><div class="line">    else</div><div class="line">      render :edit</div><div class="line">    end</div><div class="line">  end</div><div class="line"></div><div class="line">  private</div><div class="line"></div><div class="line">  def user_params</div><div class="line">    params.require(:user).permit(:username, :avatar)</div><div class="line">  end</div><div class="line">end</div></pre></td></tr></table></figure>
</li>
<li><p>在<code>app/views/account/users/show.html.erb</code>中，添加密码修改部分：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div></pre></td><td class="code"><pre><div class="line">........</div><div class="line">&lt;%= simple_form_for [:account, @user] do |f| %&gt;</div><div class="line"> ......</div><div class="line">  &lt;div class=&quot;my_password&quot;&gt;</div><div class="line">    &lt;h4&gt;修改密码： &lt;/h4&gt;</div><div class="line">    &lt;%= f.input :current_password, label: &quot;旧密码：&quot;, hint: false, error_html: &#123; id: &apos;password_error&apos;&#125; %&gt;</div><div class="line">    &lt;%= f.input :password, label: &quot;新密码：&quot;, hint: false, error_html: &#123; id: &apos;password_error&apos;&#125; %&gt;</div><div class="line">    &lt;%= f.input :password_confirmation, label: &quot;密码确认：&quot;%&gt;</div><div class="line">  &lt;/div&gt;</div><div class="line">  &lt;br&gt;</div><div class="line">  .......</div><div class="line">  &lt;div class=&quot;form-group&quot;&gt;</div><div class="line">    &lt;%= f.submit &quot;更新&quot;, class: &quot;btn btn-success&quot;%&gt;</div><div class="line">  &lt;/div&gt;</div><div class="line">&lt;% end %&gt;</div><div class="line">.......</div></pre></td></tr></table></figure>
</li>
<li><p>在<code>app/controllers/account/users_controller.eb</code>中，做如下修改：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div></pre></td><td class="code"><pre><div class="line">......</div><div class="line">def update</div><div class="line">  @user = current_user</div><div class="line">- if @user.update(user_params)</div><div class="line">+ if @user.update_with_password(user_params)</div><div class="line">+   bypass_sign_in(@user)</div><div class="line">    redirect_to account_user_path, notice: &quot;信息更新成功&quot;</div><div class="line">  else</div><div class="line">    render :edit</div><div class="line">  end</div><div class="line">end</div><div class="line"></div><div class="line">private</div><div class="line"></div><div class="line">def user_params</div><div class="line">-	params.require(:user).permit(:username, :avatar)</div><div class="line">+ params.require(:user).permit(:username, :avatar,:current_password, :password, :password_confirmation)</div><div class="line">end</div></pre></td></tr></table></figure>
</li>
</ul>
<p>这样就OK啦，可以在个人中心页面修改密码，保存后退出，重新登陆，会发现密码已经修改了。</p>
<p><strong>参考：</strong></p>
<p><a href="https://github.com/plataformatec/devise/wiki/How-To:-Allow-users-to-edit-their-password" target="_blank" rel="external">how to allow user to edit their password</a></p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="http://lupeipei.github.io/2017/10/03/web-together-build-7/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Lucia">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/source/images/avtar.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Lucia">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2017/10/03/web-together-build-7/" itemprop="url">
                  Together网站搭建之踩坑系列7
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-10-03T07:08:45+08:00">
                2017-10-03
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/ROR/" itemprop="url" rel="index">
                    <span itemprop="name">ROR</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
              <span class="post-comments-count">
                <span class="post-meta-divider">|</span>
                <span class="post-meta-item-icon">
                  <i class="fa fa-comment-o"></i>
                </span>
                <a href="/2017/10/03/web-together-build-7/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count disqus-comment-count"
                        data-disqus-identifier="2017/10/03/web-together-build-7/" itemprop="commentCount"></span>
                </a>
              </span>
            
          

          
          

          

          

          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>这是功能实现的第六篇，扯一扯<strong>如何实作活动申请</strong></p>
<p>完整作品源码及效果，看这里<a href="https://togetherisbetter.herokuapp.com/" target="_blank" rel="external">作品网站</a>,   <a href="https://github.com/Lupeipei/Together" target="_blank" rel="external">作品源码</a>。</p>
<h4 id="如何实现活动申请？"><a href="#如何实现活动申请？" class="headerlink" title="如何实现活动申请？"></a>如何实现活动申请？</h4><p>具体说，是实作以下两个功能：</p>
<ul>
<li>用户可申请参与活动<ul>
<li>如果活动已过期，则无法申请，显示已结束；</li>
<li>如果人数已满，则显示活动已经满员，报名截止；</li>
<li>既未过期，也没有满员，则用户可申请参与活动；</li>
</ul>
</li>
</ul>
<ul>
<li>用户可以查看自己的申请列表</li>
</ul>
<p>一步步来：</p>
<p>BTW，请无视CSS部分，只讲如何实作功能。</p>
<p><strong>Step1、 用户可以申请参与活动</strong></p>
<p>效果图：</p>
<p><img src="https://ws1.sinaimg.cn/large/006tKfTcgy1fk0k6757yzg30yb0jyhdu.gif" alt=""></p>
<ul>
<li><p>新建model apply_event，终端：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">rails g model apply_event user_id:integer event_id:integer</div></pre></td></tr></table></figure>
</li>
<li><p>建立apply_event, user, event三者之间的关系:</p>
<ul>
<li><p>在<code>app/models/apply_event.rb</code>中添加：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">class ApplyEvent &lt; ApplicationRecord</div><div class="line"> + belongs_to :user</div><div class="line"> + belongs_to :event</div><div class="line">end</div></pre></td></tr></table></figure>
</li>
<li><p>在<code>app/models/event.rb</code>中添加：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">......</div><div class="line">has_many :apply_events</div><div class="line">has_many :appliers, :through =&gt; :apply_events, :source =&gt; :user</div><div class="line">......</div></pre></td></tr></table></figure>
</li>
<li><p>在<code>app/models/user.rb</code>中添加：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">......</div><div class="line">has_many :apply_events</div><div class="line">has_many :applied_events, through: :apply_events, source: :event</div><div class="line">......</div></pre></td></tr></table></figure>
</li>
</ul>
</li>
<li><p>用户可以申请参加活动或取消申请</p>
<ul>
<li><p>在<code>app/models/user.rb</code>中添加：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line">......</div><div class="line">def apply_already?(event)</div><div class="line">  applied_events.include?(event)</div><div class="line">end</div><div class="line"></div><div class="line">def apply!(event)</div><div class="line">  applied_events &lt;&lt; event</div><div class="line">end</div><div class="line"></div><div class="line">def cancel!(event)</div><div class="line">  applied_events.delete(event)</div><div class="line">end</div><div class="line">......</div></pre></td></tr></table></figure>
<p>​</p>
</li>
<li><p>在<code>app/controllers/events_controller.rb</code>中添加：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line">class EventsController &lt; ApplicationController</div><div class="line">  ......</div><div class="line">  def apply</div><div class="line">    @event = Event.find(params[:id])</div><div class="line">    type = params[:type]</div><div class="line">    if type == &quot;apply&quot;</div><div class="line">      current_user.apply!(@event)</div><div class="line">    else type == &quot;cancel&quot;</div><div class="line">      current_user.cancel!(@event)</div><div class="line">    end</div><div class="line">    redirect_to :back</div><div class="line">  end</div><div class="line">  ......</div><div class="line">end</div></pre></td></tr></table></figure>
<p>申请参加活动，需要用户在登录状态下，修改<code>app/controllers/events_controller.rb</code>的<code>before_action :authenticate_user!</code>部分，加上apply</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">- before_action :authenticate_user!, only: [:new, :create,.....]</div><div class="line">+ before_action :authenticate_user!, only: [:apply,:new, :create,.....]</div></pre></td></tr></table></figure>
</li>
<li><p>修改<code>config/routes.rb</code>， 添加如下代码：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"> ......</div><div class="line"> resources :events do</div><div class="line">......</div><div class="line"> + put :apply, on: :member</div><div class="line"> end</div><div class="line"> ......</div></pre></td></tr></table></figure>
</li>
<li><p>修改<code>app/views/events/show.html.erb</code>， 添加如下代码：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line">......</div><div class="line">&lt;% if @event.end_time &lt; Time.now %&gt;</div><div class="line">	&lt;label class=&quot;label label-default event-over&quot;&gt;活动已结束&lt;/label&gt;</div><div class="line">&lt;% elsif @event.appliers.count &gt;= @event.limited_num %&gt;</div><div class="line">	&lt;label class=&quot;label label-default event-over&quot;&gt;活动已满员&lt;/label&gt;</div><div class="line">&lt;% else %&gt;</div><div class="line">  &lt;% if current_user &amp;&amp; current_user.apply_already?(@event) %&gt;</div><div class="line">    &lt;%= link_to(&quot;取消申请&quot;, apply_event_path(@event, type: &quot;cancel&quot;), method: :put, class: &quot;btn btn-default event-apply&quot;)%&gt;</div><div class="line">  &lt;% else %&gt;</div><div class="line">    &lt;%= link_to(&quot;申请赴约&quot;, apply_event_path(@event, type: &quot;apply&quot;), method: :put, class: &quot;btn btn-success event-apply&quot;)%&gt;</div><div class="line">  &lt;% end %&gt;</div><div class="line">&lt;% end %&gt;</div><div class="line">......</div></pre></td></tr></table></figure>
<p>现在看看，可以实现申请及取消申请了。但是，你很快就会发现，点击按钮后页面会refresh一下，这个不好不好，我们请上ajax。</p>
</li>
</ul>
</li>
<li><p>使用ajax来优化</p>
<ul>
<li><p>新增<code>app/views/events/_apply.html.erb</code>, <code>app/views/events/apply.js.erb</code></p>
</li>
<li><p>修改<code>app/views/events/show.html.erb</code>, 给这块要动态变化的区域加上ID</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line">+ &lt;div class=&quot;col-md-2&quot; id=&quot;apply-&lt;%= @event.id %&gt;&quot;&gt;</div><div class="line">-              &lt;% if @event.end_time &lt; Time.now %&gt;</div><div class="line">-              	&lt;label class=&quot;label label-default event-over&quot;&gt;活动已结束&lt;/label&gt;</div><div class="line">-              &lt;% elsif @event.appliers.count &gt;= @event.limited_num %&gt;</div><div class="line">-              	&lt;label class=&quot;label label-default event-over&quot;&gt;活动已满员&lt;/label&gt;</div><div class="line">-              &lt;% else %&gt;</div><div class="line">-                &lt;% if current_user &amp;&amp; current_user.apply_already?(@event) %&gt;</div><div class="line">-                  &lt;%= link_to(&quot;取消申请&quot;, apply_event_path(@event, type: &quot;cancel&quot;), method: :put, class: &quot;btn btn-default event-apply&quot;)%&gt;</div><div class="line">-                &lt;% else %&gt;</div><div class="line">-                  &lt;%= link_to(&quot;申请赴约&quot;, apply_event_path(@event, type: &quot;apply&quot;), method: :put, class: &quot;btn btn-success event-apply&quot;)%&gt;</div><div class="line">-                &lt;% end %&gt;</div><div class="line">-              &lt;% end %&gt;</div><div class="line">+              &lt;%= render :partial =&gt; &quot;apply&quot;, :locals =&gt; &#123;:event =&gt; @event &#125;%&gt;</div><div class="line">+ &lt;/div&gt;</div></pre></td></tr></table></figure>
</li>
<li><p>编辑<code>app/views/events/_apply.html.erb</code>, 添加如下代码：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line">&lt;% if event.end_time &lt; Time.now %&gt;</div><div class="line">  &lt;label class=&quot;label label-default event-over&quot;&gt;活动已结束&lt;/label&gt;</div><div class="line">&lt;% elsif event.appliers.count &gt;= event.limited_num %&gt;</div><div class="line">  &lt;label class=&quot;label label-default event-over&quot;&gt;活动已满员&lt;/label&gt;</div><div class="line">&lt;% else %&gt;</div><div class="line">  &lt;% if current_user &amp;&amp; current_user.apply_already?(event) %&gt;</div><div class="line">    &lt;%= link_to apply_event_path(event, type: &quot;cancel&quot;), method: :put, :remote =&gt; true do %&gt;</div><div class="line">    &lt;span class=&quot;btn btn-default event-apply&quot;&gt;取消申请&lt;/span&gt;</div><div class="line">    &lt;% end %&gt;</div><div class="line">  &lt;% else %&gt;</div><div class="line">    &lt;%= link_to apply_event_path(event, type: &quot;apply&quot;), method: :put, :remote =&gt; true do %&gt;</div><div class="line">    &lt;span class=&quot;btn btn-success event-apply&quot;&gt;申请赴约&lt;/span&gt;</div><div class="line">    &lt;% end %&gt;</div><div class="line">  &lt;% end %&gt;</div><div class="line">&lt;% end %&gt;</div></pre></td></tr></table></figure>
</li>
<li><p>编辑<code>app/views/events/apply.js.erb</code>, 添加如下代码：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">str = &quot;&lt;%=j render :partial =&gt; &quot;apply&quot;, :locals =&gt; &#123;:event =&gt; @event &#125; %&gt;&quot;;</div><div class="line">$(&quot;#apply-&lt;%= @event.id %&gt;&quot;).html(str);</div></pre></td></tr></table></figure>
</li>
<li><p>编辑<code>app/controllers/events_controller.rb</code>， 拿掉apply的redirect_to</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"> ......</div><div class="line"> def apply</div><div class="line">......</div><div class="line">   # redirect_to :back</div><div class="line"> end</div><div class="line"> ......</div></pre></td></tr></table></figure>
</li>
</ul>
<p>现在试试，可以快速申请，快速取消啦，棒棒哒！！</p>
</li>
</ul>
<p><strong>Step2、 用户可以查看自己的申请列表</strong></p>
<p>效果图：</p>
<p><img src="https://ws4.sinaimg.cn/large/006tKfTcgy1fk1chgct37g310b0gs7wh.gif" alt=""></p>
<p>这部分就比较简单啦。</p>
<ul>
<li><p>新增controller，终端运行：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">rails g controller account::apply_events</div></pre></td></tr></table></figure>
</li>
<li><p>修改<code>config/routes.rb</code>， 添加如下代码：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"> ......</div><div class="line"> namespace :account do</div><div class="line">......</div><div class="line"> + resources :apply_events</div><div class="line"> end</div><div class="line"> ......</div></pre></td></tr></table></figure>
</li>
<li><p>编辑<code>app/controllers/account/apply_events_controller.rb</code>，添加</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">class Account::ApplyEventsController &lt; ApplicationController</div><div class="line">  before_action :authenticate_user!</div><div class="line"></div><div class="line">  def index</div><div class="line">    @events = current_user.applied_events</div><div class="line">  end</div><div class="line">end</div></pre></td></tr></table></figure>
</li>
<li><p>新增<code>app/views/account/apply_events/index.html.erb</code>, 添加如下代码：</p>
</li>
</ul>
  <figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div></pre></td><td class="code"><pre><div class="line">&lt;h1 class=&quot;text-center&quot;&gt;我的申请&lt;/h1&gt;</div><div class="line"></div><div class="line">&lt;div class=&quot;col-md-10 col-md-offset-1&quot; style=&quot;margin-top: 20px;&quot;&gt;</div><div class="line">  &lt;table class=&quot;table table-bordered&quot;&gt;</div><div class="line">    &lt;thead&gt;</div><div class="line">      &lt;tr&gt;</div><div class="line">        &lt;th&gt;活动名称&lt;/th&gt;</div><div class="line">        &lt;th&gt;开始时间&lt;/th&gt;</div><div class="line">        &lt;th&gt;结束时间&lt;/th&gt;</div><div class="line">        &lt;th&gt;地点&lt;/th&gt;</div><div class="line">        &lt;th&gt;主办方&lt;/th&gt;</div><div class="line">        &lt;th&gt;类别&lt;/th&gt;</div><div class="line">        &lt;th&gt;人数限额&lt;/th&gt;</div><div class="line">        &lt;th&gt;剩余名额&lt;/th&gt;</div><div class="line">        &lt;th&gt;状态&lt;/th&gt;</div><div class="line">      &lt;/tr&gt;</div><div class="line">    &lt;/thead&gt;</div><div class="line">    &lt;tbody&gt;</div><div class="line">      &lt;% @events.each do |event| %&gt;</div><div class="line">        &lt;tr&gt;</div><div class="line">          &lt;td&gt;</div><div class="line">            &lt;% link_to event_path(event)%&gt;</div><div class="line">             &lt;% if event.logo.present? %&gt;</div><div class="line">              &lt;%= link_to image_tag(event.logo.thumb.url, class:&quot;event_logo_sm&quot;)%&gt;</div><div class="line">            &lt;% else %&gt;</div><div class="line">              &lt;%= link_to image_tag(&quot;http://placehold.it/100x100&amp;text=No Pic&quot;, class: &quot;event_logo_sm&quot;)%&gt;</div><div class="line">            &lt;% end %&gt;</div><div class="line">            &lt;%= link_to(event.title, event_path(event)) %&gt;&lt;/td&gt;</div><div class="line">          &lt;td&gt;&lt;%= event.start_time %&gt;&lt;/td&gt;</div><div class="line">          &lt;td&gt;&lt;%= event.end_time %&gt;&lt;/td&gt;</div><div class="line">          &lt;td&gt;&lt;%= event.address %&gt;&lt;/td&gt;</div><div class="line">          &lt;td&gt;&lt;%= event.sponsor %&gt;&lt;/td&gt;</div><div class="line">          &lt;td&gt;&lt;%= event.category.name %&gt;&lt;/td&gt;</div><div class="line">          &lt;td&gt;&lt;%= event.limited_num %&gt;&lt;/td&gt;</div><div class="line">          &lt;td&gt;&lt;%= event.limited_num - event.appliers.count %&gt;&lt;/td&gt;</div><div class="line">          &lt;td&gt;&lt;%= t(event.status, :scope =&gt; &quot;event.status&quot;) %&gt;&lt;/td&gt;</div><div class="line">        &lt;/tr&gt;</div><div class="line">      &lt;% end %&gt;</div><div class="line">    &lt;/tbody&gt;</div><div class="line">  &lt;/table&gt;</div><div class="line">&lt;/div&gt;</div><div class="line"></div><div class="line"></div><div class="line">&lt;!-- 分页 --&gt;</div><div class="line">&lt;div class=&quot;text-center&quot;&gt;</div><div class="line">  &lt;%= will_paginate @events, renderer: BootstrapPagination::Rails, :previous_label =&gt; &apos;上一页&apos;, :next_label =&gt; &apos;下一页&apos; %&gt;</div><div class="line">&lt;/div&gt;</div></pre></td></tr></table></figure>
<ul>
<li><p>编辑<code>app/views/common/_navbar.html.erb</code>，加上<strong>我的申请</strong>入口：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">......</div><div class="line">+ &lt;li&gt;&lt;%= link_to(&quot; 我的申请&quot;,account_apply_events_path(current_user), class: &quot;btn btn-default&quot;)%&gt;&lt;/li&gt;</div><div class="line">......</div></pre></td></tr></table></figure>
</li>
</ul>
<p>试试看，可以啦！</p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="http://lupeipei.github.io/2017/10/02/web-together-build-6/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Lucia">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/source/images/avtar.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Lucia">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2017/10/02/web-together-build-6/" itemprop="url">
                  Together网站搭建之踩坑系列6
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-10-02T07:52:12+08:00">
                2017-10-02
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/ROR/" itemprop="url" rel="index">
                    <span itemprop="name">ROR</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
              <span class="post-comments-count">
                <span class="post-meta-divider">|</span>
                <span class="post-meta-item-icon">
                  <i class="fa fa-comment-o"></i>
                </span>
                <a href="/2017/10/02/web-together-build-6/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count disqus-comment-count"
                        data-disqus-identifier="2017/10/02/web-together-build-6/" itemprop="commentCount"></span>
                </a>
              </span>
            
          

          
          

          

          

          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>这是功能实现的第五篇，扯一扯<strong>如何添加评论区，并使用ajax优化</strong>。</p>
<p>完整作品源码及效果，看这里<a href="https://togetherisbetter.herokuapp.com/" target="_blank" rel="external">作品网站</a>,   <a href="https://github.com/Lupeipei/Together" target="_blank" rel="external">作品源码</a>。</p>
<h4 id="正文："><a href="#正文：" class="headerlink" title="正文："></a>正文：</h4><p>上效果图先：</p>
<p><img src="https://ws3.sinaimg.cn/large/006tNc79gy1fjzf3flg56g30zb0kmk6a.gif" alt=""></p>
<p>功能描述：用户可以新增，删除自己的评论。</p>
<p>步骤如下：</p>
<ul>
<li><p>新增review model，终端运行：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">rails g model review comment:string user_id:integer event_id:integer</div><div class="line">rake db:migrate</div></pre></td></tr></table></figure>
</li>
<li><p>建立review与event，user的关系：</p>
<ul>
<li><p>在<code>review.rb</code>中，添加：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">belongs_to :user</div><div class="line">belongs_to :event</div></pre></td></tr></table></figure>
</li>
<li><p>在<code>event.rb</code>中，添加：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">has_many :reviews</div></pre></td></tr></table></figure>
</li>
<li><p>在<code>user.rb</code>中，添加：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">has_many :reviews</div></pre></td></tr></table></figure>
</li>
</ul>
</li>
<li><p>编辑<code>config/routes.rb</code>,在resources :events中添加：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"> resources :events do</div><div class="line"> + resources :reviews</div><div class="line">.....</div><div class="line">   end</div></pre></td></tr></table></figure>
</li>
<li><p>新建review controller</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">rails g controller reviews</div></pre></td></tr></table></figure>
</li>
<li><p>编辑<code>app/controllers/reviews_controller.rb</code></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div></pre></td><td class="code"><pre><div class="line">class ReviewsController &lt; ApplicationController</div><div class="line">  before_action :authenticate_user!</div><div class="line"></div><div class="line">  def new</div><div class="line">    @event = Event.find(params[:event_id])</div><div class="line">    @review = Review.new</div><div class="line">  end</div><div class="line"></div><div class="line">  def create</div><div class="line">    @event = Event.find(params[:event_id])</div><div class="line">    @review = Review.new(review_params)</div><div class="line">    @review.event = @event</div><div class="line">    @review.user = current_user</div><div class="line">    @review.save</div><div class="line">    redirect_to :back, alert: &quot;评论已经创建&quot;</div><div class="line">  end</div><div class="line"></div><div class="line">  def destroy</div><div class="line">    @event = Event.find(params[:event_id])</div><div class="line">    @review = Review.find(params[:id])</div><div class="line">    @review.destroy</div><div class="line">    redirect_to :back, alert: &quot;评论已经删除&quot;</div><div class="line">  end</div><div class="line"></div><div class="line">  private</div><div class="line"></div><div class="line">  def review_params</div><div class="line">    params.require(:review).permit(:comment)</div><div class="line">  end</div><div class="line"></div><div class="line">end</div></pre></td></tr></table></figure>
</li>
<li><p>编辑<code>app/controllers/events_controller.rb</code>, 在show部分，添加：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">......</div><div class="line">def show</div><div class="line">  @event = Event.find(params[:id])</div><div class="line">+ @reviews = @event.reviews.all</div><div class="line">end</div><div class="line">......</div></pre></td></tr></table></figure>
</li>
<li><p>编辑event的<code>show.html.erb</code>，给评论区腾出位置，这里用了两次partial来引用review，后面会建相应的文档:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div></pre></td><td class="code"><pre><div class="line">......</div><div class="line">&lt;!-- 活动讨论区 --&gt;</div><div class="line">  &lt;div class=&quot;event_reviews&quot;&gt;</div><div class="line">    &lt;div class=&quot;row&quot;&gt;</div><div class="line">      &lt;div class=&quot;col-md-8 col-md-offset-2&quot;&gt;</div><div class="line">        &lt;%= render :partial =&gt; &quot;reviews/form&quot;, :locals =&gt; &#123;:event =&gt; @event &#125; %&gt;</div><div class="line">        &lt;hr&gt;</div><div class="line">        &lt;% if @reviews.blank? %&gt;</div><div class="line">          &lt;p&gt;该活动还没有人讨论，来侃几句吧？&lt;/p&gt;</div><div class="line">        &lt;% else %&gt;</div><div class="line">        &lt;div id=&quot;reviews_list&quot;&gt;</div><div class="line">          &lt;% @reviews.each do |review| %&gt;</div><div class="line">        &lt;%= render :partial =&gt; &quot;reviews/review&quot;, :locals =&gt; &#123; :review =&gt; review &#125;%&gt;</div><div class="line">          &lt;% end %&gt;</div><div class="line">        &lt;/div&gt;</div><div class="line">        &lt;% end %&gt;</div><div class="line">        &lt;hr&gt;</div><div class="line">      &lt;/div&gt;</div><div class="line">    &lt;/div&gt;</div><div class="line">  &lt;/div&gt;</div><div class="line"> ......</div></pre></td></tr></table></figure>
<p>​</p>
</li>
<li><p>在<code>app/views/reviews</code>下，新增<code>_review.html.erb</code>, <code>_form.html.erb</code> 。<code>_review.html.erb</code>用来显示评论区列表，<code>_form.html.erb</code>则用于新增评论。</p>
<ul>
<li><p>编辑<code>_review.html.erb</code></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div></pre></td><td class="code"><pre><div class="line">&lt;div id=&quot;reivew-&lt;%= review.id %&gt;&quot; class=&quot;reviews&quot; style=&quot;text-align: left;&quot;&gt;</div><div class="line">    &lt;!-- 显示用户头像 --&gt;</div><div class="line">  &lt;ul&gt;</div><div class="line">    &lt;div class=&quot;user_avatar&quot; style=&quot;float: left;&quot;&gt;</div><div class="line">      &lt;% if review.user.avatar.present? %&gt;</div><div class="line">        &lt;%= image_tag(review.user.avatar.thumb.url, class: &quot;review_avatar&quot;)%&gt;</div><div class="line">      &lt;% else %&gt;</div><div class="line">        &lt;%= image_tag(&quot;https://ws4.sinaimg.cn/large/006tNc79gy1fj8fv5d1tdj30zk0npdig.jpg&quot;, class: &quot;review_avatar&quot;)%&gt;</div><div class="line">      &lt;% end %&gt;</div><div class="line">    &lt;/div&gt;</div><div class="line">  &lt;/ul&gt;</div><div class="line">  &lt;!-- 显示其他信息 --&gt;</div><div class="line">    &lt;div class=&quot;row&quot;&gt;</div><div class="line">      &lt;div class=&quot;col-md-9 review-user-info&quot;&gt;</div><div class="line">        &lt;%= review.user.display_name %&gt;</div><div class="line">      &lt;/div&gt;</div><div class="line">      &lt;div class=&quot;col-md-3&quot;&gt;</div><div class="line">        &lt;%= review.created_at %&gt;</div><div class="line">      &lt;/div&gt;</div><div class="line">    &lt;/div&gt;</div><div class="line">    &lt;div class=&quot;review-comment&quot;&gt;</div><div class="line">      &lt;%= review.content %&gt;</div><div class="line">    &lt;/div&gt;</div><div class="line">    &lt;!-- 用户可以删除自己的评论 --&gt;</div><div class="line">    &lt;% if current_user == review.user %&gt;</div><div class="line">    &lt;div class=&quot;pull-right&quot;&gt;</div><div class="line">      &lt;%= link_to(&quot;delete&quot;, event_review_path(review.event,review), method: :delete, :remote =&gt; true)%&gt;</div><div class="line">    &lt;/div&gt;</div><div class="line">  &lt;% end %&gt;</div><div class="line">&lt;/div&gt;</div></pre></td></tr></table></figure>
</li>
<li><p>编辑<code>_form.html.erb</code></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line">&lt;div class=&quot;contain&quot;&gt;</div><div class="line">  &lt;div class=&quot;row&quot; style=&quot; margin-top: 50px;&quot;&gt;</div><div class="line">    &lt;div class=&quot;col-md-12&quot;&gt;</div><div class="line">      &lt;%= simple_form_for [@event, @event.reviews.build ], :remote =&gt; true do |f| %&gt;</div><div class="line">        &lt;div class=&quot;form-group&quot;&gt;</div><div class="line">          &lt;%= f.input :content, label: &quot;吐糟或者提问，请随意&quot;, input_html: &#123; class: &quot;form-control&quot;&#125;%&gt;</div><div class="line">        &lt;/div&gt;</div><div class="line">        &lt;div class=&quot;form-action&quot;&gt;</div><div class="line">          &lt;%= f.submit &quot;我来说两句&quot;, disable_with: &quot;Submiting....&quot;, class: &quot;btn btn-danger&quot;%&gt;</div><div class="line">        &lt;/div&gt;</div><div class="line">      &lt;% end %&gt;</div><div class="line">    &lt;/div&gt;</div><div class="line">  &lt;/div&gt;</div><div class="line">&lt;/div&gt;</div></pre></td></tr></table></figure>
</li>
</ul>
</li>
<li><p>编辑<code>app/controllers/events_controller.rb</code>， 拿掉create, destroy 的redirect_to：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div></pre></td><td class="code"><pre><div class="line">......</div><div class="line">def create</div><div class="line">    @event = Event.find(params[:event_id])</div><div class="line">    @review = Review.new(review_params)</div><div class="line">    @review.event = @event</div><div class="line">    @review.user = current_user</div><div class="line">    @review.save</div><div class="line">  - redirect_to :back, alert: &quot;评论已经创建&quot;</div><div class="line">  end</div><div class="line"></div><div class="line">  def destroy</div><div class="line">    @event = Event.find(params[:event_id])</div><div class="line">    @review = Review.find(params[:id])</div><div class="line">    @review.destroy</div><div class="line">  - redirect_to :back, alert: &quot;评论已经删除&quot;</div><div class="line">  end</div><div class="line">  ......</div></pre></td></tr></table></figure>
</li>
<li><p>新增<code>app/views/reviews/create.js.erb</code>, <code>app/views/reviews/destroy.js.erb</code>, 分别编辑：</p>
<ul>
<li><p><code>app/views/reviews/create.js.erb</code></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">&lt;% if @review.valid? %&gt;</div><div class="line">  $(&quot;#reviews_list&quot;).prepend(&quot;&lt;%=j render :partial =&gt; &quot;review&quot;, :locals =&gt; &#123;:review =&gt; @review &#125; %&gt;&quot;);</div><div class="line">  $(&quot;#review_content&quot;).val(&quot;&quot;);</div><div class="line">&lt;% else %&gt;</div><div class="line">  alert(&quot;评论失败&quot;);</div><div class="line">&lt;% end %&gt;</div></pre></td></tr></table></figure>
</li>
<li><p><code>app/views/reviews/destroy.js.erb</code></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">$(&quot;#reivew-&lt;%= @review.id %&gt;&quot;).remove();</div></pre></td></tr></table></figure>
</li>
</ul>
</li>
</ul>
<p>大功告成！试试吧！美化部分，可以根据需要写相应的CSS。</p>
<hr>
<p>这里说明一下：</p>
<ul>
<li>rails5.0以前的版本已经默认安装<code>gem &#39;jquery-rails&#39;</code>, 如果你版本过高，需要自行安装，不然ajax部分会无法正常实现</li>
</ul>
<ul>
<li>涉及ajax的部分，没有说得太细，可自行Google ajax相关内容了解。</li>
</ul>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="http://lupeipei.github.io/2017/10/01/web-together-build-5/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Lucia">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/source/images/avtar.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Lucia">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2017/10/01/web-together-build-5/" itemprop="url">
                  Together网站搭建之踩坑系列5
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-10-01T06:26:19+08:00">
                2017-10-01
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/ROR/" itemprop="url" rel="index">
                    <span itemprop="name">ROR</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
              <span class="post-comments-count">
                <span class="post-meta-divider">|</span>
                <span class="post-meta-item-icon">
                  <i class="fa fa-comment-o"></i>
                </span>
                <a href="/2017/10/01/web-together-build-5/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count disqus-comment-count"
                        data-disqus-identifier="2017/10/01/web-together-build-5/" itemprop="commentCount"></span>
                </a>
              </span>
            
          

          
          

          

          

          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>这是功能实现的第四篇，扯一扯<strong>如何添加时间筛选功能</strong>。</p>
<p>完整作品源码及效果，看这里<a href="https://togetherisbetter.herokuapp.com/" target="_blank" rel="external">作品网站</a>,   <a href="https://github.com/Lupeipei/Together" target="_blank" rel="external">作品源码</a>。</p>
<h4 id="正文："><a href="#正文：" class="headerlink" title="正文："></a>正文：</h4><p>老规矩，上效果图先：</p>
<p><img src="https://ws1.sinaimg.cn/large/006tNc79gy1fjzd6h5bqtg30zh0i2e85.gif" alt=""></p>
<p><strong>具体步骤：</strong></p>
<p>这里，我用了 bootstrap-datepicker-rails来作为日期筛选，没有用date_field_tag, 既为了美观，也为了避免出现浏览器支援的问题。</p>
<p>好，开始吧。</p>
<ul>
<li><p>安装，在gemfile中加入：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">gem &apos;bootstrap-datepicker-rails&apos;</div></pre></td></tr></table></figure>
<p>终端运行<code>bundle install</code></p>
</li>
<li><p>编辑<code>app/assets/stylesheets/application.scss</code>，加入：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">@import &quot;bootstrap-datepicker3&quot;;</div></pre></td></tr></table></figure>
</li>
<li><p>编辑<code>app/assets/javascripts/application.js</code>，加入：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">//= require bootstrap-datepicker/core</div><div class="line">//= require bootstrap-datepicker/locales/bootstrap-datepicker.zh-CN</div></pre></td></tr></table></figure>
<p>这里，引入了中文版</p>
</li>
<li><p>在<code>app/views/events/index.html.erb</code>中，加入日期输入框：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line">......</div><div class="line">&lt;div class=&quot;submenu&quot;&gt;</div><div class="line">    &lt;span&gt;&lt;i class=&quot;fa fa-calendar fa-lg&quot;&gt;&lt;/i&gt; 时间: &lt;/span&gt;</div><div class="line">    &lt;div class=&quot;form-group&quot; style=&quot;margin-left: 80px; margin-top: -20px;&quot;&gt;</div><div class="line">    &lt;%= form_tag events_path, :method =&gt; :get do %&gt;</div><div class="line">      &lt;%= text_field_tag :start_on, params[:start_on]%&gt; ~  &lt;%= text_field_tag :end_on, params[:end_on]%&gt;</div><div class="line">      &lt;%= submit_tag &quot;确认&quot;, :class =&gt; &quot;btn btn-default&quot;%&gt;</div><div class="line">    &lt;% end %&gt;</div><div class="line">    &lt;/div&gt;</div><div class="line">&lt;/div&gt;</div><div class="line">.....</div></pre></td></tr></table></figure>
</li>
<li><p>在<code>app/views/events/index.html.erb</code>中，将script放在最下面。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">&lt;script&gt;</div><div class="line">  $(&quot;#start_on&quot;).datepicker(&#123;format: &quot;yyyy-mm-dd&quot;&#125;);</div><div class="line">  $(&quot;#end_on&quot;).datepicker(&#123;format: &quot;yyyy-mm-dd&quot;&#125;);</div><div class="line">&lt;/script&gt;</div></pre></td></tr></table></figure>
<p>这里，<code>start_on</code>, <code>end_on</code> 可以通过查看chrome的inspect，得到id。</p>
<p>另，如果需要指定多语言，可以修改script成这样：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">&lt;script&gt;</div><div class="line">  $(&quot;#start_on&quot;).datepicker(&#123;format: &quot;yyyy-mm-dd&quot;, language: &quot;&lt;%= I18n.locale %&gt;&quot;&#125;);</div><div class="line">  $(&quot;#end_on&quot;).datepicker(&#123;format: &quot;yyyy-mm-dd&quot;, language: &quot;&lt;%= I18n.locale %&gt;&quot;&#125;);</div><div class="line">&lt;/script&gt;</div></pre></td></tr></table></figure>
</li>
<li><p>编辑<code>app/controllers/events_controller.rb</code>, 在index部分，加入如下代码：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line">def index</div><div class="line">  @events = Event.order(&quot;created_at DESC&quot;)</div><div class="line">  ......</div><div class="line">  if params[:start_on].present?</div><div class="line">    @events = @events.where(&quot;start_time &gt;= ?&quot;, Date.parse(params[:start_on]).beginning_of_day)</div><div class="line">  end</div><div class="line"></div><div class="line">  if params[:end_on].present?</div><div class="line">    @events = @events.where(&quot;end_time &lt;= ?&quot;, Date.parse(params[:end_on]).end_of_day)</div><div class="line">  end</div><div class="line">  ......</div><div class="line">end</div></pre></td></tr></table></figure>
</li>
</ul>
<p>重启<code>rails s</code>, 试一下，可以根据时间筛选啦！</p>
<p>对啦，如果要部署到heroku， 记得运行<code>bundle exec rake assets: precompile</code>后再deploy。</p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
  </section>

  
  <nav class="pagination">
    <span class="page-number current">1</span><a class="page-number" href="/page/2/">2</a><a class="page-number" href="/page/3/">3</a><a class="extend next" rel="next" href="/page/2/"><i class="fa fa-angle-right"></i></a>
  </nav>



          </div>
          


          

        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    <div class="sidebar-inner">

      

      

      <section class="site-overview sidebar-panel sidebar-panel-active">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <img class="site-author-image" itemprop="image"
               src="/source/images/avtar.jpg"
               alt="Lucia" />
          <p class="site-author-name" itemprop="name">Lucia</p>
           
              <p class="site-description motion-element" itemprop="description">Learning is doing</p>
          
        </div>
        <nav class="site-state motion-element">

          
            <div class="site-state-item site-state-posts">
              <a href="/archives">
                <span class="site-state-item-count">21</span>
                <span class="site-state-item-name">日志</span>
              </a>
            </div>
          

          
            
            
            <div class="site-state-item site-state-categories">
              <a href="/categories/index.html">
                <span class="site-state-item-count">6</span>
                <span class="site-state-item-name">分类</span>
              </a>
            </div>
          

          
            
            
            <div class="site-state-item site-state-tags">
              <a href="/tags/index.html">
                <span class="site-state-item-count">7</span>
                <span class="site-state-item-name">标签</span>
              </a>
            </div>
          

        </nav>

        

        <div class="links-of-author motion-element">
          
            
              <span class="links-of-author-item">
                <a href="Link" target="_blank" title="LinkLabel">
                  
                    <i class="fa fa-fw fa-globe"></i>
                  
                  LinkLabel
                </a>
              </span>
            
              <span class="links-of-author-item">
                <a href="https://github.com/Lupeipei" target="_blank" title="GitHub">
                  
                    <i class="fa fa-fw fa-github"></i>
                  
                  GitHub
                </a>
              </span>
            
              <span class="links-of-author-item">
                <a href="https://www.facebook.com/Luciapeipei" target="_blank" title="Facebook">
                  
                    <i class="fa fa-fw fa-facebook"></i>
                  
                  Facebook
                </a>
              </span>
            
          
        </div>

        
        

        
        

        


      </section>

      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright" >
  
  &copy; 
  <span itemprop="copyrightYear">2017</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Lucia</span>
</div>


<div class="powered-by">
  由 <a class="theme-link" href="https://hexo.io">Hexo</a> 强力驱动
</div>

<div class="theme-info">
  主题 -
  <a class="theme-link" href="https://github.com/iissnan/hexo-theme-next">
    NexT.Muse
  </a>
</div>


        

        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  






  
  <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>

  
  <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>

  
  <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>

  
  <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.0"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.0"></script>



  
  

  

  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.0"></script>



  


  

    
      <script id="dsq-count-scr" src="https://https-lupeipei-github-io.disqus.com/count.js" async></script>
    

    

  




	





  





  





  






  





  

  

  

  

</body>
</html>
