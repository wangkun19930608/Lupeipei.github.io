<!doctype html>



  


<html class="theme-next muse use-motion" lang="zh-Hans">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>



<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />















  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css" />




  
  
  
  

  
    
    
  

  

  

  

  

  
    
    
    <link href="//fonts.googleapis.com/css?family=Lato:300,300italic,400,400italic,700,700italic&subset=latin,latin-ext" rel="stylesheet" type="text/css">
  






<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=5.1.0" rel="stylesheet" type="text/css" />


  <meta name="keywords" content="Hexo, NexT" />








  <link rel="shortcut icon" type="image/x-icon" href="/favicon.ico?v=5.1.0" />






<meta name="description" content="曲肱而枕">
<meta property="og:type" content="website">
<meta property="og:title" content="Lucia">
<meta property="og:url" content="http://lupeipei.github.io/page/5/index.html">
<meta property="og:site_name" content="Lucia">
<meta property="og:description" content="曲肱而枕">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Lucia">
<meta name="twitter:description" content="曲肱而枕">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Muse',
    sidebar: {"position":"left","display":"post","b2t":false,"scrollpercent":false},
    fancybox: true,
    motion: true,
    duoshuo: {
      userId: '0',
      author: '博主'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="http://lupeipei.github.io/page/5/"/>





  <title> Lucia </title>
</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans">

  














  
  
    
  

  <div class="container sidebar-position-left 
   page-home 
 ">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/"  class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">Lucia</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle"></p>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br />
            
            首页
          </a>
        </li>
      
        
        <li class="menu-item menu-item-categories">
          <a href="/categories" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-th"></i> <br />
            
            分类
          </a>
        </li>
      
        
        <li class="menu-item menu-item-about">
          <a href="/about" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-user"></i> <br />
            
            关于
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br />
            
            归档
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-tags"></i> <br />
            
            标签
          </a>
        </li>
      

      
    </ul>
  

  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            
  <section id="posts" class="posts-expand">
    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="http://lupeipei.github.io/2017/10/15/deploy-with-qiniu/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Lucia">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Lucia">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2017/10/15/deploy-with-qiniu/" itemprop="url">
                  七牛云端部署，想说爱你不容易
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-10-15T20:03:17+08:00">
                2017-10-15
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/ROR/" itemprop="url" rel="index">
                    <span itemprop="name">ROR</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
              <span class="post-comments-count">
                <span class="post-meta-divider">|</span>
                <span class="post-meta-item-icon">
                  <i class="fa fa-comment-o"></i>
                </span>
                <a href="/2017/10/15/deploy-with-qiniu/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count disqus-comment-count"
                        data-disqus-identifier="2017/10/15/deploy-with-qiniu/" itemprop="commentCount"></span>
                </a>
              </span>
            
          

          
          

          

          

          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h4 id="写在前面"><a href="#写在前面" class="headerlink" title="写在前面"></a>写在前面</h4><p>  前段时间，租了阿里云，买了域名，最近折腾了下，终于把之前做的网站部署上去了。</p>
<p>  整个部署过程中，感觉最虐的就是七牛云那块了，对于半路出家的新手来说，真是个不小的坑。记录下这段虐心的旅程。</p>
<hr>
<h4 id="正文"><a href="#正文" class="headerlink" title="正文"></a>正文</h4><p>  我用的是Capistrano来部署Rails项目，这里只记录一下我在远端服务器运行seed时，会出现的问题。<br>  好，我们开始吧！<br>  当你在终端<code>~/yourproject_name/current</code>执行<code>RAILS_ENV=production bundle exec rake db:seed</code>, 可能会出现如下报错：</p>
<ul>
<li><p><strong>NoMethodError： undefined method qiniu_up_host</strong></p>
<p>这个报错出现的有些奇怪，我在本地运行<code>rake db:seed</code>时，也报错，而我之前部署到heroku时并没有出现过这种情况，不解。</p>
<p>虽然不理解它为什么会出现，但是有问题咱就得想着解决，看看怎么破了它。</p>
<p><img src="https://ws3.sinaimg.cn/large/006tNc79gy1fkj51hciw8j30qn069di8.jpg" alt=""></p>
<p><strong>解决办法：</strong></p>
<p>方法很粗暴。<br>在本地的<code>config/initializers/carrierwave.rb</code>文件中，将host那一行直接注释，然后运行<code>rake db:seed</code>， 发现OK啦。</p>
<p><img src="https://ws3.sinaimg.cn/large/006tNc79gy1fkj56rr9y4j30cl06ndgc.jpg" alt=""></p>
<p>为什么我会想到直接注释？Google了下，发现如果你的服务器在国内，qiniu_up_host是可以不用设置的。</p>
<p>另外，还有一种情况是config.qiniu_up_host的值写错了，不同的存储区域是不一样的，具体可以参见<a href="https://developer.qiniu.com/kodo/manual/1671/region-endpoint" target="_blank" rel="external">七牛开发者中心-存储区域</a>。</p>
</li>
<li><p><strong>TypeError: no implicit conversion of nil to String</strong></p>
<p><img src="https://ws1.sinaimg.cn/large/006tNc79gy1fkj032q8itj30l70bctbx.jpg" alt=""></p>
<p>出现这个情况，是因为我使用了<a href="https://github.com/laserlemon/figaro" target="_blank" rel="external">Figaro</a> 管理密码，之前部署到heroku时，终端运行<code>figaro heroku:set -e production</code>就可以了，但是这里，我们怎么把七牛对应的AccessKey，SecretKey等信息放入remote server呢？</p>
<p>其实，<a href="https://github.com/laserlemon/figaro" target="_blank" rel="external">Figaro</a> 的README文档中已经提到了，咱们这么来：</p>
<p>Step1、在远端的<code>~/yourproject_name/shared/config</code>中，添加<code>application.yml</code>, 内容如下：</p>
<figure class="highlight ruby"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div></pre></td><td class="code"><pre><div class="line"><span class="symbol">production:</span></div><div class="line">   <span class="symbol">qiniu_access_key:</span> xxxx  <span class="comment"># 你的 qiniu AccessKey</span></div><div class="line"></div><div class="line">   <span class="symbol">qiniu_secret_key:</span> xxxx  <span class="comment"># 你的 qiniu SecretKey</span></div><div class="line"></div><div class="line">   <span class="symbol">qiniu_bucket:</span> xxxx  <span class="comment"># 你的 qiniu bucket</span></div><div class="line"></div><div class="line">   <span class="symbol">qiniu_bucket_domain:</span> xxxx  <span class="comment"># 你的 qiniu bucket domain</span></div><div class="line"></div><div class="line"></div><div class="line"></div><div class="line"> <span class="symbol">development:</span></div><div class="line">   <span class="symbol">qiniu_access_key:</span> xxxx  <span class="comment"># 你的 qiniu AccessKey</span></div><div class="line"></div><div class="line">   <span class="symbol">qiniu_secret_key:</span> xxxx  <span class="comment"># 你的 qiniu SecretKey</span></div><div class="line"></div><div class="line">   <span class="symbol">qiniu_bucket:</span> xxxx  <span class="comment"># 你的 qiniu bucket</span></div><div class="line"></div><div class="line">   <span class="symbol">qiniu_bucket_domain:</span> xxxx  <span class="comment"># 你的 qiniu bucket domain</span></div></pre></td></tr></table></figure>
<p>这里，虽然我们添加了这个文件，但是由于你的<code>config/deploy.rb</code>中没有设置，所以部署的时候并不会去连接这个文件。</p>
<p>Step2、在本机上编辑<code>config/deploy.rb</code>，将<code>application.yml</code>添加进去：</p>
<figure class="highlight ruby"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">-  append <span class="symbol">:linked_files</span>, <span class="string">"config/database.yml"</span>, <span class="string">"config/secrets.yml"</span></div><div class="line">+  append <span class="symbol">:linked_files</span>, <span class="string">"config/database.yml"</span>, <span class="string">"config/secrets.yml"</span>, <span class="string">"config/application.yml"</span></div></pre></td></tr></table></figure>
<p>OK啦！记得commit 和 push，再运行 <code>cap production deploy</code>，最后在远端服务器运行seed。</p>
</li>
<li><p><strong>TypeError: class or module required for rescue clause</strong></p>
<p><img src="https://ws1.sinaimg.cn/large/006tNc79ly1fkj0j8b12pj30oa0bujuv.jpg" alt=""></p>
<p>看到报错，第一反应就是google，在<a href="https://github.com/huobazi/carrierwave-qiniu/issues/17" target="_blank" rel="external">carrierwave-qiniu configuration error #17</a> 中, 提到<code>qiniu-rs</code>这个gem已经没有人在维护了，要安装最新版的<code>carrierwave-qiniu</code>。好，那就重新安装，又不是第一次被版本坑了: P。</p>
<p>在gemfile中做如下修改：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">+ gem &apos;carrierwave-qiniu&apos;, &apos;~&gt; 1.1.5&apos;</div><div class="line"></div><div class="line">- gem &apos;qiniu-rs&apos;</div></pre></td></tr></table></figure>
<p>终端运行<code>bundle install</code>, 报错显示：</p>
<p><img src="https://ws2.sinaimg.cn/large/006tNc79ly1fkj1s2ugzfj30me0bq76f.jpg" alt=""></p>
<p>显示没有mime-types，按照提示，运行<code>bundle update</code>， OK！</p>
<hr>
</li>
</ul>
<h4 id="The-end"><a href="#The-end" class="headerlink" title="The end"></a>The end</h4><p><strong>Attention：</strong></p>
<p>  请在每次修改后，进行git commit 和 git push ，然后在本地运行 <code>cap production deploy</code>部署，Capistranno会从GitHub上拉下最新的进度，最后在远端服务器的<code>~/yourproject_name/current</code>目录下，运行<code>RAILS_ENV=production bundle exec rake db:seed</code>。</p>
<p>  哦，附上我的成品<a href="https://www.togetherisbetter.cn/" target="_blank" rel="external">Together is better</a> : P.</p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="http://lupeipei.github.io/2017/10/10/login-server-without-password/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Lucia">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Lucia">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2017/10/10/login-server-without-password/" itemprop="url">
                  SSH免密码登录远端服务器
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-10-10T08:24:21+08:00">
                2017-10-10
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Linux/" itemprop="url" rel="index">
                    <span itemprop="name">Linux</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
              <span class="post-comments-count">
                <span class="post-meta-divider">|</span>
                <span class="post-meta-item-icon">
                  <i class="fa fa-comment-o"></i>
                </span>
                <a href="/2017/10/10/login-server-without-password/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count disqus-comment-count"
                        data-disqus-identifier="2017/10/10/login-server-without-password/" itemprop="commentCount"></span>
                </a>
              </span>
            
          

          
          

          

          

          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h4 id="吐个糟先"><a href="#吐个糟先" class="headerlink" title="吐个糟先"></a>吐个糟先</h4><p>前段时间开始学习Linux云服务器部署运维，在免密码登录那块卡了很久，一直没找到原因，删除实例，重新生成SSH key，折腾了几次，每次都以为这次没问题了，结果登录的时候，擦，还是要求输入密码，你说糟心不？索性先搁浅了起来，前几天又来找虐，试了两次，竟然成功登录了，小激动啊！</p>
<p>记录下免密码登录的整个操作流程，庆祝下，也给没踩坑的参考下。</p>
<h4 id="正文"><a href="#正文" class="headerlink" title="正文"></a>正文</h4><p>远端登入如果每次都要输入密码，还是挺麻烦的，不过，别担心，聪明的前辈们早就想到解决办法啦！用非对称加密的方式来实现免密码登录。那，具体怎么玩？</p>
<p><strong>步骤：</strong></p>
<p>机器A： 本地的Mac</p>
<p>机器B： 远端Linux服务器</p>
<p>Step1、在<strong>本地机器A</strong>检查是否已经生成id_rsa.pub</p>
<ul>
<li><p>终端运行<code>cat ~/.ssh/id_rsa.pub</code></p>
<p><img src="https://ws4.sinaimg.cn/large/006tNc79gy1fk9qp21kn2j30lt021gmk.jpg" alt=""></p>
<ul>
<li><p>如果存在该文件，终端运行：<code>ssh-keygen -p</code>, 将passphrase重新设置为空，直接按Enter即可，这一步很重要，不然的话，即使你设置了免密码登录，还是要每次都输入passphrase才可以登录到远端服务器。</p>
<p><img src="https://ws3.sinaimg.cn/large/006tNc79gy1fk9qp2mmr8j30gz02t3yy.jpg" alt=""></p>
</li>
<li><p>如果不存在该文件，需要先生成，终端运行：<code>ssh-keygen -t rsa</code>,  就会生成公钥 <code>~/.ssh/id_rsa.pub</code> 以及密钥 <code>~/.ssh/id_rsa</code>啦。同样的，一直按Enter，不要设置passphrase。</p>
</li>
</ul>
</li>
</ul>
<p>Step2、在<strong>机器B</strong>添上本地的公钥</p>
<ul>
<li><p>登录远端服务器后，新建authorized_keys</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">mkdir ~/.ssh</div><div class="line">touch ~/.ssh/authorized_keys</div></pre></td></tr></table></figure>
</li>
<li><p>将公钥贴进远端服务器的authorized_keys中</p>
<p>在A上运行：<code>cat ~/.ssh/id_rsa.pub</code>， 复制本机的公钥</p>
<p>回到B上，运行：<code>nano ~/.ssh/authorized_keys</code>, 把公钥贴进去</p>
</li>
<li><p>设置机器B上的文件权限</p>
<p>运行：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">chmod 700 ~/.ssh</div><div class="line">chmod 644 ~/.ssh/authorized_keys</div></pre></td></tr></table></figure>
<p>有的参考文档要求设置成600，试了下，644，600，保证owner是可读写可执行，而其他用户和群组的最大权限是可读即可。</p>
</li>
</ul>
<p>可以了！很简单是不是？试试看，退出重新登录下，不用敲密码啦！</p>
<h4 id="The-end"><a href="#The-end" class="headerlink" title="The end"></a>The end</h4><p> BTW，我之前的问题是passphrase没有设置为空，另外SSH文件复制时也出错，后面重新生成才解决的。</p>
<p>看了一些有关SSH免登录的操作说明，有一篇挺干货的。推荐：</p>
<p><a href="https://my.oschina.net/magicalSam/blog/1466144" target="_blank" rel="external">Mac、Linux 上实现SSH免密码登陆到Linux服务器</a></p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="http://lupeipei.github.io/2017/10/09/introduction-to-jquery-module3-2/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Lucia">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Lucia">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2017/10/09/introduction-to-jquery-module3-2/" itemprop="url">
                  Introduction to jQuery_5
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-10-09T12:16:09+08:00">
                2017-10-09
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Web/" itemprop="url" rel="index">
                    <span itemprop="name">Web</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
              <span class="post-comments-count">
                <span class="post-meta-divider">|</span>
                <span class="post-meta-item-icon">
                  <i class="fa fa-comment-o"></i>
                </span>
                <a href="/2017/10/09/introduction-to-jquery-module3-2/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count disqus-comment-count"
                        data-disqus-identifier="2017/10/09/introduction-to-jquery-module3-2/" itemprop="commentCount"></span>
                </a>
              </span>
            
          

          
          

          

          

          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h4 id="Before-Start"><a href="#Before-Start" class="headerlink" title="Before Start"></a>Before Start</h4><p>The following contents are the notes I took when learning  jQuery on Edx.</p>
<p>Mainly for  front-End Web developers, check <a href="https://courses.edx.org/courses/course-v1:Microsoft+DEV208x+4T2017/course/" target="_blank" rel="external">here</a> to get more details.</p>
<h4 id="CONTENTS"><a href="#CONTENTS" class="headerlink" title="CONTENTS"></a>CONTENTS</h4><p>Three parts:</p>
<ul>
<li><a href="https://lupeipei.github.io/2017/10/05/introduction-to-jQuery-module1/">Adding jQuery to web pages</a></li>
<li><a href="https://lupeipei.github.io/2017/10/06/introduction-to-jquery-module2-1/">Managing content, events and effects</a></li>
<li>Asynchronous operations and Ajax calls</li>
</ul>
<h4 id="Module3-Asynchronous-programming-and-Ajax"><a href="#Module3-Asynchronous-programming-and-Ajax" class="headerlink" title="Module3 : Asynchronous programming and Ajax"></a>Module3 : Asynchronous programming and Ajax</h4><p>Module3 includes five parts:</p>
<ul>
<li>Using promises</li>
<li>Web workers</li>
<li>Using deferred</li>
<li>JavaScript Object Notation</li>
<li>Calling the server</li>
</ul>
<p>Let’s get to know something about JSON and Ajax.</p>
<ul>
<li><p>JavaScript Object Notation</p>
<ul>
<li><p>JSON syntax</p>
<p>A JSON object uses a notation that’s similar to that of a JavaScript object.</p>
<p>Example:</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line"><span class="comment">//create a JavaScript object</span></div><div class="line"><span class="keyword">var</span> person = &#123;</div><div class="line">    <span class="attr">firstName</span>: <span class="string">'Christopher'</span>,</div><div class="line">    <span class="attr">lastName</span>: <span class="string">'Harrison'</span></div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="comment">//create a JSON object</span></div><div class="line"><span class="keyword">var</span> person = &#123;</div><div class="line">    <span class="string">'firstName'</span>: <span class="string">'Christopher'</span>,</div><div class="line">    <span class="string">'lastName'</span>: <span class="string">'Harrison'</span></div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>Create a more complex object:</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> person = &#123;</div><div class="line">    <span class="string">'firstName'</span>: <span class="string">'Christopher'</span>,</div><div class="line">    <span class="string">'lastName'</span>: <span class="string">'Harrison'</span>,</div><div class="line">    <span class="string">'email'</span>: &#123;</div><div class="line">        <span class="string">'address'</span>: <span class="string">'charrison@adventure-works.com'</span>,</div><div class="line">        <span class="string">'type'</span>: <span class="string">'business'</span></div><div class="line">    &#125;    </div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>Create a object with array:</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> person = &#123;</div><div class="line">    <span class="string">'firstName'</span>: <span class="string">'Christopher'</span>,</div><div class="line">    <span class="string">'lastName'</span>: <span class="string">'Harrison'</span>,</div><div class="line">    <span class="string">'emailAddresses'</span>: [</div><div class="line">        &#123;</div><div class="line">            <span class="string">'address'</span>: <span class="string">'charrison@adventure-works.com'</span>,</div><div class="line">            <span class="string">'type'</span>: <span class="string">'business'</span></div><div class="line">        &#125;,</div><div class="line">        &#123;</div><div class="line">            <span class="string">'address'</span>: <span class="string">'charrison@fineartschool.net'</span>,</div><div class="line">            <span class="string">'type'</span>: <span class="string">'home'</span></div><div class="line">        &#125;</div><div class="line">    ]</div><div class="line">&#125;</div></pre></td></tr></table></figure>
</li>
<li><p>Serializing objects</p>
<p>JavaScript provides a native utility for <strong>converting objects to JSON</strong> (serializing), and <strong>converting JSON strings to objects</strong> (deserializing).</p>
<ul>
<li><p>Serializing an object:<code>JSON.stringify</code></p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// Create an instance of Object, a basic JavaScript object</span></div><div class="line"><span class="keyword">var</span> person = <span class="keyword">new</span> <span class="built_in">Object</span>();</div><div class="line"></div><div class="line"><span class="comment">// add properties</span></div><div class="line">person.firstName = <span class="string">'Christopher'</span>;</div><div class="line">person.lastName = <span class="string">'Harrison'</span>;</div><div class="line"></div><div class="line"><span class="comment">// serialize</span></div><div class="line"><span class="keyword">var</span> jsonString = <span class="built_in">JSON</span>.stringify(person);</div></pre></td></tr></table></figure>
</li>
<li><p>Deserializing JSON: <code>JSON.parse</code></p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// Deserialize a JSON string</span></div><div class="line"><span class="keyword">var</span> newPerson = <span class="built_in">JSON</span>.parse(jsonString);</div><div class="line"></div><div class="line"><span class="comment">// access properties as normal</span></div><div class="line">$(<span class="string">'#first-name-display'</span>).text(newPerson.firstName);</div><div class="line">$(<span class="string">'#last-name-display'</span>).text(newPerson.lastName);</div></pre></td></tr></table></figure>
</li>
</ul>
</li>
</ul>
</li>
<li><p>Calling the server</p>
<ul>
<li><p>Introducing Ajax</p>
<p>Typically, when we make a call to the server, we need to refresh the entire page.</p>
<p>as developers, we’d like to be able to incorporate server-side resources into our pages, allowing us to <strong>update individual portions of the page with new data, rather than updating the entire page</strong>.</p>
<ul>
<li><p>Asynchronous JavaScript and XML (Ajax)</p>
<p>Ajax is a set of technologies that act together to make it easier for developers to make calls to server resources from JavaScript.</p>
</li>
<li><p>Basic data retrieval</p>
<p><code>get</code> : The most basic Ajax operation we can perform using jQuery.</p>
<p> <code>get</code> contacts the <strong>URL</strong> we provide, and passes the string the server returns into the parameter we’ll use for our event handler.</p>
<p>Example:</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">$.get(</div><div class="line">    <span class="string">'some-url'</span>, <span class="comment">// The URL to call</span></div><div class="line">    <span class="function"><span class="keyword">function</span>(<span class="params">data</span>) </span>&#123; <span class="comment">// Success event handler</span></div><div class="line">        <span class="comment">// The data parameter contains the string</span></div><div class="line">        $(<span class="string">'#output'</span>).text(data);</div><div class="line">    &#125;</div><div class="line">);</div></pre></td></tr></table></figure>
</li>
<li><p>jQuery Ajax and promises</p>
<p>All jQuery Ajax calls return a jQuery <strong>promise</strong>.</p>
<p> So, you can use <code>done</code> for your success event handler, and <code>fail</code> to catch any errors. The two code samples perform the same operations.</p>
<p>Example:</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// Option one (pass the success function as a parameter)</span></div><div class="line">$.get(<span class="string">'some-url'</span>, <span class="function"><span class="keyword">function</span>(<span class="params">data</span>) </span>&#123; $(<span class="string">'#output'</span>).text(data); &#125;);</div><div class="line"></div><div class="line"><span class="comment">// Option two (use the done function of the promise)</span></div><div class="line">$.get(<span class="string">'some-url'</span>).done(<span class="function"><span class="keyword">function</span>(<span class="params">data</span>) </span>&#123; $(<span class="string">'#output'</span>).text(data); &#125;);</div></pre></td></tr></table></figure>
</li>
</ul>
</li>
<li><p>Retrieving JSON objects</p>
<ul>
<li><p><code>getJSON</code></p>
<p>To retrieve a JSON object, you can use <code>getJSON</code>.</p>
<p><code>getJSON</code> accepts several parameters, but the most common two that you’ll provide are the URL you need to call, and an event handler for success.</p>
<p>Because getJSON is expecting JSON data, it automatically deserializes the object, meaning you do not need to call JSON.parse.</p>
<p>Example:</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">$.getJSON(<span class="string">'/api/Demo'</span>, <span class="function"><span class="keyword">function</span> (<span class="params">person</span>) </span>&#123;</div><div class="line">	$(<span class="string">'#first-name'</span>).val(person.firstName);</div><div class="line">	$(<span class="string">'#last-name'</span>).val(person.lastName);</div><div class="line">&#125;);</div></pre></td></tr></table></figure>
</li>
</ul>
</li>
<li><p>Making server calls</p>
<p>If you’re new to making server calls through JavaScript or other technologies, you might have a few questions about <strong>how you’re supposed to know where the data is, what URLs you should use</strong>, etc.</p>
<ul>
<li><p>Finding the right URL</p>
<p>Most commonly you’ll be calling your own server and accessing your own organization’s data.</p>
<p>Then the answer becomes even easier:</p>
<p>talk to the developer who created the server side code that you need to call. They can provide all of the information you need.</p>
</li>
<li><p>Verbs</p>
<p>HTTP offers several “verbs”, with the two most common being GET and POST.</p>
<p>GET and POST in HTTP terms are about how to <strong>send data</strong> to the server, not a determination of the server sending you data.</p>
<p>GET limits us to <strong>sending data in the URL only</strong>.</p>
<p>POST on the other hand allows us to <strong>send data</strong> <strong>both in the URL, but also in what’s known as the header</strong>.The header is information that’s sent behind the scenes from the client to the server, and can be used to send almost any type of data, including binary data.</p>
</li>
<li><p>HTTP and REST APIs</p>
<p> HTTP provides several verbs, including GET, POST, PUT and DELETE.</p>
<p>GET will retrieve objects,</p>
<p>POST will create a new object,</p>
<p>PUT will update an existing object,</p>
<p>DELETE will delete an object.</p>
<p>Building upon those common operations, the W3C has established a specification called <a href="https://en.wikipedia.org/wiki/Representational_state_transfer" target="_blank" rel="external">REST</a>. REST provides for various standards to provide even more consistency when making server calls.</p>
</li>
</ul>
</li>
<li><p>Posting data</p>
<p>If the service you’re using follows standard REST practices, you’ll notice that you can create a new object by calling POST.</p>
<p>Or, if you’re trying to upload a binary object, such as an image, you’re forced to use POST, as GET won’t allow that type of data to be uploaded.</p>
<ul>
<li><p><code>post</code></p>
<p>Like getJSON, it also passes the JSON object returned by the server into the parameter for the event handler. And, just like all of the Ajax calls we’ve seen, <code>post</code> also returns a promise.</p>
<p>Example:</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// get the data we need to send</span></div><div class="line"><span class="keyword">var</span> person = &#123; <span class="attr">firstName</span>: <span class="string">'Christopher'</span>, <span class="attr">lastName</span>: <span class="string">'Harrison'</span> &#125;;</div><div class="line"></div><div class="line"><span class="comment">// Call POST</span></div><div class="line"></div><div class="line">$.post(<span class="string">'URL'</span>, <span class="comment">// Pass in the URL you need to access</span></div><div class="line">    person, <span class="comment">// Pass in the data to send via POST</span></div><div class="line">    <span class="function"><span class="keyword">function</span>(<span class="params">data</span>) </span>&#123;</div><div class="line">        <span class="comment">// success event handler</span></div><div class="line">        <span class="comment">// parameter contains value returned by server</span></div><div class="line">    &#125;</div><div class="line">);</div></pre></td></tr></table></figure>
</li>
</ul>
</li>
<li><p>Ajax events</p>
<ul>
<li><p>Start events</p>
<p>The two starting events are <code>ajaxStart</code> and <code>ajaxSend</code>.</p>
<p><code>ajaxStart</code> is raised when the <strong>first</strong> Ajax call is being made.</p>
<p><code>ajaxSend</code> is raised <strong>each time</strong> an Ajax call is made.</p>
</li>
<li><p>Completion events</p>
<p>jQuery Ajax offers two main events when each Ajax call is finished, <code>ajaxSuccess</code>, which is raised when a call succeeds,</p>
<p><code>ajaxError</code>, which is raised when a call fails.</p>
<p><code>ajaxComplete</code> is raised when <strong>each</strong> Ajax call completes, regardless of success or failure.</p>
<p> <code>ajaxStop</code> is raised when <strong>all</strong> calls are completed.</p>
<p>Example:</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">$(<span class="built_in">document</span>).ajaxSend(<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</div><div class="line">	<span class="comment">// raised when a call starts</span></div><div class="line">	$(<span class="string">'#status'</span>).append(<span class="string">'&lt;div&gt;Call started&lt;/div&gt;'</span>);</div><div class="line">&#125;).ajaxComplete(<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</div><div class="line">	<span class="comment">// raised when a call completes</span></div><div class="line">	$(<span class="string">'#status'</span>).append(<span class="string">'&lt;div&gt;Call completed&lt;/div&gt;'</span>);</div><div class="line">&#125;);</div></pre></td></tr></table></figure>
</li>
</ul>
</li>
<li><p>Dynamically loading data</p>
<ul>
<li><p>Loading HTML</p>
<p><code>load</code> will call the URL provided, obtain the HTML, and place it in the targeted item.</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">$(<span class="string">'#target'</span>).load(<span class="string">'some-url.html'</span>);</div></pre></td></tr></table></figure>
</li>
<li><p>Loading and executing JavaScript</p>
<p><code>getScript</code>  downloads <strong>and executes</strong> the script when it’s called.</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">$.getScript(<span class="string">'some-url.js'</span>);</div></pre></td></tr></table></figure>
</li>
</ul>
</li>
</ul>
</li>
</ul>
<p>This is  Module3 all about. More <a href="https://courses.edx.org/courses/course-v1:Microsoft+DEV208x+4T2017/course/" target="_blank" rel="external">details</a>.</p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="http://lupeipei.github.io/2017/10/08/introduction-to-jquery-module3-1/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Lucia">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Lucia">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2017/10/08/introduction-to-jquery-module3-1/" itemprop="url">
                  Introduction to jQuery_4
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-10-08T17:48:50+08:00">
                2017-10-08
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Web/" itemprop="url" rel="index">
                    <span itemprop="name">Web</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
              <span class="post-comments-count">
                <span class="post-meta-divider">|</span>
                <span class="post-meta-item-icon">
                  <i class="fa fa-comment-o"></i>
                </span>
                <a href="/2017/10/08/introduction-to-jquery-module3-1/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count disqus-comment-count"
                        data-disqus-identifier="2017/10/08/introduction-to-jquery-module3-1/" itemprop="commentCount"></span>
                </a>
              </span>
            
          

          
          

          

          

          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h4 id="Before-Start"><a href="#Before-Start" class="headerlink" title="Before Start"></a>Before Start</h4><p>The following contents are the notes I took when learning  jQuery on Edx.</p>
<p>Mainly for  front-End Web developers, check <a href="https://courses.edx.org/courses/course-v1:Microsoft+DEV208x+4T2017/course/" target="_blank" rel="external">here</a> to get more details.</p>
<h4 id="CONTENTS"><a href="#CONTENTS" class="headerlink" title="CONTENTS"></a>CONTENTS</h4><p>Three parts:</p>
<ul>
<li><a href="https://lupeipei.github.io/2017/10/05/introduction-to-jQuery-module1/">Adding jQuery to web pages</a></li>
<li><a href="https://lupeipei.github.io/2017/10/06/introduction-to-jquery-module2-1/">Managing content, events and effects</a></li>
<li>Asynchronous operations and Ajax calls</li>
</ul>
<h4 id="Module3-Asynchronous-programming-and-Ajax"><a href="#Module3-Asynchronous-programming-and-Ajax" class="headerlink" title="Module3 : Asynchronous programming and Ajax"></a>Module3 : Asynchronous programming and Ajax</h4><p>Module3 includes five parts:</p>
<ul>
<li>Using promises</li>
<li>Web workers</li>
<li>Using deferred</li>
<li>JavaScript Object Notation</li>
<li>Calling the server</li>
</ul>
<p>Uh, When I first learned it , I felt it was a little difficult for me to get the point, and now, I still have the feeling.</p>
<p>Let’s get to know something about the first three parts.</p>
<p><strong>A promise</strong> is an object returned by functions in jQuery that take a long or variable amount of time. By using a promise, you can ensure your code executes whenever the operation completes, be notified of its success or failure, or potentially receive updates about an operation’s progress.</p>
<p><strong>A deferred object</strong> allows you to create your own long running operations, allowing developers to use the same patterns provided by the promise object, and be updated when your operation completes.</p>
<p> <strong>web worker</strong>, an HTML5 feature allowing web developers to simulate threads in a web browser.</p>
<ul>
<li><p>promises</p>
<ul>
<li><p>Long running operations</p>
<p>Any jQuery function that runs over a long period of time, such as an animation, or communicates with a remote server, such as Ajax calls, returns a <strong>promise</strong>.</p>
</li>
<li><p>promises events</p>
<ul>
<li><p><code>done</code></p>
<p>raised when the operation completes successfully.</p>
<p>accepts one or more event handler functions.</p>
<p>Example:</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// code to obtain promise object</span></div><div class="line">promise.done(<span class="function"><span class="keyword">function</span>(<span class="params">data</span>) </span>&#123;</div><div class="line">	<span class="comment">// data will contain the data returned by the operation</span></div><div class="line">&#125;);</div></pre></td></tr></table></figure>
</li>
<li><p><code>fail</code></p>
<p>raised when the operation has completed with an error.</p>
<p>accepts one or more event handler functions.</p>
<p>Example:</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// code to obtain promise object</span></div><div class="line">promise.fail(<span class="function"><span class="keyword">function</span>(<span class="params">data</span>) </span>&#123;</div><div class="line">	<span class="comment">// data will contain the data returned by the operation</span></div><div class="line">&#125;);</div></pre></td></tr></table></figure>
</li>
<li><p><code>progress</code></p>
<p>raised when the operation raises an alert about its current state.</p>
<p>Not all operations raise <code>progress</code> events.</p>
<p>accepts one or more event handler functions.</p>
<p>Example:</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// code to obtain promise object</span></div><div class="line">promise.progress(<span class="function"><span class="keyword">function</span>(<span class="params">data</span>) </span>&#123;</div><div class="line">	<span class="comment">// data will contain the data returned by the operation</span></div><div class="line">&#125;);</div></pre></td></tr></table></figure>
</li>
<li><p>Chaining</p>
<p>add <code>done</code> and <code>fail</code> (and potentially <code>progress</code>) event handlers by chaining the method calls as demonstrated below :</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// code to obtain promise object</span></div><div class="line">promise.done(<span class="function"><span class="keyword">function</span>(<span class="params">data</span>) </span>&#123;</div><div class="line">	<span class="comment">// success</span></div><div class="line">&#125;).fail(<span class="function"><span class="keyword">function</span>(<span class="params">data</span>) </span>&#123;</div><div class="line">	<span class="comment">// failure</span></div><div class="line">&#125;);</div></pre></td></tr></table></figure>
</li>
<li><p><code>then</code></p>
<p>a single function allowing you to register <code>done</code>, <code>fail</code>, and <code>progress</code> event handlers in one call.</p>
<p>The sample below is identical to the chaining demonstration above.</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// code to obtain promise object</span></div><div class="line">promise.then(<span class="function"><span class="keyword">function</span>(<span class="params">data</span>) </span>&#123;</div><div class="line">    <span class="comment">// success</span></div><div class="line">&#125;, <span class="function"><span class="keyword">function</span>(<span class="params">data</span>) </span>&#123;</div><div class="line">    <span class="comment">// failure</span></div><div class="line">&#125;);</div></pre></td></tr></table></figure>
</li>
</ul>
</li>
</ul>
</li>
<li><p>Web workers</p>
<ul>
<li><p>Creating a web worker</p>
<p>made up of two components:</p>
<blockquote>
<p> the parent or calling script, and the worker or executing script.</p>
</blockquote>
<p><strong>does not</strong> have direct access to the calling environment or the UI.</p>
<p>use a messaging system to pass information to and from the worker.</p>
<ul>
<li><p>Creating the worker script</p>
<p>To create a web worker, you create a separate JavaScript file.</p>
<p>The code in the file <strong>will execute immediately</strong> when the worker object is created from the calling script.</p>
<p><code>self</code> : represents the worker. <code>self</code> , has one function named  <code>postMessage</code> and one event <code>message</code>.</p>
<p><code>postMessage</code>  is used to send data to the calling environment.</p>
<p><code>message</code> is raised when the calling script has sent a message to the worker.</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// send a signal back to the calling script</span></div><div class="line">self.postMessage(<span class="string">'hello from the worker!'</span>);</div><div class="line"></div><div class="line"><span class="comment">// Receive a message from the calling environment</span></div><div class="line">self.addEventListener(<span class="string">'message'</span>, <span class="function"><span class="keyword">function</span>(<span class="params">e</span>) </span>&#123;</div><div class="line">    <span class="comment">// the data property will contain the data passed from the calling script</span></div><div class="line">&#125;);</div></pre></td></tr></table></figure>
</li>
</ul>
</li>
<li><p>calling a web worker</p>
<ul>
<li><p>calling a web worker</p>
<p>to check to see if the brower supports web workers</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// Test if the browser supports web workers</span></div><div class="line"><span class="keyword">if</span>(Worker == <span class="literal">null</span>) &#123;</div><div class="line">	alert(<span class="string">'You need to upgrade your browser!'</span>);</div><div class="line">&#125; <span class="keyword">else</span> &#123;</div><div class="line">	<span class="comment">// do your work here</span></div><div class="line">&#125;</div></pre></td></tr></table></figure>
</li>
<li><p>creating an instance of the Worker object</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> worker = <span class="keyword">new</span> Worker(<span class="string">'script-location.js'</span>);</div><div class="line"></div><div class="line"><span class="comment">// Register event handler</span></div><div class="line">worker.addEventListener(<span class="string">'message'</span>, <span class="function"><span class="keyword">function</span>(<span class="params">e</span>) </span>&#123;</div><div class="line">    $(<span class="string">'#output'</span>).append(<span class="string">'&lt;li&gt;'</span> + e.data + <span class="string">'&lt;/li&gt;'</span>);</div><div class="line">&#125;);</div><div class="line"></div><div class="line">worker.postMessage(<span class="string">'Started!'</span>);</div></pre></td></tr></table></figure>
<p>​</p>
</li>
</ul>
</li>
<li><p>Designing your web workers</p>
<ul>
<li><p>creating a web worker that accepts status messages</p>
<p>Code:</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// worker.js</span></div><div class="line"></div><div class="line">self.addEventListener(<span class="string">'message'</span>, <span class="function"><span class="keyword">function</span>(<span class="params">e</span>) </span>&#123;</div><div class="line">	<span class="keyword">if</span>(e.data === <span class="string">'START'</span>) &#123;</div><div class="line">		<span class="comment">// Start message received.</span></div><div class="line">		<span class="comment">// Begin work</span></div><div class="line">		startWork();</div><div class="line">	&#125; <span class="keyword">else</span> <span class="keyword">if</span> (e.data === <span class="string">'STOP'</span>) &#123;</div><div class="line">		<span class="comment">// Stop message received.</span></div><div class="line">		<span class="comment">// Perform cleanup and terminate</span></div><div class="line">		stopWork();</div><div class="line">	&#125; <span class="keyword">else</span> &#123;</div><div class="line">		<span class="comment">// A different message has been received</span></div><div class="line">		<span class="comment">// This is data that needs to be acted upon</span></div><div class="line">		processData(e.data);</div><div class="line">	&#125;</div><div class="line">&#125;);</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">startWork</span>(<span class="params"></span>) </span>&#123;</div><div class="line">	<span class="comment">// code to start performing work here</span></div><div class="line">	<span class="comment">// send a message to the calling page</span></div><div class="line">	<span class="comment">// worker has started</span></div><div class="line">	self.postMessage(<span class="string">'STARTED'</span>);</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">stopWork</span>(<span class="params"></span>) </span>&#123;</div><div class="line">	<span class="comment">// cleanupp code here</span></div><div class="line">	<span class="comment">// stop the worker</span></div><div class="line">	self.postMessage(<span class="string">'STOPPED'</span>);</div><div class="line">	self.close();</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">processData</span>(<span class="params">data</span>) </span>&#123;</div><div class="line">	<span class="comment">// perform the work on the data</span></div><div class="line">	self.postMessage(<span class="string">'Processed '</span> + data);</div><div class="line">&#125;</div></pre></td></tr></table></figure>
</li>
<li><p>calling a web worker that accepts messages</p>
<p>If you were using the worker that’s been designed above, you would use it by following a couple of basic steps.</p>
<ol>
<li>Create an instance of <code>Worker</code>, passing in the script.</li>
<li>Add the event handler for the <code>message</code> event. Ensure the event handler can respond to the status messages and normal data.</li>
<li>When you’re ready to start the worker’s work, call <code>postMessage(&#39;START&#39;);</code></li>
<li>When you’re done, send the stop message by calling <code>postMessage(&#39;STOP&#39;);</code></li>
</ol>
<p>Code:</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// inside of HTML file</span></div><div class="line"></div><div class="line"><span class="keyword">var</span> worker = <span class="keyword">new</span> Worker(<span class="string">'worker.js'</span>);</div><div class="line"></div><div class="line">worker.addEventListener(<span class="string">'message'</span>, <span class="function"><span class="keyword">function</span>(<span class="params">e</span>) </span>&#123;</div><div class="line">    <span class="keyword">if</span>(e.data === <span class="string">'STARTED'</span>) &#123;</div><div class="line">        <span class="comment">// worker has been started</span></div><div class="line">        <span class="comment">// sample: update the screen to display worker started</span></div><div class="line">        $(<span class="string">'#output'</span>).append(<span class="string">'&lt;div&gt;Worker started&lt;/div&gt;'</span>);</div><div class="line">    &#125; <span class="keyword">else</span> <span class="keyword">if</span>(e.data === <span class="string">'STOPPED'</span>) &#123;</div><div class="line">        <span class="comment">// worker has been stopped</span></div><div class="line">        <span class="comment">// cleanup work (if needed)</span></div><div class="line">        <span class="comment">// sample: update the screen to display worker stopped</span></div><div class="line">        $(<span class="string">'#output'</span>).append(<span class="string">'&lt;div&gt;Worker stopped&lt;/div&gt;'</span>);</div><div class="line">    &#125; <span class="keyword">else</span> &#123;</div><div class="line">        <span class="comment">// Normal message. Act upon data as needed</span></div><div class="line">        <span class="comment">// Sample: display data on screen</span></div><div class="line">        $(<span class="string">'#output'</span>).append(<span class="string">'&lt;div&gt;'</span> + e.data + <span class="string">'&lt;/div&gt;'</span>);</div><div class="line">    &#125;</div><div class="line">&#125;);</div><div class="line"></div><div class="line"><span class="comment">// When you're ready, send the start message</span></div><div class="line">worker.postMessage(<span class="string">'START'</span>);</div><div class="line"></div><div class="line"><span class="comment">// Send data as needed</span></div><div class="line">worker.postMessage(<span class="string">'sample data'</span>);</div><div class="line"></div><div class="line"><span class="comment">// Stop worker when you're done</span></div><div class="line">worker.postMessage(<span class="string">'STOP'</span>);</div></pre></td></tr></table></figure>
</li>
</ul>
</li>
</ul>
</li>
<li><p>Using deferred</p>
<ul>
<li><p>Deferred</p>
<p><code>Deferred</code> and <code>promise</code> seem very similar.The difference between the two is who uses which.</p>
<p><code>Deferred</code> is used to create, and manage, a <code>promise</code> object.</p>
<p>A <code>promise</code> object is returned by a long running operation, and only allows you to register event handlers.</p>
<p><code>Deferred</code> is the <strong>server</strong> side.  When <strong>create</strong> a long running function that will be called by other developers, you’ll use <code>Deferred</code>to return a <code>promise</code>.</p>
<p><code>promise</code> is the <strong>client</strong> side. When you <strong>call</strong> a long running function, it will return a <code>promise</code>.</p>
</li>
<li><p>When to use Deferred</p>
<p>when you are creating a function that will <strong>take an unusual amount of time</strong>, say one that will be working with graphics, you will want to use <code>Deffered</code> to return a <code>promise</code> to the caller.</p>
</li>
<li><p>Breaking down using Deferred</p>
<p>The basic steps are as follows.</p>
<ol>
<li>Create an instance of deferred: var deferred = $.Deferred();</li>
<li>Start your asynchronous operation, typically using a worker</li>
<li>Add the appropriate code to detect success and send the success signal: deferred.resolve()</li>
<li>Add the appropriate code to detect failure and send the failure signal: deferred.reject()</li>
<li>Return the promise: return deferred.promise();</li>
</ol>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">beginProcessing</span>(<span class="params"></span>) </span>&#123;</div><div class="line">	<span class="comment">// Create deferred object &amp; make sure it's going to be in scope</span></div><div class="line">	<span class="keyword">var</span> deferred = <span class="keyword">new</span> $.Deferred();</div><div class="line"></div><div class="line">	<span class="comment">// Create our worker (just like before)</span></div><div class="line">	<span class="keyword">var</span> worker = <span class="keyword">new</span> Worker(<span class="string">'./Scripts/deferred.js'</span>);</div><div class="line"></div><div class="line">	<span class="comment">// Register the message event handler</span></div><div class="line">	worker.addEventListener(<span class="string">'message'</span>, <span class="function"><span class="keyword">function</span> (<span class="params">e</span>) </span>&#123;</div><div class="line">		<span class="comment">// simple messaging - if the worker is ready it'll send a message with READY as the text</span></div><div class="line">		<span class="keyword">if</span> (e.data === <span class="string">'READY'</span>) &#123;</div><div class="line">			<span class="comment">// No UI code</span></div><div class="line">			<span class="comment">// Progress notification</span></div><div class="line">			deferred.notify(<span class="string">'Worker started'</span>);</div><div class="line">		&#125; <span class="keyword">else</span> <span class="keyword">if</span>(e.data === <span class="string">'COMPLETED'</span>) &#123;</div><div class="line">			<span class="comment">// processing is done</span></div><div class="line">			<span class="comment">// No UI code</span></div><div class="line">			<span class="comment">// Completed notification</span></div><div class="line">			deferred.resolve(<span class="string">'Worker completed'</span>);</div><div class="line"></div><div class="line">			worker.terminate();</div><div class="line">		&#125;</div><div class="line">	&#125;);</div><div class="line"></div><div class="line">	<span class="keyword">return</span> deferred.promise();</div><div class="line">&#125;</div></pre></td></tr></table></figure>
</li>
</ul>
</li>
</ul>
<hr>
<p>  学这一章的时候，作为一个前端小白，我的内心响起一个声音：尼玛这都是什么鬼？</p>
<p>  说人话,附上我对这三个概念的理解：</p>
<p>  欢迎拍砖，皮厚不怕疼：P</p>
<p>  promise是一个需要运行很长时间的jQuery函数会返回的东东，告诉caller，函数的运行状态，caller可以根据状态来执行相应代码。</p>
<p>  Worker是用来在进程中插一脚的东东，通过message来传递状态，什么时候开始运行worker script，什么时候结束。</p>
<p>  Deferred呢？用来生成，管理promise。</p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="http://lupeipei.github.io/2017/10/07/introduction-to-jquery-module2-2/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Lucia">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Lucia">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2017/10/07/introduction-to-jquery-module2-2/" itemprop="url">
                  Introduction to jQuery_3
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-10-07T06:34:37+08:00">
                2017-10-07
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Web/" itemprop="url" rel="index">
                    <span itemprop="name">Web</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
              <span class="post-comments-count">
                <span class="post-meta-divider">|</span>
                <span class="post-meta-item-icon">
                  <i class="fa fa-comment-o"></i>
                </span>
                <a href="/2017/10/07/introduction-to-jquery-module2-2/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count disqus-comment-count"
                        data-disqus-identifier="2017/10/07/introduction-to-jquery-module2-2/" itemprop="commentCount"></span>
                </a>
              </span>
            
          

          
          

          

          

          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h4 id="Before-Start"><a href="#Before-Start" class="headerlink" title="Before Start"></a>Before Start</h4><p>The following contents are the notes I took when learning  jQuery on Edx.</p>
<p>Mainly for  front-End Web developers, check <a href="https://courses.edx.org/courses/course-v1:Microsoft+DEV208x+4T2017/course/" target="_blank" rel="external">here</a> to get more details.</p>
<h4 id="CONTENTS"><a href="#CONTENTS" class="headerlink" title="CONTENTS"></a>CONTENTS</h4><p>Three parts:</p>
<ul>
<li><a href="https://lupeipei.github.io/2017/10/05/introduction-to-jQuery-module1/">Adding jQuery to web pages</a></li>
<li>Managing content, events and effects</li>
<li><a href="https://lupeipei.github.io/2017/10/08/introduction-to-jquery-module3-1/">Asynchronous operations and Ajax calls</a></li>
</ul>
<h4 id="Module2-Managing-content-events-and-effects"><a href="#Module2-Managing-content-events-and-effects" class="headerlink" title="Module2 : Managing content, events and effects"></a>Module2 : Managing content, events and effects</h4><p>Module2 includes six parts:</p>
<ul>
<li>Event handlers</li>
<li>Modifying elements</li>
<li>Registering event handlers</li>
<li>Adding new elements</li>
<li>Animations</li>
<li>Removing, replacing and cloning</li>
</ul>
<p>Let’s get to know something about the last three parts of Module2.</p>
<ul>
<li><p><strong>Adding new elements</strong></p>
<ul>
<li><p>Internal DOM manipulation</p>
<p><code>append</code>, <code>appendTo</code>, <code>prepend</code> and <code>prependTo</code>.</p>
<p>Remember that the element you target will become the <strong>container</strong> for the new element. So using <code>append</code> will add a new element <strong>inside</strong> the target, not after the element.</p>
<ul>
<li><p><code>prepend</code> and <code>prependTo</code></p>
<p>Add new content to the <strong>begining</strong> of the contents of a target.</p>
<p>Example:</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div></pre></td><td class="code"><pre><div class="line"><span class="comment">&lt;!-- starting HTML --&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">"target"</span>&gt;</span></div><div class="line">	<span class="tag">&lt;<span class="name">div</span>&gt;</span>existing content<span class="tag">&lt;/<span class="name">div</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></div><div class="line"></div><div class="line">//executed either of the lines of JavaScript below</div><div class="line">// prepend is called on the target, and accepts the new content as the parameter</div><div class="line">$('#target').prepend('<span class="tag">&lt;<span class="name">div</span>&gt;</span>New content<span class="tag">&lt;/<span class="name">div</span>&gt;</span>');</div><div class="line"></div><div class="line">//or you can use prependTo</div><div class="line">// prependTo is called on the new content, and accepts the target as the parameter</div><div class="line">$('<span class="tag">&lt;<span class="name">div</span>&gt;</span>New content<span class="tag">&lt;/<span class="name">div</span>&gt;</span>').prependTo('#target');</div><div class="line"></div><div class="line"></div><div class="line"><span class="comment">&lt;!-- ending HTML --&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">"target"</span>&gt;</span></div><div class="line">	<span class="tag">&lt;<span class="name">div</span>&gt;</span>New content<span class="tag">&lt;/<span class="name">div</span>&gt;</span></div><div class="line">	<span class="tag">&lt;<span class="name">div</span>&gt;</span>existing content<span class="tag">&lt;/<span class="name">div</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></div></pre></td></tr></table></figure>
</li>
<li><p><code>append</code> and <code>appendTo</code></p>
<p>Add new content to the <strong>end</strong> of the contents of a target.</p>
<p>Example:</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div></pre></td><td class="code"><pre><div class="line"><span class="comment">&lt;!-- starting HTML --&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">"target"</span>&gt;</span></div><div class="line">	<span class="tag">&lt;<span class="name">div</span>&gt;</span>existing content<span class="tag">&lt;/<span class="name">div</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></div><div class="line"></div><div class="line">//executed either of the lines of JavaScript below</div><div class="line">// append is called on the target, and accepts the new content as the parameter</div><div class="line">$('#target').append('<span class="tag">&lt;<span class="name">div</span>&gt;</span>New content<span class="tag">&lt;/<span class="name">div</span>&gt;</span>');</div><div class="line"></div><div class="line">// appendTo is called on the new content, and accepts the target as the parameter</div><div class="line">$('<span class="tag">&lt;<span class="name">div</span>&gt;</span>New content<span class="tag">&lt;/<span class="name">div</span>&gt;</span>').appendTo('#target');</div><div class="line"></div><div class="line"><span class="comment">&lt;!-- ending HTML --&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">"target"</span>&gt;</span></div><div class="line">	<span class="tag">&lt;<span class="name">div</span>&gt;</span>existing content<span class="tag">&lt;/<span class="name">div</span>&gt;</span></div><div class="line">	<span class="tag">&lt;<span class="name">div</span>&gt;</span>New content<span class="tag">&lt;/<span class="name">div</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></div></pre></td></tr></table></figure>
</li>
</ul>
</li>
<li><p>External DOM manipulation</p>
<p><code>after</code>, <code>insertAfter</code>, <code>before</code>, and <code>insertBefore</code></p>
<ul>
<li><p><code>after</code> and <code>insertAfter</code></p>
<p>Add new content after the target.</p>
<p>Example:</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div></pre></td><td class="code"><pre><div class="line"><span class="comment">&lt;!-- starting HTML --&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">"target"</span>&gt;</span></div><div class="line">	<span class="tag">&lt;<span class="name">div</span>&gt;</span>existing content<span class="tag">&lt;/<span class="name">div</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></div><div class="line"></div><div class="line">//executed either of the lines of JavaScript below</div><div class="line">// after is called on the target, and accepts the new content as a parameter</div><div class="line">$('target').after(' New content');</div><div class="line"></div><div class="line">// insertAfter is called on the new content, and accepts the target as a parameter</div><div class="line">$(' New content').insertAfter('#target');</div><div class="line"></div><div class="line"><span class="comment">&lt;!-- ending HTML --&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">"target"</span>&gt;</span></div><div class="line">	<span class="tag">&lt;<span class="name">div</span>&gt;</span>existing content<span class="tag">&lt;/<span class="name">div</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">div</span>&gt;</span>New content<span class="tag">&lt;/<span class="name">div</span>&gt;</span></div></pre></td></tr></table></figure>
</li>
<li><p><code>before</code> and <code>insertBefore</code></p>
<p>Add new content before the target.</p>
<p>Example:</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div></pre></td><td class="code"><pre><div class="line"><span class="comment">&lt;!-- starting HTML --&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">"target"</span>&gt;</span></div><div class="line">	<span class="tag">&lt;<span class="name">div</span>&gt;</span>existing content<span class="tag">&lt;/<span class="name">div</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></div><div class="line"></div><div class="line">//executed either of the lines of JavaScript below</div><div class="line">// before is called on the target, and accepts the new content as a parameter</div><div class="line">$('target').before('New content');</div><div class="line"></div><div class="line">// insertBefore is called on the new content, and accepts the target as a parameter</div><div class="line">$('New content').insertBefore('#target');</div><div class="line"></div><div class="line"><span class="comment">&lt;!-- ending HTML --&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">div</span>&gt;</span>New content<span class="tag">&lt;/<span class="name">div</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">"target"</span>&gt;</span></div><div class="line">	<span class="tag">&lt;<span class="name">div</span>&gt;</span>existing content<span class="tag">&lt;/<span class="name">div</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></div></pre></td></tr></table></figure>
</li>
</ul>
</li>
<li><p>Wrapping content</p>
<p>To manipulate the DOM by surrounding existing content with a new element.</p>
<ul>
<li><p><code>wrap</code></p>
<p>wraps <strong>each item</strong> with the element passed into the function.</p>
<p>Example:</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div></pre></td><td class="code"><pre><div class="line"><span class="comment">&lt;!-- starting HTML --&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">"target"</span>&gt;</span></div><div class="line">	<span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"demo"</span>&gt;</span>Item one<span class="tag">&lt;/<span class="name">div</span>&gt;</span></div><div class="line">	<span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"demo"</span>&gt;</span>Item two<span class="tag">&lt;/<span class="name">div</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></div><div class="line"></div><div class="line">//JS</div><div class="line">$('.demo').wrap('<span class="tag">&lt;<span class="name">section</span>&gt;</span><span class="tag">&lt;/<span class="name">section</span>&gt;</span>');</div><div class="line"></div><div class="line"><span class="comment">&lt;!-- ending HTML --&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">"target"</span>&gt;</span></div><div class="line">	<span class="tag">&lt;<span class="name">section</span>&gt;</span></div><div class="line">		<span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"demo"</span>&gt;</span>Item one<span class="tag">&lt;/<span class="name">div</span>&gt;</span></div><div class="line">	<span class="tag">&lt;/<span class="name">section</span>&gt;</span></div><div class="line">	<span class="tag">&lt;<span class="name">section</span>&gt;</span></div><div class="line">		<span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"demo"</span>&gt;</span>Item two<span class="tag">&lt;/<span class="name">div</span>&gt;</span></div><div class="line">	<span class="tag">&lt;/<span class="name">section</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></div></pre></td></tr></table></figure>
</li>
<li><p><code>wrapAll</code></p>
<p> returned content with one new element.</p>
<p>Example:</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div></pre></td><td class="code"><pre><div class="line"><span class="comment">&lt;!-- starting HTML --&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">"target"</span>&gt;</span></div><div class="line">	<span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"demo"</span>&gt;</span>Item one<span class="tag">&lt;/<span class="name">div</span>&gt;</span></div><div class="line">	<span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"demo"</span>&gt;</span>Item two<span class="tag">&lt;/<span class="name">div</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></div><div class="line"></div><div class="line">//JS</div><div class="line">$('.demo').wrapAll('<span class="tag">&lt;<span class="name">section</span>&gt;</span><span class="tag">&lt;/<span class="name">section</span>&gt;</span>');</div><div class="line"></div><div class="line"><span class="comment">&lt;!-- ending HTML --&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">"target"</span>&gt;</span></div><div class="line">	<span class="tag">&lt;<span class="name">section</span>&gt;</span></div><div class="line">		<span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"demo"</span>&gt;</span>Item one<span class="tag">&lt;/<span class="name">div</span>&gt;</span></div><div class="line">		<span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"demo"</span>&gt;</span>Item two<span class="tag">&lt;/<span class="name">div</span>&gt;</span></div><div class="line">	<span class="tag">&lt;/<span class="name">section</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></div></pre></td></tr></table></figure>
</li>
<li><p><code>wrapInner</code></p>
<p>Operates on the children of the target, rather than on the target itself.</p>
<p>Example:</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div></pre></td><td class="code"><pre><div class="line"><span class="comment">&lt;!-- starting HTML --&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">"target"</span>&gt;</span></div><div class="line">	<span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"demo"</span>&gt;</span>Item one<span class="tag">&lt;/<span class="name">div</span>&gt;</span></div><div class="line">	<span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"demo"</span>&gt;</span>Item two<span class="tag">&lt;/<span class="name">div</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></div><div class="line"></div><div class="line">//JS</div><div class="line">$('#target').wrapInner('<span class="tag">&lt;<span class="name">section</span>&gt;</span><span class="tag">&lt;/<span class="name">section</span>&gt;</span>');</div><div class="line"></div><div class="line"><span class="comment">&lt;!-- ending HTML --&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">"target"</span>&gt;</span></div><div class="line">	<span class="tag">&lt;<span class="name">section</span>&gt;</span></div><div class="line">		<span class="tag">&lt;<span class="name">div</span>&gt;</span>Item one<span class="tag">&lt;/<span class="name">div</span>&gt;</span></div><div class="line">		<span class="tag">&lt;<span class="name">div</span>&gt;</span>Item two<span class="tag">&lt;/<span class="name">div</span>&gt;</span></div><div class="line">	<span class="tag">&lt;/<span class="name">section</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></div></pre></td></tr></table></figure>
</li>
</ul>
</li>
</ul>
</li>
<li><p><strong>Animations</strong></p>
<ul>
<li><p><code>hide</code>, <code>show</code>, <code>toggle</code></p>
<p><code>hide</code> causes something to disappear from the screen;</p>
<p><code>show</code> causes something to appear;</p>
<p><code>toggle</code>, on the other hand, determines the current status of the item in question and changes it.</p>
<p> jQuery controls visibility by using the <code>display</code> property in CSS.</p>
<p>Example:</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line"><span class="comment">&lt;!-- HTML --&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">"target"</span>&gt;</span>Show or hide<span class="tag">&lt;/<span class="name">div</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">button</span> <span class="attr">type</span>=<span class="string">"button"</span> <span class="attr">id</span>=<span class="string">"btn-toggle"</span>&gt;</span>Toggle<span class="tag">&lt;/<span class="name">button</span>&gt;</span></div><div class="line"></div><div class="line">//JS</div><div class="line">$(function() &#123;</div><div class="line">	$('#btn-toggle').click(function() &#123;</div><div class="line">		// animation will take one second</div><div class="line">		$('#target').toggle(1000);</div><div class="line">	&#125;);</div><div class="line">&#125;);</div></pre></td></tr></table></figure>
<p>More:</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div></pre></td><td class="code"><pre><div class="line"><span class="comment">&lt;!-- HTML --&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">style</span>&gt;</span><span class="css"></span></div><div class="line">    <span class="selector-class">.hidden</span> &#123; <span class="attribute">display</span>: none; &#125;</div><div class="line"><span class="tag">&lt;/<span class="name">style</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">form</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">div</span>&gt;</span></div><div class="line">        <span class="tag">&lt;<span class="name">label</span>&gt;</span>Name:<span class="tag">&lt;/<span class="name">label</span>&gt;</span></div><div class="line">        <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"text"</span> /&gt;</span></div><div class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">button</span> <span class="attr">type</span>=<span class="string">"button"</span> <span class="attr">id</span>=<span class="string">"show-additional-information"</span>&gt;</span></div><div class="line">        Show additional information</div><div class="line">    <span class="tag">&lt;/<span class="name">button</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">"additional-information"</span> <span class="attr">class</span>=<span class="string">"hidden"</span>&gt;</span></div><div class="line">        <span class="tag">&lt;<span class="name">label</span>&gt;</span>Additional information:<span class="tag">&lt;/<span class="name">label</span>&gt;</span></div><div class="line">        <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"text"</span> /&gt;</span></div><div class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">form</span>&gt;</span></div><div class="line"></div><div class="line">//JS</div><div class="line">$(function() &#123;</div><div class="line">    $('#show-additional-information').click(function() &#123;</div><div class="line">        $('#additional-information').show(750);</div><div class="line">    &#125;);</div><div class="line">&#125;);</div></pre></td></tr></table></figure>
</li>
<li><p>fading and sliding</p>
<ul>
<li><p><code>fadeIn</code>, <code>fadeOut</code>, <code>fadeToggle</code></p>
<p>The fading functions perform their work by both modifying the CSS <code>display</code> property, and animates the item by modifying its <code>opacity</code>.</p>
<p><code>fadeIn</code> and <code>fadeOut</code> will display and hide an item respectively.</p>
<p><code>fadeToggle</code> will reverse the current state of the item.</p>
</li>
<li><p><code>slideDown</code>, <code>slideUp</code> , <code>slideToggle</code></p>
<p>The sliding functions perform their work by both modifying the CSS <code>display</code> property, and animates the item by modifying its <code>position</code>.</p>
</li>
</ul>
</li>
</ul>
</li>
<li><p><strong>Removing, replacing and cloning</strong></p>
<ul>
<li><p>Removing and replacing items</p>
<ul>
<li><p><code>remove</code> and <code>empty</code></p>
<p>Both completely delete items from the DOM.</p>
<p> <code>remove</code> deletes the item you target.</p>
<p> <code>empty</code> deletes the contents of the item you target.</p>
<p>Example:</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">"target"</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">div</span>&gt;</span>Some cool content<span class="tag">&lt;/<span class="name">div</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">div</span>&gt;</span>Some more cool content<span class="tag">&lt;/<span class="name">div</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></div><div class="line"></div><div class="line">//JS</div><div class="line">//the resulting HTML would be, well, nothing. The entire contents of the sample are removed</div><div class="line">$(function() &#123;</div><div class="line">	$('#target').remove();</div><div class="line">&#125;</div><div class="line"></div><div class="line">//deletes the contents of the target, so the resulting HTML would be as <span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">"target"</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></div><div class="line"></div><div class="line">$(function() &#123;</div><div class="line">	$('#target').empty();</div><div class="line">&#125;</div></pre></td></tr></table></figure>
</li>
<li><p><code>replaceAll</code> and <code>replaceWith</code></p>
<p> replace existing content with new content.</p>
<p>Example:</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line"><span class="comment">&lt;!-- starting HTML --&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">"target"</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">div</span>&gt;</span>Some cool content<span class="tag">&lt;/<span class="name">div</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">div</span>&gt;</span>Some more cool content<span class="tag">&lt;/<span class="name">div</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></div><div class="line"></div><div class="line">//JS. execute either of them</div><div class="line">// replaceWith replaces the content on the left with the new content in the parameter</div><div class="line">$('#target').replaceWith('<span class="tag">&lt;<span class="name">div</span>&gt;</span>NEW content<span class="tag">&lt;/<span class="name">div</span>&gt;</span>');</div><div class="line"></div><div class="line">// replaceAll replaces the target in the parameter with the content on the left</div><div class="line">$('<span class="tag">&lt;<span class="name">div</span>&gt;</span>NEW content<span class="tag">&lt;/<span class="name">div</span>&gt;</span>').replaceAll('#target');</div><div class="line"></div><div class="line"><span class="comment">&lt;!-- ending HTML --&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">div</span>&gt;</span>NEW content<span class="tag">&lt;/<span class="name">div</span>&gt;</span></div></pre></td></tr></table></figure>
</li>
</ul>
</li>
<li><p>Cloning</p>
<ul>
<li><code>clone</code></li>
</ul>
<p><code>clone</code> allows you to make a copy of jQuery objects.</p>
<p>Let’s say you were building a page to allow an administrator to create email addresses and passwords. You’d like to ensure the administrator can create as many accounts as they would like on one page, and be able to send up all of the information to the server <strong>in one round trip</strong>, rather than using Ajax calls or submitting the form for each account.</p>
<p>code:</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div></pre></td><td class="code"><pre><div class="line"><span class="comment">&lt;!-- HTML --&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">button</span> <span class="attr">type</span>=<span class="string">"button"</span> <span class="attr">id</span>=<span class="string">"add-line"</span>&gt;</span>Add new line<span class="tag">&lt;/<span class="name">button</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">"container"</span>&gt;</span></div><div class="line">	<span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"user-entry"</span>&gt;</span></div><div class="line">		<span class="tag">&lt;<span class="name">label</span>&gt;</span>Email:<span class="tag">&lt;/<span class="name">label</span>&gt;</span></div><div class="line">		<span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"email"</span> /&gt;</span></div><div class="line">		<span class="tag">&lt;<span class="name">label</span>&gt;</span>Password:<span class="tag">&lt;/<span class="name">label</span>&gt;</span></div><div class="line">		<span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"password"</span> /&gt;</span></div><div class="line">	<span class="tag">&lt;/<span class="name">div</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></div><div class="line"></div><div class="line">//JS</div><div class="line"> $(function() &#123;</div><div class="line"> 	$userForm = $('.user-entry').clone;</div><div class="line">	$('#add-line').click(function() &#123;</div><div class="line">		$('#container').append($userForm.clone());</div><div class="line">	&#125;);</div><div class="line"> &#125;);</div></pre></td></tr></table></figure>
<p><strong>Attention:</strong></p>
<p>When you’re working with an object, JavaScript passes a reference to the object, not a copy of the object. This would mean that we’ve added in a pointer to the clone we created earlier, <strong>not</strong> a brand new copy. The end result is that if we did not call <code>clone()</code> a second time, we’d be trying to add <strong>the exact same object</strong> into the container again, <strong>not</strong> a brand new copy. By calling <code>clone()</code> again, we pass in a copy of our user form, rather than a pointer to the one we already used.</p>
<ul>
<li><p>Cloning and animations</p>
<p>Combinnig cloning and animations.</p>
<p>Example:</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div></pre></td><td class="code"><pre><div class="line"><span class="comment">&lt;!-- HTML --&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">button</span> <span class="attr">type</span>=<span class="string">"button"</span> <span class="attr">id</span>=<span class="string">"add-line"</span>&gt;</span>Add new line<span class="tag">&lt;/<span class="name">button</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">"container"</span>&gt;</span></div><div class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"user-entry"</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">label</span>&gt;</span>Email:<span class="tag">&lt;/<span class="name">label</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"email"</span> /&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">label</span>&gt;</span>Password:<span class="tag">&lt;/<span class="name">label</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"password"</span> /&gt;</span></div><div class="line">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></div><div class="line"></div><div class="line">//JS</div><div class="line">$(function() &#123;</div><div class="line">    $userForm = $('.user-entry').clone();</div><div class="line">    $userForm.css('display', 'none');</div><div class="line">    $('#add-line').click(function() &#123;</div><div class="line">        var newUserForm = $userForm.clone();</div><div class="line">        $('#container').append($newUserForm);</div><div class="line">        newUserForm.show(1000);</div><div class="line">    &#125;);</div><div class="line">&#125;);</div></pre></td></tr></table></figure>
<p>This is  Module2 all about. More <a href="https://courses.edx.org/courses/course-v1:Microsoft+DEV208x+4T2017/course/" target="_blank" rel="external">details</a>.</p>
</li>
</ul>
</li>
</ul>
</li>
</ul>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="http://lupeipei.github.io/2017/10/06/introduction-to-jquery-module2-1/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Lucia">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Lucia">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2017/10/06/introduction-to-jquery-module2-1/" itemprop="url">
                  Introduction to jQuery_2
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-10-06T08:32:55+08:00">
                2017-10-06
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Web/" itemprop="url" rel="index">
                    <span itemprop="name">Web</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
              <span class="post-comments-count">
                <span class="post-meta-divider">|</span>
                <span class="post-meta-item-icon">
                  <i class="fa fa-comment-o"></i>
                </span>
                <a href="/2017/10/06/introduction-to-jquery-module2-1/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count disqus-comment-count"
                        data-disqus-identifier="2017/10/06/introduction-to-jquery-module2-1/" itemprop="commentCount"></span>
                </a>
              </span>
            
          

          
          

          

          

          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h4 id="Before-Start"><a href="#Before-Start" class="headerlink" title="Before Start"></a>Before Start</h4><p>The following contents are the notes I took when learning  jQuery on Edx.</p>
<p>Mainly for  front-End Web developers, check <a href="https://courses.edx.org/courses/course-v1:Microsoft+DEV208x+4T2017/course/" target="_blank" rel="external">here</a> to get more details.</p>
<h4 id="CONTENTS"><a href="#CONTENTS" class="headerlink" title="CONTENTS"></a>CONTENTS</h4><p>Three parts:</p>
<ul>
<li><a href="https://lupeipei.github.io/2017/10/05/introduction-to-jQuery-module1/">Adding jQuery to web pages</a></li>
<li>Managing content, events and effects</li>
<li><a href="https://lupeipei.github.io/2017/10/08/introduction-to-jquery-module3-1/">Asynchronous operations and Ajax calls</a></li>
</ul>
<h4 id="Module2-Managing-content-events-and-effects"><a href="#Module2-Managing-content-events-and-effects" class="headerlink" title="Module2 : Managing content, events and effects"></a>Module2 : Managing content, events and effects</h4><p>Module2 includes six parts:</p>
<ul>
<li>Event handlers</li>
<li>Modifying elements</li>
<li>Registering event handlers</li>
<li>Adding new elements</li>
<li>Animations</li>
<li>Removing, replacing and cloning</li>
</ul>
<p>Let’s get to know something about the first three parts.</p>
<ul>
<li><p><strong>Event handlers</strong></p>
<p>Event object:</p>
<blockquote>
<p>Beyond just the object that raised the event, jQuery (and JavaScript) also pass an <code>event</code> object to the event handler.</p>
<p>This object can be used to determine additional information, such as where the mouse was when the user performed the operation.</p>
</blockquote>
<p>Example:</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// Write out the x/y coordinates of the mouse on click</span></div><div class="line">$(<span class="string">'button'</span>).click(<span class="function"><span class="keyword">function</span>(<span class="params">e</span>) </span>&#123;</div><div class="line">    $(<span class="string">'#output'</span>).text(e.pageX + <span class="string">'x'</span> + e.pageY);</div><div class="line">&#125;);</div></pre></td></tr></table></figure>
<ul>
<li><p><code>Click</code></p>
<p>Example:</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">$(<span class="string">'#target'</span>).click(<span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123; alert(<span class="string">'hello, world!'</span>); &#125;);</div></pre></td></tr></table></figure>
</li>
<li><p><code>dbclick</code></p>
<p> raised when the user double clicks on an element.</p>
<p>Example:</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">$(<span class="string">'#target'</span>).dbclick(<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123; alert(<span class="string">'hello, world!'</span>); &#125;);</div></pre></td></tr></table></figure>
</li>
<li><p>Forms : blur, change, focus</p>
<ul>
<li><p><code>blur</code></p>
<p>raised when a form element loses what’s known as focus. often used for validation.</p>
<p>Example:</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">$(<span class="string">'#target'</span>).blur(<span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</div><div class="line">    <span class="comment">// retrieve the value using val</span></div><div class="line">    <span class="keyword">var</span> value = $(<span class="string">'#target'</span>).val();</div><div class="line">    alert(value);</div><div class="line">&#125;)</div></pre></td></tr></table></figure>
</li>
<li><p><code>change</code></p>
<p>raised whenever an element is modified.<strong>limited</strong> to <code>input</code>, <code>textarea</code> and <code>select</code> elements only.</p>
<p>Example:</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">$(<span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</div><div class="line">  $(<span class="string">'#parent'</span>).change(<span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</div><div class="line">    <span class="keyword">var</span> value = $(<span class="string">'#parent'</span>).val();</div><div class="line">    $(<span class="string">'#child'</span>).empty();</div><div class="line">    $(<span class="string">'#child'</span>).append(<span class="string">'&lt;option&gt;1 - '</span> + value + <span class="string">'&lt;/option&gt;'</span>);</div><div class="line">    $(<span class="string">'#child'</span>).append(<span class="string">'&lt;option&gt;2 - '</span> + value + <span class="string">'&lt;/option&gt;'</span>);</div><div class="line">  &#125;)</div><div class="line">&#125;);</div></pre></td></tr></table></figure>
</li>
<li><p><code>focus</code></p>
<p>the opposite of <code>blur</code>. raised when the user clicks, taps, or tabs into a particular control, typically because they want to change its value.</p>
<p>Example:</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line"><span class="comment">&lt;!-- sample HTML --&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">div</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">label</span> <span class="attr">for</span>=<span class="string">"phone"</span>&gt;</span>Phone<span class="tag">&lt;/<span class="name">label</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"text"</span> <span class="attr">id</span>=<span class="string">"phone"</span> /&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">span</span> <span class="attr">id</span>=<span class="string">"phone-help"</span>&gt;</span><span class="tag">&lt;/<span class="name">span</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></div><div class="line"></div><div class="line">// sample JavaScript</div><div class="line">$('#phone').focus(function() &#123;</div><div class="line">    // Control has focus. Display help</div><div class="line">    $('#phone-help').text('Please enter your phone number as all digits');</div><div class="line">&#125;).blur(function() &#123;</div><div class="line">    // Control lost focus. Clear help</div><div class="line">    $('#phone-help').text('');</div><div class="line">&#125;);</div></pre></td></tr></table></figure>
</li>
</ul>
</li>
<li><p>Mouse movement</p>
<ul>
<li><p><code>mouseenter</code>, <code>mouseleave</code></p>
<p><code>mouseenter</code> is raised whenever the user moves their mouse over an element.</p>
<p><code>mouseleave</code> is raised when the user moves their mouse away from an element.</p>
<p>Example:</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line"><span class="comment">&lt;!-- sample HTML --&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">div</span>&gt;</span></div><div class="line">	<span class="tag">&lt;<span class="name">span</span> <span class="attr">id</span>=<span class="string">"target"</span>&gt;</span>Basic data<span class="tag">&lt;/<span class="name">span</span>&gt;</span></div><div class="line">	<span class="tag">&lt;<span class="name">span</span> <span class="attr">id</span>=<span class="string">"target-help"</span>&gt;</span><span class="tag">&lt;/<span class="name">span</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></div><div class="line"></div><div class="line">// sample JavaScript</div><div class="line">$('#target').mouseenter(function() &#123;</div><div class="line">	$('#target-help').text('More data');</div><div class="line">&#125;).mouseleave(function() &#123;</div><div class="line">	$('#target-help').text('');</div><div class="line">&#125;);</div></pre></td></tr></table></figure>
</li>
<li><p><code>hover</code></p>
<p>equivalent to both the <code>mouseenter</code> and <code>mouseleave</code> events. The first parameter <code>hover</code> accepts is for <code>mouseenter</code>, or when the hover begins, and the second parameter is for <code>mouseout</code>.</p>
<p>Example:</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">$(<span class="string">'#target'</span>).hover(<span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</div><div class="line">	<span class="comment">// mouseenter</span></div><div class="line">	$(<span class="string">'#target-help'</span>).text(<span class="string">'More data'</span>);</div><div class="line">&#125;, <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</div><div class="line">	<span class="comment">// mouseleave</span></div><div class="line">	$(<span class="string">'#target-help'</span>).text(<span class="string">''</span>);</div><div class="line">&#125;);</div></pre></td></tr></table></figure>
<p>​</p>
</li>
</ul>
</li>
</ul>
</li>
<li><p><strong>Modifying elements</strong></p>
<ul>
<li><p>Replacing element HTML and text</p>
<ul>
<li><p><code>val</code></p>
<p>for read the value, like to say retrieve the value of an input control, you can use <code>val()</code></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">var value = $(&apos;#some-input-control&apos;).val();</div></pre></td></tr></table></figure>
<p>also, you can set the value. use <code>val(new-value)</code></p>
<p>Example: set a textbox to a blank value</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// Empty a textbox</span></div><div class="line">$(<span class="string">'#some-textbox'</span>).val(<span class="string">''</span>);</div></pre></td></tr></table></figure>
</li>
<li><p><code>html</code></p>
<p>you have saw it in Module1.</p>
<p>Example:</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// write text out to the screen</span></div><div class="line"><span class="comment">// this will be displayed as</span></div><div class="line"><span class="comment">// &lt;strong&gt;value&lt;/strong&gt;</span></div><div class="line"><span class="comment">// the text value will not be bolded</span></div><div class="line"></div><div class="line">$(<span class="string">'#output'</span>).text(<span class="string">'value'</span>);</div></pre></td></tr></table></figure>
</li>
<li><p><code>text</code></p>
<p>Example:</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// write text out to the screen</span></div><div class="line"><span class="comment">// this will be displayed as value</span></div><div class="line"><span class="comment">// with the word bolded</span></div><div class="line"></div><div class="line">$(<span class="string">'#output'</span>).html(<span class="string">'value'</span>);</div></pre></td></tr></table></figure>
</li>
</ul>
</li>
<li><p>Working with attribute and classes</p>
<ul>
<li><p><code>attr</code></p>
<p>To retrieve the value of an attribute, simply call <code>attr(name)</code>.</p>
<p>To change the value of an attribute, simply call <code>attr(name, newValue)</code>.</p>
</li>
<li><p><code>addClass</code> and <code>removeClass</code></p>
<p>You have known it in Module1. Besides, one nice thing about <code>removeClass</code> is it will not throw an error if the class doesn’t exist.</p>
</li>
</ul>
</li>
<li><p>Working with styles</p>
<ul>
<li><p><code>css</code></p>
<p>To retrieve the value of a CSS property,  call <code>css(property)</code>.</p>
<p>To set a property, call <code>css(property, newValue)</code></p>
<p>Example:</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// Retrieve an item's color</span></div><div class="line"><span class="keyword">var</span> color = $(<span class="string">'#target'</span>).css(<span class="string">'color'</span>);</div><div class="line"></div><div class="line"><span class="comment">// Change an item's color to red</span></div><div class="line">$(<span class="string">'#target'</span>).css(<span class="string">'color'</span>, <span class="string">'red'</span>);</div></pre></td></tr></table></figure>
<p>To set multiple properties,  create a JavaScript object with the property/value pairs, and then pass the object into the <code>css</code> function.</p>
<p>Example:</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> style = &#123;</div><div class="line">	<span class="attr">color</span>: <span class="string">'red'</span>,</div><div class="line">	<span class="attr">backgroundColor</span>: yellow</div><div class="line">&#125;;</div><div class="line"></div><div class="line">$(<span class="string">'#target'</span>).css(style);</div></pre></td></tr></table></figure>
</li>
</ul>
</li>
</ul>
</li>
<li><p><strong>Registering event handlers</strong></p>
<ul>
<li><p>Dynamic event handlers</p>
<ul>
<li><p><code>on</code>, <code>off</code></p>
<p>Both <code>on</code> and <code>off</code> share the same syntax:</p>
<p><code>$(&#39;selector&#39;).on/off(&#39;events&#39;, &#39;selector (optional)&#39;, function)</code></p>
<p>Here, <code>events</code>: A space separated list of the events you wish to register, such as <code>&#39;click&#39;</code> or <code>&#39;click mouseenter&#39;</code></p>
<p> BTW, Obviously if you need to <strong>dynamically choose the event</strong>, or if you need <strong>multiple events for the same event handler</strong>, using <code>on</code> is your only choice.</p>
<p>In additon, <code>on</code> offers one more feature, known as delegation.</p>
</li>
</ul>
</li>
<li><p>Delegation</p>
<p>Registering an event handler using <code>delegate</code>,  is similar to <code>on</code>, with one major difference: New elements will automatically have the event handler applied.</p>
<p>The <code>delegate</code> syntax:</p>
<p><code>$(selector).delegate(selector, events, eventHandler)</code></p>
<p>Example:</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div></pre></td><td class="code"><pre><div class="line"><span class="comment">&lt;!-- sample HTML --&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">button</span>&gt;</span>Click<span class="tag">&lt;/<span class="name">button</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">"placeholder"</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></div><div class="line"></div><div class="line">//JS</div><div class="line">$(function() &#123;</div><div class="line">	// document.ready (on load)</div><div class="line"></div><div class="line">	// register a click event handler with all button elements, except new button</div><div class="line">	//$('button').click(function() &#123; alert('hello'); &#125;);</div><div class="line">	// new button will also be raised</div><div class="line">	$(document).delegate('button', 'click', function() &#123; alert('hello'); &#125;);</div><div class="line"></div><div class="line">	// create a new button</div><div class="line">	$('#placeholder').html('<span class="tag">&lt;<span class="name">button</span>&gt;</span>New button<span class="tag">&lt;/<span class="name">button</span>&gt;</span>');</div><div class="line">&#125;);</div></pre></td></tr></table></figure>
<p>With jQuery 1.7, <code>delegate</code> is superseded by <code>on</code>.</p>
<p><strong>One important thing to note</strong> is the order of parameters for <code>on</code> and <code>delegate</code>.</p>
<p>With <code>on</code>, you list the events first and the selector second. With <code>delegate</code>, it’s selector followed by events.</p>
<p>Example:</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// Delegation (note the order of parameters)</span></div><div class="line">$(<span class="built_in">document</span>).on(<span class="string">'click'</span>, <span class="string">'button'</span>, <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;alert(<span class="string">'hello'</span>); &#125;);</div><div class="line"></div><div class="line"><span class="comment">// Semantically the same as above</span></div><div class="line"><span class="comment">// (note the order of parameters)</span></div><div class="line">$(<span class="built_in">document</span>).delegate(<span class="string">'button'</span>, <span class="string">'click'</span>, <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123; alert(<span class="string">'hello'</span>); &#125;);</div></pre></td></tr></table></figure>
</li>
<li><p>Single execution</p>
<ul>
<li><p><code>one</code></p>
<p><code>one</code> shares a similar syntax with <code>on</code>, only there is no delegation option.</p>
<p>The event only execute once.</p>
<p>Example:</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line"><span class="comment">&lt;!-- sample HTML --&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">button</span> <span class="attr">id</span>=<span class="string">"single"</span>&gt;</span>This only works once<span class="tag">&lt;/<span class="name">button</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">"output"</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></div><div class="line"></div><div class="line">//JS</div><div class="line">$(function() &#123;</div><div class="line">    $('#single').one('click', function() &#123;</div><div class="line">        $('#output').text('You clicked on the button');</div><div class="line">    &#125;);</div><div class="line">&#125;);</div></pre></td></tr></table></figure>
</li>
</ul>
</li>
<li><p>Triggering events</p>
<p>Raise the event programatically, like to click on a button to refresh data.</p>
<p><code>trigger</code> and <code>triggerHandler</code> allow you to provide the name of the event as a parameter.</p>
<p><code>trigger</code> will execute for <strong>all elements</strong> in the collection,</p>
<p>while <code>triggerHandler</code> only executes the handler for <strong>the first element</strong>.</p>
<p>Example:</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div></pre></td><td class="code"><pre><div class="line"><span class="comment">&lt;!-- sample HTML --&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">button</span> <span class="attr">type</span>=<span class="string">"button"</span> <span class="attr">id</span>=<span class="string">"first"</span>&gt;</span>First button<span class="tag">&lt;/<span class="name">button</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">button</span> <span class="attr">type</span>=<span class="string">"button"</span> <span class="attr">id</span>=<span class="string">"Second"</span>&gt;</span>Second button<span class="tag">&lt;/<span class="name">button</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">button</span> <span class="attr">type</span>=<span class="string">"button"</span> <span class="attr">id</span>=<span class="string">"trigger"</span>&gt;</span>trigger<span class="tag">&lt;/<span class="name">button</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">button</span> <span class="attr">type</span>=<span class="string">"button"</span> <span class="attr">id</span>=<span class="string">"trigger-handler"</span>&gt;</span>triggerHandler<span class="tag">&lt;/<span class="name">button</span>&gt;</span></div><div class="line"></div><div class="line">//JS</div><div class="line">$(function() &#123;</div><div class="line">    $('button').click(function() &#123;</div><div class="line">        // display the id of the button</div><div class="line">        alert(this.id);</div><div class="line">    &#125;);</div><div class="line"></div><div class="line">    $('#trigger').click(function() &#123;</div><div class="line">        // Would alert every button's id</div><div class="line">        // including the last two</div><div class="line">        $('button').trigger('click');</div><div class="line">    &#125;);</div><div class="line"></div><div class="line">    // Would alert "first"</div><div class="line">    $('#trigger-handler').click(function() &#123;</div><div class="line">        // Would alert "first"</div><div class="line">        $('button').triggerHandler('click');</div><div class="line">    &#125;);</div><div class="line">&#125;);</div></pre></td></tr></table></figure>
<p>This is the first three parts of Module2 all about. More <a href="https://courses.edx.org/courses/course-v1:Microsoft+DEV208x+4T2017/course/" target="_blank" rel="external">details</a>.</p>
</li>
</ul>
</li>
</ul>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="http://lupeipei.github.io/2017/10/05/introduction-to-jQuery-module1/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Lucia">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Lucia">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2017/10/05/introduction-to-jQuery-module1/" itemprop="url">
                  Introduction to jQuery_1
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-10-05T10:17:44+08:00">
                2017-10-05
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Web/" itemprop="url" rel="index">
                    <span itemprop="name">Web</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
              <span class="post-comments-count">
                <span class="post-meta-divider">|</span>
                <span class="post-meta-item-icon">
                  <i class="fa fa-comment-o"></i>
                </span>
                <a href="/2017/10/05/introduction-to-jQuery-module1/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count disqus-comment-count"
                        data-disqus-identifier="2017/10/05/introduction-to-jQuery-module1/" itemprop="commentCount"></span>
                </a>
              </span>
            
          

          
          

          

          

          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h4 id="Before-Start"><a href="#Before-Start" class="headerlink" title="Before Start"></a>Before Start</h4><p>The following contents are the notes I took when learning  jQuery on Edx.</p>
<p>Mainly for  front-End Web developers, check <a href="https://courses.edx.org/courses/course-v1:Microsoft+DEV208x+4T2017/course/" target="_blank" rel="external">here</a> to get more details.</p>
<p>BTW, This class is supported by Microsoft. If you are a Linux fan, hope it would not make you uncomfortable( cause I am a little uncomfortable about it at first.) : D</p>
<h4 id="CONTENTS"><a href="#CONTENTS" class="headerlink" title="CONTENTS"></a>CONTENTS</h4><p>Three parts:</p>
<ul>
<li>Adding jQuery to web pages</li>
<li><a href="https://lupeipei.github.io/2017/10/06/introduction-to-jquery-module2-1/">Managing content, events and effects</a></li>
<li><a href="https://lupeipei.github.io/2017/10/08/introduction-to-jquery-module3-1/">Asynchronous operations and Ajax calls</a></li>
</ul>
<p>DOM: Document Object Model.</p>
<p>jQuery : the most popular javaScript library. designed to bring additional power to JS.</p>
<p>Let’s start!</p>
<h4 id="Module1-Adding-jQuery-to-web-pages"><a href="#Module1-Adding-jQuery-to-web-pages" class="headerlink" title="Module1 : Adding jQuery to web pages"></a>Module1 : Adding jQuery to web pages</h4><ul>
<li><p><strong>Getting started with jQuery</strong></p>
<ul>
<li>use Visual Studio</li>
<li>getting started with <a href="https://code.visualstudio.com" target="_blank" rel="external">Visual Studio Code</a></li>
</ul>
</li>
<li><p><strong>Adding jQuery to a page</strong></p>
<p> a simple example to start:</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// you can use either of them:</span></div><div class="line"></div><div class="line">$(<span class="built_in">document</span>).ready(<span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</div><div class="line">	<span class="comment">// code here</span></div><div class="line">&#125;);</div><div class="line"></div><div class="line">$(<span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</div><div class="line">	<span class="comment">// code here</span></div><div class="line">&#125;);</div></pre></td></tr></table></figure>
</li>
<li><p><strong>Using CSS selectors with jQuery</strong></p>
<ul>
<li><p>Common CSS selectors</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">$(<span class="string">'h1'</span>) <span class="comment">// selects all h1 elements</span></div><div class="line">$(<span class="string">'.class-name'</span>) <span class="comment">// selects all elements with a class of class-name</span></div><div class="line">$(<span class="string">'#demo'</span>) <span class="comment">// selects all elements with an id of demo</span></div></pre></td></tr></table></figure>
</li>
<li><p>Attribute based selectors</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// selects all elements with an attribute matching the specified value</span></div><div class="line">$(<span class="string">'[demo-attribute="demo-value"]'</span>)</div><div class="line"></div><div class="line"><span class="comment">// selects all h1 elements with an attribute matching the specified value</span></div><div class="line">$(<span class="string">'h1[demo-attribute="demo-value"]'</span>)</div><div class="line"></div><div class="line"><span class="comment">// If you wish to find all elements where the value **starts** with a string, use the ^= operator.</span></div><div class="line">$(<span class="string">'[class^="col"]'</span>)</div><div class="line"></div><div class="line"><span class="comment">// If you wish to find all elements where the value **contains** a string, use the *= operator.</span></div><div class="line">$(<span class="string">'[class*="md"]'</span>)</div></pre></td></tr></table></figure>
</li>
<li><p>Positional selectors</p>
<ul>
<li><p><strong>Parent/child relationships</strong></p>
<p>Consider the following script:</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// Selects all a elements that are direct descendants nav element</span></div><div class="line">$(<span class="string">'nav &gt; a'</span>)</div></pre></td></tr></table></figure>
<p>In the following HTML, the first link would be selected, but not the second. This is because the first link is a <strong>direct child</strong>, but the second is inside of a <code>div</code>element.</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">nav</span>&gt;</span></div><div class="line">	<span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"#"</span>&gt;</span>(First) This will be selected<span class="tag">&lt;/<span class="name">a</span>&gt;</span></div><div class="line">	<span class="tag">&lt;<span class="name">div</span>&gt;</span></div><div class="line">		<span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"#"</span>&gt;</span>(Second) This will not be selected<span class="tag">&lt;/<span class="name">a</span>&gt;</span></div><div class="line">	<span class="tag">&lt;/<span class="name">div</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">nav</span>&gt;</span></div></pre></td></tr></table></figure>
</li>
<li><p><strong>Descendants</strong></p>
<p>Examples:</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line">// Selects all a elements that are descendants nav element</div><div class="line">// The elements can appear anywhere inside of the element listed first</div><div class="line">$('nav a')</div><div class="line"></div><div class="line">//this is an example to show the difference,if you use $('nav a'), the first and the second will be selected both, if you use $('nav &gt; a'), only the first one will be selected.</div><div class="line"><span class="tag">&lt;<span class="name">nav</span>&gt;</span></div><div class="line">	<span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"#"</span>&gt;</span>(First) This will be selected<span class="tag">&lt;/<span class="name">a</span>&gt;</span></div><div class="line">	<span class="tag">&lt;<span class="name">div</span>&gt;</span></div><div class="line">		<span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"#"</span>&gt;</span>(Second) This will be selected<span class="tag">&lt;/<span class="name">a</span>&gt;</span></div><div class="line">	<span class="tag">&lt;/<span class="name">div</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">nav</span>&gt;</span></div></pre></td></tr></table></figure>
</li>
</ul>
</li>
</ul>
</li>
<li><p><strong>Navigating the DOM with jQuery</strong></p>
<ul>
<li><p>Parent /child relationships</p>
<p>Four methods: <code>children</code> ,<code>find</code>, <code>parent</code>, <code>parents</code></p>
<ul>
<li>with<code>children</code>, it’s gonna be just the direct children.</li>
<li><code>find</code> will walk the entire hierarchy down, but it needs a selector.</li>
<li><code>parent</code> will be the immediate parent.</li>
<li>And <code>parents</code>, plural, will walk up the entire chain.</li>
</ul>
</li>
<li><p>Siblings</p>
<ul>
<li><p><code>prev</code> and <code>next</code></p>
<blockquote>
<p><code>prev()</code>: To move to the prior element</p>
<p><code>next()</code>: To move to the next element</p>
</blockquote>
</li>
<li><p><code>prevAll</code> and <code>nextAll</code></p>
<blockquote>
<p><code>prevAll</code> and <code>nextAll</code> will select all siblings prior or after the element. Both methods also accept a CSS selector to limit the items.</p>
</blockquote>
</li>
<li><p><code>prevUntil</code> and <code>nextUntil</code></p>
<blockquote>
<p><code>prevUntil</code> and <code>nextUntil</code> select all prior or following elements up to, but <strong>not including</strong> the element that matches the selector.</p>
</blockquote>
</li>
</ul>
</li>
<li><p>Selecting items by position</p>
<ul>
<li><p>Finding the index of an item</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="comment">//index method will return the zero based (ordinal) location of the item, or -1 if the item isn't found.</span></div><div class="line"></div><div class="line"><span class="keyword">var</span> currentElement = $(<span class="string">'some selector'</span>);</div><div class="line"><span class="keyword">var</span> parent = $(<span class="string">'some selector'</span>);</div><div class="line"><span class="keyword">var</span> index = parent.children().index(currentElement);</div></pre></td></tr></table></figure>
</li>
<li><p>Finding an item by its position</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="comment">//using the get method</span></div><div class="line"><span class="keyword">var</span> parent = $(<span class="string">'some selector'</span>);</div><div class="line"><span class="keyword">var</span> element = parent.children().get(index);</div></pre></td></tr></table></figure>
<p>One important note about <code>get</code> is it returns a JavaScript DOM object, <strong>not</strong> a jQuery object.</p>
<p>In order to call jQuery methods on the object, you must convert it to a jQuery object.</p>
<p>Examples below:</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> parent = $(<span class="string">'some selector'</span>);</div><div class="line"><span class="keyword">var</span> domobject = parent.children().get(index); <span class="comment">// DOM object</span></div><div class="line"><span class="keyword">var</span> jQueryObject = $(parent.children().get(index)); <span class="comment">// jQuery object</span></div></pre></td></tr></table></figure>
</li>
</ul>
</li>
</ul>
</li>
<li><p><strong>Getting started with DOM manipulation</strong></p>
<ul>
<li><p>Adding and removing classes</p>
<ul>
<li><p>Adding a class to an element is just as easy as calling <code>addClass</code></p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">currentElement.addClass(<span class="string">'class-name'</span>);</div></pre></td></tr></table></figure>
</li>
<li><p>Removing a class from an element is just as easy as calling <code>removeClass</code>. If the element in question was not already decorated with the class you’re trying to remove, the method will simply return.</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">currentElement.removeClass(<span class="string">'class-name'</span>);</div></pre></td></tr></table></figure>
</li>
</ul>
</li>
<li><p>Working with attributes</p>
<ul>
<li><p>reading an attribute value</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">alert($(<span class="string">'selector'</span>).attr(<span class="string">'attribute-name'</span>));</div></pre></td></tr></table></figure>
</li>
<li><p>modifying an attribute value</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">$(<span class="string">'selector'</span>).attr(<span class="string">'attribute-name'</span>, <span class="string">'new value'</span>);</div></pre></td></tr></table></figure>
</li>
<li><p>removing an attribute value</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">$(<span class="string">'selector'</span>).removeAttr(<span class="string">'attribute-name'</span>);</div></pre></td></tr></table></figure>
</li>
</ul>
</li>
<li><p>Modifying content</p>
<ul>
<li><p><code>text()</code>: get to replace the existing text in an element</p>
</li>
<li><p><code>html()</code>: get to replace the existing HTML in an element</p>
</li>
<li><p>the different between <code>text()</code>  and <code>html()</code> is whether or not it’s gonna allow for HTML.</p>
<p>Examples:</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// update the text</span></div><div class="line">$(item).text(<span class="string">'&lt;h1&gt;Hello, world!!&lt;/h1&gt;'</span>); <span class="comment">//output: &lt;h1&gt;Hello, world!!&lt;/h1&gt;</span></div><div class="line"></div><div class="line"><span class="comment">// update the html</span></div><div class="line">$(item).text(<span class="string">'&lt;h1&gt;Hello, world!!&lt;/h1&gt;'</span>);<span class="comment">//output: Hello, world!!</span></div></pre></td></tr></table></figure>
<p>you can say that HTML will allow you to modify HTML, Text is going to be for text only.</p>
</li>
</ul>
</li>
<li><p>Basic event handlers</p>
<p>like click event, more details in <a href="https://lupeipei.github.io/2017/10/06/introduction-to-jquery-module2-1/">Module 2</a></p>
<p>Inside of the event handler code, you can access the object that raised the event by using <code>this</code>.</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div></pre></td><td class="code"><pre><div class="line"><span class="comment">//examples</span></div><div class="line"><span class="comment">//click event</span></div><div class="line"><span class="comment">//raised when the item is clicked</span></div><div class="line">$(item).click(<span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</div><div class="line">    alert(<span class="string">'clicked!!'</span>);</div><div class="line">&#125;);</div><div class="line"></div><div class="line"><span class="comment">// hover event</span></div><div class="line"><span class="comment">// raised when the user moves their mouse over the item</span></div><div class="line">$(item).hover(<span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</div><div class="line">    alert(<span class="string">'hover!!'</span>);</div><div class="line">&#125;);</div><div class="line"></div><div class="line"><span class="comment">// mouseout</span></div><div class="line"><span class="comment">// raised when the user moves their mouse away from an item</span></div><div class="line">$(item).mouseout(<span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</div><div class="line">    alert(<span class="string">'mouse out'</span>);</div><div class="line">&#125;);</div></pre></td></tr></table></figure>
</li>
</ul>
</li>
</ul>
<p>This is Module1 all about. More <a href="https://courses.edx.org/courses/course-v1:Microsoft+DEV208x+4T2017/course/" target="_blank" rel="external">details</a>.</p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="http://lupeipei.github.io/2017/10/04/web-together-build-8/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Lucia">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Lucia">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2017/10/04/web-together-build-8/" itemprop="url">
                  Together网站搭建之踩坑系列8
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-10-04T06:55:40+08:00">
                2017-10-04
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/ROR/" itemprop="url" rel="index">
                    <span itemprop="name">ROR</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
              <span class="post-comments-count">
                <span class="post-meta-divider">|</span>
                <span class="post-meta-item-icon">
                  <i class="fa fa-comment-o"></i>
                </span>
                <a href="/2017/10/04/web-together-build-8/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count disqus-comment-count"
                        data-disqus-identifier="2017/10/04/web-together-build-8/" itemprop="commentCount"></span>
                </a>
              </span>
            
          

          
          

          

          

          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h4 id="写在前面"><a href="#写在前面" class="headerlink" title="写在前面"></a>写在前面</h4><p>这是功能实现的第七篇，扯一扯<strong>如何在个人中心实作密码修改</strong>.</p>
<p>完整作品源码及效果，看这里<a href="https://togetherisbetter.cn/" target="_blank" rel="external">作品网站</a>,   <a href="https://github.com/Lupeipei/Together" target="_blank" rel="external">作品源码</a>。</p>
<h4 id="目录"><a href="#目录" class="headerlink" title="目录"></a>目录</h4><ul>
<li><a href="https://lupeipei.github.io/2017/09/28/web-together-build-2/">给活动添加收藏功能，并使用Ajax进行优化</a></li>
<li><a href="https://lupeipei.github.io/2017/09/29/web-together-build-3/">给活动Events添加分类筛选</a></li>
<li><a href="https://lupeipei.github.io/2017/09/30/web-together-build-4/">添加省市自治区地址, 并实现热门城市筛选</a></li>
<li><a href="https://lupeipei.github.io/2017/10/01/web-together-build-5/">添加时间筛选</a></li>
<li><a href="https://lupeipei.github.io/2017/10/02/web-together-build-6/">添加评论区，并使用ajax优化</a></li>
<li><a href="https://lupeipei.github.io/2017/10/03/web-together-build-7/">实作活动申请</a></li>
<li>在个人中心实作密码修改</li>
</ul>
<h4 id="正文"><a href="#正文" class="headerlink" title="正文"></a>正文</h4><p>这里修改用户名和头像简单带过，我们专注于<strong>密码修改</strong>。</p>
<p>来动动我们熟悉的devise。</p>
<p>先看效果，在个人中心添加密码修改板块：</p>
<p><img src="https://ws4.sinaimg.cn/large/006tKfTcly1fk1dhibubej30wx0j4dip.jpg" alt=""></p>
<p>具体步骤：</p>
<ul>
<li><p>终端运行：<code>rails g controller account::users</code></p>
</li>
<li><p>在<code>app/controllers/account/users_controller.eb</code>中，仅有头像和用户名的update：</p>
<figure class="highlight ruby"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">Account::UsersController</span> &lt; ApplicationController</span></div><div class="line">  before_action <span class="symbol">:authenticate_user!</span></div><div class="line"></div><div class="line">  <span class="function"><span class="keyword">def</span> <span class="title">index</span></span></div><div class="line">    @user = current_user</div><div class="line">  <span class="keyword">end</span></div><div class="line"></div><div class="line">  <span class="function"><span class="keyword">def</span> <span class="title">show</span></span></div><div class="line">    @user = current_user</div><div class="line">  <span class="keyword">end</span></div><div class="line"></div><div class="line">  <span class="function"><span class="keyword">def</span> <span class="title">edit</span></span></div><div class="line">    @user = current_user</div><div class="line">  <span class="keyword">end</span></div><div class="line"></div><div class="line">  <span class="function"><span class="keyword">def</span> <span class="title">update</span></span></div><div class="line">    @user = current_user</div><div class="line">    <span class="keyword">if</span> @user.update(user_params)</div><div class="line">      redirect_to account_user_path, <span class="symbol">notice:</span> <span class="string">"信息更新成功"</span></div><div class="line">    <span class="keyword">else</span></div><div class="line">      render <span class="symbol">:edit</span></div><div class="line">    <span class="keyword">end</span></div><div class="line">  <span class="keyword">end</span></div><div class="line"></div><div class="line">  private</div><div class="line"></div><div class="line">  <span class="function"><span class="keyword">def</span> <span class="title">user_params</span></span></div><div class="line">    params.<span class="keyword">require</span>(<span class="symbol">:user</span>).permit(<span class="symbol">:username</span>, <span class="symbol">:avatar</span>)</div><div class="line">  <span class="keyword">end</span></div><div class="line"><span class="keyword">end</span></div></pre></td></tr></table></figure>
</li>
<li><p>在<code>app/views/account/users/show.html.erb</code>中，添加密码修改部分：</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div></pre></td><td class="code"><pre><div class="line">........</div><div class="line">&lt;%= simple_form_for [:account, @user] do |f| %&gt;</div><div class="line"> ......</div><div class="line">  &lt;div class="my_password"&gt;</div><div class="line">    &lt;h4&gt;修改密码： &lt;/h4&gt;</div><div class="line">    &lt;%= f.input :current_password, label: "旧密码：", hint: false, error_html: &#123; id: 'password_error'&#125; %&gt;</div><div class="line">    &lt;%= f.input :password, label: "新密码：", hint: false, error_html: &#123; id: 'password_error'&#125; %&gt;</div><div class="line">    &lt;%= f.input :password_confirmation, label: "密码确认："%&gt;</div><div class="line">  &lt;/div&gt;</div><div class="line">  &lt;br&gt;</div><div class="line">  .......</div><div class="line">  &lt;div class="form-group"&gt;</div><div class="line">    &lt;%= f.submit "更新", class: "btn btn-success"%&gt;</div><div class="line">  &lt;/div&gt;</div><div class="line">&lt;% end %&gt;</div><div class="line">.......</div></pre></td></tr></table></figure>
</li>
<li><p>在<code>app/controllers/account/users_controller.eb</code>中，做如下修改：</p>
<figure class="highlight ruby"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div></pre></td><td class="code"><pre><div class="line">......</div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">update</span></span></div><div class="line">  @user = current_user</div><div class="line">- <span class="keyword">if</span> @user.update(user_params)</div><div class="line">-   redirect_to account_user_path, <span class="symbol">notice:</span> <span class="string">"信息更新成功"</span></div><div class="line">+  <span class="keyword">if</span> @user.update_with_password(user_params)</div><div class="line">+     bypass_sign_in(@user)</div><div class="line">+     redirect_to account_user_path, <span class="symbol">notice:</span> <span class="string">"密码更新成功"</span></div><div class="line">+  <span class="keyword">elsif</span> @user.update(user_params)</div><div class="line">+     redirect_to account_user_path, <span class="symbol">notice:</span> <span class="string">"信息更新成功"</span></div><div class="line">  <span class="keyword">else</span></div><div class="line">      render <span class="symbol">:edit</span></div><div class="line">  <span class="keyword">end</span></div><div class="line"><span class="keyword">end</span></div><div class="line"></div><div class="line">private</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">user_params</span></span></div><div class="line">-	params.<span class="keyword">require</span>(<span class="symbol">:user</span>).permit(<span class="symbol">:username</span>, <span class="symbol">:avatar</span>)</div><div class="line">+ params.<span class="keyword">require</span>(<span class="symbol">:user</span>).permit(<span class="symbol">:username</span>, <span class="symbol">:avatar</span>, <span class="symbol">:password</span>, <span class="symbol">:password_confirmation</span>)</div><div class="line"><span class="keyword">end</span></div></pre></td></tr></table></figure>
</li>
</ul>
<p>这样就OK啦，可以在个人中心页面修改密码，保存后退出，重新登陆，会发现密码已经修改了。</p>
<p><strong>参考：</strong></p>
<p><a href="https://github.com/plataformatec/devise/wiki/How-To:-Allow-users-to-edit-their-password" target="_blank" rel="external">how to allow user to edit their password</a></p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="http://lupeipei.github.io/2017/10/03/web-together-build-7/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Lucia">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Lucia">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2017/10/03/web-together-build-7/" itemprop="url">
                  Together网站搭建之踩坑系列7
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-10-03T07:08:45+08:00">
                2017-10-03
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/ROR/" itemprop="url" rel="index">
                    <span itemprop="name">ROR</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
              <span class="post-comments-count">
                <span class="post-meta-divider">|</span>
                <span class="post-meta-item-icon">
                  <i class="fa fa-comment-o"></i>
                </span>
                <a href="/2017/10/03/web-together-build-7/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count disqus-comment-count"
                        data-disqus-identifier="2017/10/03/web-together-build-7/" itemprop="commentCount"></span>
                </a>
              </span>
            
          

          
          

          

          

          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h4 id="写在前面"><a href="#写在前面" class="headerlink" title="写在前面"></a>写在前面</h4><p>这是功能实现的第六篇，扯一扯<strong>如何实作活动申请</strong>.</p>
<p>完整作品源码及效果，看这里<a href="https://togetherisbetter.cn/" target="_blank" rel="external">作品网站</a>,   <a href="https://github.com/Lupeipei/Together" target="_blank" rel="external">作品源码</a>。</p>
<h4 id="目录"><a href="#目录" class="headerlink" title="目录"></a>目录</h4><ul>
<li><a href="https://lupeipei.github.io/2017/09/28/web-together-build-2/">给活动添加收藏功能，并使用Ajax进行优化</a></li>
<li><a href="https://lupeipei.github.io/2017/09/29/web-together-build-3/">给活动Events添加分类筛选</a></li>
<li><a href="https://lupeipei.github.io/2017/09/30/web-together-build-4/">添加省市自治区地址, 并实现热门城市筛选</a></li>
<li><a href="https://lupeipei.github.io/2017/10/01/web-together-build-5/">添加时间筛选</a></li>
<li><a href="https://lupeipei.github.io/2017/10/02/web-together-build-6/">添加评论区，并使用ajax优化</a></li>
<li>实作活动申请</li>
<li><a href="https://lupeipei.github.io/2017/10/04/web-together-build-8/">在个人中心实作密码修改</a></li>
</ul>
<h4 id="正文"><a href="#正文" class="headerlink" title="正文"></a>正文</h4><p>具体说，是实作以下两个功能：</p>
<ul>
<li>用户可申请参与活动<ul>
<li>如果活动已过期，则无法申请，显示已结束；</li>
<li>如果人数已满，则显示活动已经满员，报名截止；</li>
<li>既未过期，也没有满员，则用户可申请参与活动；</li>
</ul>
</li>
</ul>
<ul>
<li>用户可以查看自己的申请列表</li>
</ul>
<p>一步步来：</p>
<p>BTW，请无视CSS部分，只讲如何实作功能。</p>
<p><strong>Step1、 用户可以申请参与活动</strong></p>
<p>效果图：</p>
<p><img src="https://ws1.sinaimg.cn/large/006tKfTcgy1fk0k6757yzg30yb0jyhdu.gif" alt=""></p>
<ul>
<li><p>新建model apply_event，终端：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">rails g model apply_event user_id:integer event_id:integer</div></pre></td></tr></table></figure>
</li>
<li><p>建立apply_event, user, event三者之间的关系:</p>
<ul>
<li><p>在<code>app/models/apply_event.rb</code>中添加：</p>
<figure class="highlight ruby"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">ApplyEvent</span> &lt; ApplicationRecord</span></div><div class="line"> + belongs_to <span class="symbol">:user</span></div><div class="line"> + belongs_to <span class="symbol">:event</span></div><div class="line"><span class="keyword">end</span></div></pre></td></tr></table></figure>
</li>
<li><p>在<code>app/models/event.rb</code>中添加：</p>
<figure class="highlight ruby"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">......</div><div class="line">has_many <span class="symbol">:apply_events</span></div><div class="line">has_many <span class="symbol">:appliers</span>, <span class="symbol">:through</span> =&gt; <span class="symbol">:apply_events</span>, <span class="symbol">:source</span> =&gt; <span class="symbol">:user</span></div><div class="line">......</div></pre></td></tr></table></figure>
</li>
<li><p>在<code>app/models/user.rb</code>中添加：</p>
<figure class="highlight ruby"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">......</div><div class="line">has_many <span class="symbol">:apply_events</span></div><div class="line">has_many <span class="symbol">:applied_events</span>, <span class="symbol">through:</span> <span class="symbol">:apply_events</span>, <span class="symbol">source:</span> <span class="symbol">:event</span></div><div class="line">......</div></pre></td></tr></table></figure>
</li>
</ul>
</li>
<li><p>用户可以申请参加活动或取消申请</p>
<ul>
<li><p>在<code>app/models/user.rb</code>中添加：</p>
<figure class="highlight ruby"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line">......</div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">apply_already?</span><span class="params">(event)</span></span></div><div class="line">  applied_events.<span class="keyword">include</span>?(event)</div><div class="line"><span class="keyword">end</span></div><div class="line"></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">apply!</span><span class="params">(event)</span></span></div><div class="line">  applied_events &lt;&lt; event</div><div class="line"><span class="keyword">end</span></div><div class="line"></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">cancel!</span><span class="params">(event)</span></span></div><div class="line">  applied_events.delete(event)</div><div class="line"><span class="keyword">end</span></div><div class="line">......</div></pre></td></tr></table></figure>
<p>​</p>
</li>
<li><p>在<code>app/controllers/events_controller.rb</code>中添加：</p>
<figure class="highlight ruby"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">EventsController</span> &lt; ApplicationController</span></div><div class="line">  ......</div><div class="line">  <span class="function"><span class="keyword">def</span> <span class="title">apply</span></span></div><div class="line">    @event = Event.find(params[<span class="symbol">:id</span>])</div><div class="line">    type = params[<span class="symbol">:type</span>]</div><div class="line">    <span class="keyword">if</span> type == <span class="string">"apply"</span></div><div class="line">      current_user.apply!(@event)</div><div class="line">    <span class="keyword">else</span> type == <span class="string">"cancel"</span></div><div class="line">      current_user.cancel!(@event)</div><div class="line">    <span class="keyword">end</span></div><div class="line">    redirect_to <span class="symbol">:back</span></div><div class="line">  <span class="keyword">end</span></div><div class="line">  ......</div><div class="line"><span class="keyword">end</span></div></pre></td></tr></table></figure>
<p>申请参加活动，需要用户在登录状态下，修改<code>app/controllers/events_controller.rb</code>的<code>before_action :authenticate_user!</code>部分，加上apply</p>
<figure class="highlight ruby"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">- before_action <span class="symbol">:authenticate_user!</span>, <span class="symbol">only:</span> [<span class="symbol">:new</span>, <span class="symbol">:create</span>,.....]</div><div class="line">+ before_action <span class="symbol">:authenticate_user!</span>, <span class="symbol">only:</span> [<span class="symbol">:apply</span>,<span class="symbol">:new</span>, <span class="symbol">:create</span>,.....]</div></pre></td></tr></table></figure>
</li>
<li><p>修改<code>config/routes.rb</code>， 添加如下代码：</p>
<figure class="highlight ruby"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"> ......</div><div class="line"> resources <span class="symbol">:events</span> <span class="keyword">do</span></div><div class="line">......</div><div class="line"> + put <span class="symbol">:apply</span>, <span class="symbol">on:</span> <span class="symbol">:member</span></div><div class="line"> <span class="keyword">end</span></div><div class="line"> ......</div></pre></td></tr></table></figure>
</li>
<li><p>修改<code>app/views/events/show.html.erb</code>， 添加如下代码：</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line">......</div><div class="line">&lt;% if @event.end_time &lt; Time.now %&gt;</div><div class="line">	&lt;label class="label label-default event-over"&gt;活动已结束&lt;/label&gt;</div><div class="line">&lt;% elsif @event.appliers.count &gt;= @event.limited_num %&gt;</div><div class="line">	&lt;label class="label label-default event-over"&gt;活动已满员&lt;/label&gt;</div><div class="line">&lt;% else %&gt;</div><div class="line">  &lt;% if current_user &amp;&amp; current_user.apply_already?(@event) %&gt;</div><div class="line">    &lt;%= link_to("取消申请", apply_event_path(@event, type: "cancel"), method: :put, class: "btn btn-default event-apply")%&gt;</div><div class="line">  &lt;% else %&gt;</div><div class="line">    &lt;%= link_to("申请赴约", apply_event_path(@event, type: "apply"), method: :put, class: "btn btn-success event-apply")%&gt;</div><div class="line">  &lt;% end %&gt;</div><div class="line">&lt;% end %&gt;</div><div class="line">......</div></pre></td></tr></table></figure>
<p>现在看看，可以实现申请及取消申请了。但是，你很快就会发现，点击按钮后页面会refresh一下，这个不好不好，我们请上ajax。</p>
</li>
</ul>
</li>
<li><p>使用ajax来优化</p>
<ul>
<li><p>新增<code>app/views/events/_apply.html.erb</code>, <code>app/views/events/apply.js.erb</code></p>
</li>
<li><p>修改<code>app/views/events/show.html.erb</code>, 给这块要动态变化的区域加上ID</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line">+ &lt;div class="col-md-2" id="apply-&lt;%= @event.id %&gt;"&gt;</div><div class="line">-              &lt;% if @event.end_time &lt; Time.now %&gt;</div><div class="line">-              	&lt;label class="label label-default event-over"&gt;活动已结束&lt;/label&gt;</div><div class="line">-              &lt;% elsif @event.appliers.count &gt;= @event.limited_num %&gt;</div><div class="line">-              	&lt;label class="label label-default event-over"&gt;活动已满员&lt;/label&gt;</div><div class="line">-              &lt;% else %&gt;</div><div class="line">-                &lt;% if current_user &amp;&amp; current_user.apply_already?(@event) %&gt;</div><div class="line">-                  &lt;%= link_to("取消申请", apply_event_path(@event, type: "cancel"), method: :put, class: "btn btn-default event-apply")%&gt;</div><div class="line">-                &lt;% else %&gt;</div><div class="line">-                  &lt;%= link_to("申请赴约", apply_event_path(@event, type: "apply"), method: :put, class: "btn btn-success event-apply")%&gt;</div><div class="line">-                &lt;% end %&gt;</div><div class="line">-              &lt;% end %&gt;</div><div class="line">+              &lt;%= render :partial =&gt; "apply", :locals =&gt; &#123;:event =&gt; @event &#125;%&gt;</div><div class="line">+ &lt;/div&gt;</div></pre></td></tr></table></figure>
</li>
<li><p>编辑<code>app/views/events/_apply.html.erb</code>, 添加如下代码：</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line">&lt;% if event.end_time &lt; Time.now %&gt;</div><div class="line">  &lt;label class="label label-default event-over"&gt;活动已结束&lt;/label&gt;</div><div class="line">&lt;% elsif event.appliers.count &gt;= event.limited_num %&gt;</div><div class="line">  &lt;label class="label label-default event-over"&gt;活动已满员&lt;/label&gt;</div><div class="line">&lt;% else %&gt;</div><div class="line">  &lt;% if current_user &amp;&amp; current_user.apply_already?(event) %&gt;</div><div class="line">    &lt;%= link_to apply_event_path(event, type: "cancel"), method: :put, :remote =&gt; true do %&gt;</div><div class="line">    &lt;span class="btn btn-default event-apply"&gt;取消申请&lt;/span&gt;</div><div class="line">    &lt;% end %&gt;</div><div class="line">  &lt;% else %&gt;</div><div class="line">    &lt;%= link_to apply_event_path(event, type: "apply"), method: :put, :remote =&gt; true do %&gt;</div><div class="line">    &lt;span class="btn btn-success event-apply"&gt;申请赴约&lt;/span&gt;</div><div class="line">    &lt;% end %&gt;</div><div class="line">  &lt;% end %&gt;</div><div class="line">&lt;% end %&gt;</div></pre></td></tr></table></figure>
</li>
<li><p>编辑<code>app/views/events/apply.js.erb</code>, 添加如下代码：</p>
<figure class="highlight ruby"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">str = <span class="string">"&lt;%=j render :partial =&gt; "</span>apply<span class="string">", :locals =&gt; &#123;:event =&gt; @event &#125; %&gt;"</span>;</div><div class="line">$(<span class="string">"#apply-&lt;%= @event.id %&gt;"</span>).html(str);</div></pre></td></tr></table></figure>
</li>
<li><p>编辑<code>app/controllers/events_controller.rb</code>， 拿掉apply的redirect_to</p>
<figure class="highlight ruby"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"> ......</div><div class="line"> <span class="function"><span class="keyword">def</span> <span class="title">apply</span></span></div><div class="line">......</div><div class="line">   <span class="comment"># redirect_to :back</span></div><div class="line"> <span class="keyword">end</span></div><div class="line"> ......</div></pre></td></tr></table></figure>
</li>
</ul>
<p>现在试试，可以快速申请，快速取消啦，棒棒哒！！</p>
</li>
</ul>
<p><strong>Step2、 用户可以查看自己的申请列表</strong></p>
<p>效果图：</p>
<p><img src="https://ws4.sinaimg.cn/large/006tKfTcgy1fk1chgct37g310b0gs7wh.gif" alt=""></p>
<p>这部分就比较简单啦。</p>
<ul>
<li><p>新增controller，终端运行：</p>
<figure class="highlight ruby"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">rails g controller account::apply_events</div></pre></td></tr></table></figure>
</li>
<li><p>修改<code>config/routes.rb</code>， 添加如下代码：</p>
<figure class="highlight ruby"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"> ......</div><div class="line"> namespace <span class="symbol">:account</span> <span class="keyword">do</span></div><div class="line">......</div><div class="line"> + resources <span class="symbol">:apply_events</span></div><div class="line"> <span class="keyword">end</span></div><div class="line"> ......</div></pre></td></tr></table></figure>
</li>
<li><p>编辑<code>app/controllers/account/apply_events_controller.rb</code>，添加</p>
<figure class="highlight ruby"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">Account::ApplyEventsController</span> &lt; ApplicationController</span></div><div class="line">  before_action <span class="symbol">:authenticate_user!</span></div><div class="line"></div><div class="line">  <span class="function"><span class="keyword">def</span> <span class="title">index</span></span></div><div class="line">    @events = current_user.applied_events</div><div class="line">  <span class="keyword">end</span></div><div class="line"><span class="keyword">end</span></div></pre></td></tr></table></figure>
</li>
<li><p>新增<code>app/views/account/apply_events/index.html.erb</code>, 添加如下代码：</p>
</li>
</ul>
  <figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div></pre></td><td class="code"><pre><div class="line">&lt;h1 class="text-center"&gt;我的申请&lt;/h1&gt;</div><div class="line"></div><div class="line">&lt;div class="col-md-10 col-md-offset-1" style="margin-top: 20px;"&gt;</div><div class="line">  &lt;table class="table table-bordered"&gt;</div><div class="line">    &lt;thead&gt;</div><div class="line">      &lt;tr&gt;</div><div class="line">        &lt;th&gt;活动名称&lt;/th&gt;</div><div class="line">        &lt;th&gt;开始时间&lt;/th&gt;</div><div class="line">        &lt;th&gt;结束时间&lt;/th&gt;</div><div class="line">        &lt;th&gt;地点&lt;/th&gt;</div><div class="line">        &lt;th&gt;主办方&lt;/th&gt;</div><div class="line">        &lt;th&gt;类别&lt;/th&gt;</div><div class="line">        &lt;th&gt;人数限额&lt;/th&gt;</div><div class="line">        &lt;th&gt;剩余名额&lt;/th&gt;</div><div class="line">        &lt;th&gt;状态&lt;/th&gt;</div><div class="line">      &lt;/tr&gt;</div><div class="line">    &lt;/thead&gt;</div><div class="line">    &lt;tbody&gt;</div><div class="line">      &lt;% @events.each do |event| %&gt;</div><div class="line">        &lt;tr&gt;</div><div class="line">          &lt;td&gt;</div><div class="line">            &lt;% link_to event_path(event)%&gt;</div><div class="line">             &lt;% if event.logo.present? %&gt;</div><div class="line">              &lt;%= link_to image_tag(event.logo.thumb.url, class:"event_logo_sm")%&gt;</div><div class="line">            &lt;% else %&gt;</div><div class="line">              &lt;%= link_to image_tag("http://placehold.it/100x100&amp;text=No Pic", class: "event_logo_sm")%&gt;</div><div class="line">            &lt;% end %&gt;</div><div class="line">            &lt;%= link_to(event.title, event_path(event)) %&gt;&lt;/td&gt;</div><div class="line">          &lt;td&gt;&lt;%= event.start_time %&gt;&lt;/td&gt;</div><div class="line">          &lt;td&gt;&lt;%= event.end_time %&gt;&lt;/td&gt;</div><div class="line">          &lt;td&gt;&lt;%= event.address %&gt;&lt;/td&gt;</div><div class="line">          &lt;td&gt;&lt;%= event.sponsor %&gt;&lt;/td&gt;</div><div class="line">          &lt;td&gt;&lt;%= event.category.name %&gt;&lt;/td&gt;</div><div class="line">          &lt;td&gt;&lt;%= event.limited_num %&gt;&lt;/td&gt;</div><div class="line">          &lt;td&gt;&lt;%= event.limited_num - event.appliers.count %&gt;&lt;/td&gt;</div><div class="line">          &lt;td&gt;&lt;%= t(event.status, :scope =&gt; "event.status") %&gt;&lt;/td&gt;</div><div class="line">        &lt;/tr&gt;</div><div class="line">      &lt;% end %&gt;</div><div class="line">    &lt;/tbody&gt;</div><div class="line">  &lt;/table&gt;</div><div class="line">&lt;/div&gt;</div><div class="line"></div><div class="line"></div><div class="line">&lt;!-- 分页 --&gt;</div><div class="line">&lt;div class="text-center"&gt;</div><div class="line">  &lt;%= will_paginate @events, renderer: BootstrapPagination::Rails, :previous_label =&gt; '上一页', :next_label =&gt; '下一页' %&gt;</div><div class="line">&lt;/div&gt;</div></pre></td></tr></table></figure>
<ul>
<li><p>编辑<code>app/views/common/_navbar.html.erb</code>，加上<strong>我的申请</strong>入口：</p>
<figure class="highlight ruby"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">......</div><div class="line">+ &lt;li&gt;&lt;%= link_to(<span class="string">" 我的申请"</span>,account_apply_events_path(current_user), <span class="class"><span class="keyword">class</span>: "<span class="title">btn</span> <span class="title">btn</span>-<span class="title">default</span>")%&gt;&lt;/<span class="title">li</span>&gt;</span></div><div class="line">......</div></pre></td></tr></table></figure>
</li>
</ul>
<p>试试看，可以啦！</p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="http://lupeipei.github.io/2017/10/02/web-together-build-6/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Lucia">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Lucia">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2017/10/02/web-together-build-6/" itemprop="url">
                  Together网站搭建之踩坑系列6
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-10-02T07:52:12+08:00">
                2017-10-02
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/ROR/" itemprop="url" rel="index">
                    <span itemprop="name">ROR</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
              <span class="post-comments-count">
                <span class="post-meta-divider">|</span>
                <span class="post-meta-item-icon">
                  <i class="fa fa-comment-o"></i>
                </span>
                <a href="/2017/10/02/web-together-build-6/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count disqus-comment-count"
                        data-disqus-identifier="2017/10/02/web-together-build-6/" itemprop="commentCount"></span>
                </a>
              </span>
            
          

          
          

          

          

          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h4 id="写在前面"><a href="#写在前面" class="headerlink" title="写在前面"></a>写在前面</h4><p>这是功能实现的第五篇，扯一扯<strong>如何添加评论区，并使用ajax优化</strong>。</p>
<p>完整作品源码及效果，看这里<a href="https://togetherisbetter.cn/" target="_blank" rel="external">作品网站</a>,   <a href="https://github.com/Lupeipei/Together" target="_blank" rel="external">作品源码</a>。</p>
<h4 id="目录"><a href="#目录" class="headerlink" title="目录"></a>目录</h4><ul>
<li><a href="https://lupeipei.github.io/2017/09/28/web-together-build-2/">给活动添加收藏功能，并使用Ajax进行优化</a></li>
<li><a href="https://lupeipei.github.io/2017/09/29/web-together-build-3/">给活动Events添加分类筛选</a></li>
<li><a href="https://lupeipei.github.io/2017/09/30/web-together-build-4/">添加省市自治区地址, 并实现热门城市筛选</a></li>
<li><a href="https://lupeipei.github.io/2017/10/01/web-together-build-5/">添加时间筛选</a></li>
<li>添加评论区，并使用ajax优化</li>
<li><a href="https://lupeipei.github.io/2017/10/03/web-together-build-7/">实作活动申请</a></li>
<li><a href="https://lupeipei.github.io/2017/10/04/web-together-build-8/">在个人中心实作密码修改</a></li>
</ul>
<h4 id="正文"><a href="#正文" class="headerlink" title="正文"></a>正文</h4><p>上效果图先：</p>
<p><img src="https://ws3.sinaimg.cn/large/006tNc79gy1fjzf3flg56g30zb0kmk6a.gif" alt=""></p>
<p>功能描述：用户可以新增，删除自己的评论。</p>
<p>步骤如下：</p>
<ul>
<li><p>新增review model，终端运行：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">rails g model review comment:string user_id:integer event_id:integer</div><div class="line">rake db:migrate</div></pre></td></tr></table></figure>
</li>
<li><p>建立review与event，user的关系：</p>
<ul>
<li><p>在<code>review.rb</code>中，添加：</p>
<figure class="highlight ruby"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">belongs_to <span class="symbol">:user</span></div><div class="line">belongs_to <span class="symbol">:event</span></div></pre></td></tr></table></figure>
</li>
<li><p>在<code>event.rb</code>中，添加：</p>
<figure class="highlight ruby"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">has_many <span class="symbol">:reviews</span></div></pre></td></tr></table></figure>
</li>
<li><p>在<code>user.rb</code>中，添加：</p>
<figure class="highlight ruby"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">has_many <span class="symbol">:reviews</span></div></pre></td></tr></table></figure>
</li>
</ul>
</li>
<li><p>编辑<code>config/routes.rb</code>,在resources :events中添加：</p>
<figure class="highlight ruby"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"> resources <span class="symbol">:events</span> <span class="keyword">do</span></div><div class="line"> + resources <span class="symbol">:reviews</span></div><div class="line">.....</div><div class="line">   <span class="keyword">end</span></div></pre></td></tr></table></figure>
</li>
<li><p>新建review controller</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">rails g controller reviews</div></pre></td></tr></table></figure>
</li>
<li><p>编辑<code>app/controllers/reviews_controller.rb</code></p>
<figure class="highlight ruby"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">ReviewsController</span> &lt; ApplicationController</span></div><div class="line">  before_action <span class="symbol">:authenticate_user!</span></div><div class="line"></div><div class="line">  <span class="function"><span class="keyword">def</span> <span class="title">new</span></span></div><div class="line">    @event = Event.find(params[<span class="symbol">:event_id</span>])</div><div class="line">    @review = Review.new</div><div class="line">  <span class="keyword">end</span></div><div class="line"></div><div class="line">  <span class="function"><span class="keyword">def</span> <span class="title">create</span></span></div><div class="line">    @event = Event.find(params[<span class="symbol">:event_id</span>])</div><div class="line">    @review = Review.new(review_params)</div><div class="line">    @review.event = @event</div><div class="line">    @review.user = current_user</div><div class="line">    @review.save</div><div class="line">    redirect_to <span class="symbol">:back</span>, <span class="symbol">alert:</span> <span class="string">"评论已经创建"</span></div><div class="line">  <span class="keyword">end</span></div><div class="line"></div><div class="line">  <span class="function"><span class="keyword">def</span> <span class="title">destroy</span></span></div><div class="line">    @event = Event.find(params[<span class="symbol">:event_id</span>])</div><div class="line">    @review = Review.find(params[<span class="symbol">:id</span>])</div><div class="line">    @review.destroy</div><div class="line">    redirect_to <span class="symbol">:back</span>, <span class="symbol">alert:</span> <span class="string">"评论已经删除"</span></div><div class="line">  <span class="keyword">end</span></div><div class="line"></div><div class="line">  private</div><div class="line"></div><div class="line">  <span class="function"><span class="keyword">def</span> <span class="title">review_params</span></span></div><div class="line">    params.<span class="keyword">require</span>(<span class="symbol">:review</span>).permit(<span class="symbol">:comment</span>)</div><div class="line">  <span class="keyword">end</span></div><div class="line"></div><div class="line"><span class="keyword">end</span></div></pre></td></tr></table></figure>
</li>
<li><p>编辑<code>app/controllers/events_controller.rb</code>, 在show部分，添加：</p>
<figure class="highlight ruby"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">......</div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">show</span></span></div><div class="line">  @event = Event.find(params[<span class="symbol">:id</span>])</div><div class="line">+ @reviews = @event.reviews.all</div><div class="line"><span class="keyword">end</span></div><div class="line">......</div></pre></td></tr></table></figure>
</li>
<li><p>编辑event的<code>show.html.erb</code>，给评论区腾出位置，这里用了两次partial来引用review，后面会建相应的文档:</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div></pre></td><td class="code"><pre><div class="line">......</div><div class="line">&lt;!-- 活动讨论区 --&gt;</div><div class="line">  &lt;div class="event_reviews"&gt;</div><div class="line">    &lt;div class="row"&gt;</div><div class="line">      &lt;div class="col-md-8 col-md-offset-2"&gt;</div><div class="line">        &lt;%= render :partial =&gt; "reviews/form", :locals =&gt; &#123;:event =&gt; @event &#125; %&gt;</div><div class="line">        &lt;hr&gt;</div><div class="line">        &lt;% if @reviews.blank? %&gt;</div><div class="line">          &lt;p&gt;该活动还没有人讨论，来侃几句吧？&lt;/p&gt;</div><div class="line">        &lt;% else %&gt;</div><div class="line">        &lt;div id="reviews_list"&gt;</div><div class="line">          &lt;% @reviews.each do |review| %&gt;</div><div class="line">        &lt;%= render :partial =&gt; "reviews/review", :locals =&gt; &#123; :review =&gt; review &#125;%&gt;</div><div class="line">          &lt;% end %&gt;</div><div class="line">        &lt;/div&gt;</div><div class="line">        &lt;% end %&gt;</div><div class="line">        &lt;hr&gt;</div><div class="line">      &lt;/div&gt;</div><div class="line">    &lt;/div&gt;</div><div class="line">  &lt;/div&gt;</div><div class="line"> ......</div></pre></td></tr></table></figure>
<p>​</p>
</li>
<li><p>在<code>app/views/reviews</code>下，新增<code>_review.html.erb</code>, <code>_form.html.erb</code> 。<code>_review.html.erb</code>用来显示评论区列表，<code>_form.html.erb</code>则用于新增评论。</p>
<ul>
<li><p>编辑<code>_review.html.erb</code></p>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div></pre></td><td class="code"><pre><div class="line">&lt;div id="reivew-&lt;%= review.id %&gt;" class="reviews" style="text-align: left;"&gt;</div><div class="line">    &lt;!-- 显示用户头像 --&gt;</div><div class="line">  &lt;ul&gt;</div><div class="line">    &lt;div class="user_avatar" style="float: left;"&gt;</div><div class="line">      &lt;% if review.user.avatar.present? %&gt;</div><div class="line">        &lt;%= image_tag(review.user.avatar.thumb.url, class: "review_avatar")%&gt;</div><div class="line">      &lt;% else %&gt;</div><div class="line">        &lt;%= image_tag("https://ws4.sinaimg.cn/large/006tNc79gy1fj8fv5d1tdj30zk0npdig.jpg", class: "review_avatar")%&gt;</div><div class="line">      &lt;% end %&gt;</div><div class="line">    &lt;/div&gt;</div><div class="line">  &lt;/ul&gt;</div><div class="line">  &lt;!-- 显示其他信息 --&gt;</div><div class="line">    &lt;div class="row"&gt;</div><div class="line">      &lt;div class="col-md-9 review-user-info"&gt;</div><div class="line">        &lt;%= review.user.display_name %&gt;</div><div class="line">      &lt;/div&gt;</div><div class="line">      &lt;div class="col-md-3"&gt;</div><div class="line">        &lt;%= review.created_at %&gt;</div><div class="line">      &lt;/div&gt;</div><div class="line">    &lt;/div&gt;</div><div class="line">    &lt;div class="review-comment"&gt;</div><div class="line">      &lt;%= review.content %&gt;</div><div class="line">    &lt;/div&gt;</div><div class="line">    &lt;!-- 用户可以删除自己的评论 --&gt;</div><div class="line">    &lt;% if current_user == review.user %&gt;</div><div class="line">    &lt;div class="pull-right"&gt;</div><div class="line">      &lt;%= link_to("delete", event_review_path(review.event,review), method: :delete, :remote =&gt; true)%&gt;</div><div class="line">    &lt;/div&gt;</div><div class="line">  &lt;% end %&gt;</div><div class="line">&lt;/div&gt;</div></pre></td></tr></table></figure>
</li>
<li><p>编辑<code>_form.html.erb</code></p>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line">&lt;div class="contain"&gt;</div><div class="line">  &lt;div class="row" style=" margin-top: 50px;"&gt;</div><div class="line">    &lt;div class="col-md-12"&gt;</div><div class="line">      &lt;%= simple_form_for [@event, @event.reviews.build ], :remote =&gt; true do |f| %&gt;</div><div class="line">        &lt;div class="form-group"&gt;</div><div class="line">          &lt;%= f.input :content, label: "吐糟或者提问，请随意", input_html: &#123; class: "form-control"&#125;%&gt;</div><div class="line">        &lt;/div&gt;</div><div class="line">        &lt;div class="form-action"&gt;</div><div class="line">          &lt;%= f.submit "我来说两句", disable_with: "Submiting....", class: "btn btn-danger"%&gt;</div><div class="line">        &lt;/div&gt;</div><div class="line">      &lt;% end %&gt;</div><div class="line">    &lt;/div&gt;</div><div class="line">  &lt;/div&gt;</div><div class="line">&lt;/div&gt;</div></pre></td></tr></table></figure>
</li>
</ul>
</li>
<li><p>编辑<code>app/controllers/events_controller.rb</code>， 拿掉create, destroy 的redirect_to：</p>
<figure class="highlight ruby"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div></pre></td><td class="code"><pre><div class="line">......</div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">create</span></span></div><div class="line">    @event = Event.find(params[<span class="symbol">:event_id</span>])</div><div class="line">    @review = Review.new(review_params)</div><div class="line">    @review.event = @event</div><div class="line">    @review.user = current_user</div><div class="line">    @review.save</div><div class="line">  - redirect_to <span class="symbol">:back</span>, <span class="symbol">alert:</span> <span class="string">"评论已经创建"</span></div><div class="line">  <span class="keyword">end</span></div><div class="line"></div><div class="line">  <span class="function"><span class="keyword">def</span> <span class="title">destroy</span></span></div><div class="line">    @event = Event.find(params[<span class="symbol">:event_id</span>])</div><div class="line">    @review = Review.find(params[<span class="symbol">:id</span>])</div><div class="line">    @review.destroy</div><div class="line">  - redirect_to <span class="symbol">:back</span>, <span class="symbol">alert:</span> <span class="string">"评论已经删除"</span></div><div class="line">  <span class="keyword">end</span></div><div class="line">  ......</div></pre></td></tr></table></figure>
</li>
<li><p>新增<code>app/views/reviews/create.js.erb</code>, <code>app/views/reviews/destroy.js.erb</code>, 分别编辑：</p>
<ul>
<li><p><code>app/views/reviews/create.js.erb</code></p>
<figure class="highlight ruby"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">&lt;% <span class="keyword">if</span> @review.valid? %&gt;</div><div class="line">  $(<span class="string">"#reviews_list"</span>).prepend(<span class="string">"&lt;%=j render :partial =&gt; "</span>review<span class="string">", :locals =&gt; &#123;:review =&gt; @review &#125; %&gt;"</span>);</div><div class="line">  $(<span class="string">"#review_content"</span>).val(<span class="string">""</span>);</div><div class="line">&lt;% <span class="keyword">else</span> %&gt;</div><div class="line">  alert(<span class="string">"评论失败"</span>);</div><div class="line">&lt;% <span class="keyword">end</span> %&gt;</div></pre></td></tr></table></figure>
</li>
<li><p><code>app/views/reviews/destroy.js.erb</code>中，</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">$(&quot;#reivew-&lt;%= @review.id %&gt;&quot;).remove();</div></pre></td></tr></table></figure>
</li>
</ul>
</li>
</ul>
<p>大功告成！试试吧！美化部分，可以根据需要写相应的CSS。</p>
<hr>
<p>这里说明一下：</p>
<ul>
<li>rails5.0以前的版本已经默认安装<code>gem &#39;jquery-rails&#39;</code>, 如果你版本过高，需要自行安装，不然ajax部分会无法正常实现</li>
</ul>
<ul>
<li>涉及ajax的部分，没有说得太细，可自行Google ajax相关内容了解。</li>
</ul>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
  </section>

  
  <nav class="pagination">
    <a class="extend prev" rel="prev" href="/page/4/"><i class="fa fa-angle-left"></i></a><a class="page-number" href="/">1</a><span class="space">&hellip;</span><a class="page-number" href="/page/4/">4</a><span class="page-number current">5</span><a class="page-number" href="/page/6/">6</a><a class="page-number" href="/page/7/">7</a><a class="extend next" rel="next" href="/page/6/"><i class="fa fa-angle-right"></i></a>
  </nav>



          </div>
          


          

        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    <div class="sidebar-inner">

      

      

      <section class="site-overview sidebar-panel sidebar-panel-active">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <img class="site-author-image" itemprop="image"
               src="/images/avatar.jpg"
               alt="Lucia" />
          <p class="site-author-name" itemprop="name">Lucia</p>
           
              <p class="site-description motion-element" itemprop="description">曲肱而枕</p>
          
        </div>
        <nav class="site-state motion-element">

          
            <div class="site-state-item site-state-posts">
              <a href="/archives">
                <span class="site-state-item-count">66</span>
                <span class="site-state-item-name">日志</span>
              </a>
            </div>
          

          
            
            
            <div class="site-state-item site-state-categories">
              <a href="/categories/index.html">
                <span class="site-state-item-count">17</span>
                <span class="site-state-item-name">分类</span>
              </a>
            </div>
          

          
            
            
            <div class="site-state-item site-state-tags">
              <a href="/tags/index.html">
                <span class="site-state-item-count">23</span>
                <span class="site-state-item-name">标签</span>
              </a>
            </div>
          

        </nav>

        

        <div class="links-of-author motion-element">
          
            
              <span class="links-of-author-item">
                <a href="https://github.com/Lupeipei" target="_blank" title="GitHub">
                  
                    <i class="fa fa-fw fa-github"></i>
                  
                  GitHub
                </a>
              </span>
            
              <span class="links-of-author-item">
                <a href="https://www.facebook.com/Luciapeipei" target="_blank" title="Facebook">
                  
                    <i class="fa fa-fw fa-facebook"></i>
                  
                  Facebook
                </a>
              </span>
            
          
        </div>

        
        

        
        

        


      </section>

      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright" >
  
  &copy; 
  <span itemprop="copyrightYear">2018</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Lucia</span>
</div>


<div class="powered-by">
  由 <a class="theme-link" href="https://hexo.io">Hexo</a> 强力驱动
</div>

<div class="theme-info">
  主题 -
  <a class="theme-link" href="https://github.com/iissnan/hexo-theme-next">
    NexT.Muse
  </a>
</div>


        
<div class="busuanzi-count">
  <script async src="https://dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js"></script>

  
    <span class="site-uv">
      <i class="fa fa-user"></i>
      <span class="busuanzi-value" id="busuanzi_value_site_uv"></span>
      
    </span>
  

  
    <span class="site-pv">
      <i class="fa fa-eye"></i>
      <span class="busuanzi-value" id="busuanzi_value_site_pv"></span>
      
    </span>
  
</div>


        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  






  
  <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>

  
  <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>

  
  <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>

  
  <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.0"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.0"></script>



  
  

  

  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.0"></script>



  


  

    
      <script id="dsq-count-scr" src="https://https-lupeipei-github-io.disqus.com/count.js" async></script>
    

    

  




	





  





  





  






  





  

  

  

  

</body>
</html>
